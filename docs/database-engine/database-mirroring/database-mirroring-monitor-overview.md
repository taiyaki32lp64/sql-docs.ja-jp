---
title: データベース ミラーリング モニターの概要 | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql
ms.prod_service: high-availability
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
f1_keywords:
- sql13.swb.dbmmonitor.main.f1
helpviewer_keywords:
- Database Mirroring Monitor [SQL Server], interface
ms.assetid: 8ebbdcd6-565a-498f-b674-289c84b985eb
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 07ad2379f82552a3db0ceee30305f7fdc38003fe
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/15/2019
ms.locfileid: "68006406"
---
# <a name="database-mirroring-monitor-overview"></a>データベース ミラーリング モニターの概要
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]
  適切な権限を持つユーザーであれば、データベース ミラーリング モニターを使用することにより、サーバー インスタンス上のミラー化されたデータベースのサブセットを監視できます。 監視を行うことにより、データベース ミラーリング セッションで適切なデータ フローが保たれているかどうかを詳細に検証できます。 データベース ミラーリング モニターは、データ フローの停滞の原因をトラブルシューティングするときにも有効に使用できます。  
  
 各フェールオーバー パートナーにおける監視の対象としては、ミラー化された任意のデータベースを登録できます。 データベースを登録すると、そのデータベースに関して、次の情報がデータベース ミラーリング モニターによってキャッシュされます。  
  
-   データベース名  
  
-   2 つのパートナー サーバー インスタンスの名前  
  
-   各パートナーの最後に認識されたロール (プリンシパルまたはミラー)  
  
## <a name="permissions"></a>アクセス許可  
 データベース ミラーリングを監視するには、サーバー インスタンスの **msdb** データベースにおいて、 **sysadmin** 固定サーバー ロールまたは **dbm_monitor** 固定データベース ロールのメンバーであることが必要です。 1 つのパートナー サーバー インスタンスだけが **sysadmin** または **dbm_monitor** のメンバーの場合、モニターは、該当するパートナーにのみ接続でき、他のパートナーからは情報を取得できません。  
  
 サーバー インスタンスで、 **dbm_monitor** だけのメンバーである場合、そのサーバー インスタンスにおける権限は制限されます。 最新の状態行を読み取り専用で参照することしかできません。 **dbm_monitor** の権限でサーバー インスタンスに接続した場合、権限が制限されることが、データベース ミラーリング モニターによって通知されます。  
  
> [!IMPORTANT]  
>  **dbm_monitor** 固定データベース ロールは、データベース ミラーリング モニターに最初のデータベースが登録されたときに、 **msdb** データベースに作成されます。 新しい **dbm_monitor** ロールには、メンバーは割り当てられていません。システム管理者がそのロールにユーザーを割り当てる必要があります。  
  
## <a name="navigation-tree"></a>ナビゲーション ツリー  
 データベース ミラーリング モニターによる監視の対象としてデータベースが登録されている場合、登録されたデータベースがナビゲーション ツリーに一覧表示されます。 ツリーは 30 秒ごとに自動的に更新されます。 登録されたデータベースの状態を調べるには、目的のデータベースを選択します。 詳細については、このトピックの「詳細ペイン」を参照してください。  
  
 次の情報が登録されたデータベースごとに表示されます。  
  
 _<Database_name>_ **(** _\<Status>_ **,** _<PRINCIPAL_SERVER>_ **->** _<MIRROR_SERVER>_ **)**  
  
 *<Database_name>*  
 データベース ミラーリング モニターに登録されている、ミラー化されたデータベースの名前です。  
  
 *\<Status>*  
 表示される状態および対応するアイコンを次に示します。  
  
|アイコン|状態|[説明]|  
|----------|------------|-----------------|  
|警告アイコン|**Unknown**|モニターがいずれのパートナーにも接続されていません。 モニターによってキャッシュされている情報だけを確認できます。|  
|警告アイコン|**[同期中]**|ミラー データベースの内容が、プリンシパル データベースの内容に遅れています。 プリンシパル サーバー インスタンスからミラー サーバー インスタンスにログ レコードを送信して、ミラー データベースを更新するための変更を適用しています。<br /><br /> データベース ミラーリング セッションの開始時には、ミラー データベースとプリンシパル データベースはこの状態です。|  
|データベースを表す円柱形のアイコン|**同期済み**|ミラー サーバーがプリンシパル サーバーとの遅延を解消すると、データベースの状態が **[同期済み]** になります。 プリンシパル サーバーがミラー サーバーに変更を送信し、ミラー サーバーがミラー データベースに変更を適用する、という処理が継続されている限り、データベースはこの状態のままです。<br /><br /> 高い安全性モードの場合、自動フェールオーバーおよび手動フェールオーバーの両方がサポートされています。データの損失はありません。<br /><br /> 高パフォーマンス モードの場合、 **[同期済み]** 状態でも、一部のデータが損失する可能性は常にあります。|  
|警告アイコン|**中断**|プリンシパル データベースは使用できますが、ミラー サーバーにログを送信していません。|  
|エラー アイコン|**切断済み**|サーバー インスタンスがパートナーに接続できません。|  
  
 *<PRINCIPAL_SERVER>*  
 現在プリンシパル サーバー インスタンスとして動作しているパートナーの名前です。 名前には次の形式が使用されます。  
  
 *<システム名>* [ **\\** _<インスタンス名>_ ]  
  
 ここで、 *<システム名>* は、サーバー インスタンスが存在するシステムの名前です。 既定以外のサーバー インスタンスについても、 _<システム名>_ **\\** _<インスタンス名>_ という形式でインスタンス名が表示されます。  
  
 *<MIRROR_SERVER>*  
 現在ミラー サーバー インスタンスとして動作しているパートナーの名前です。 名前の形式はプリンシパル サーバーと同じです。  
  
## <a name="detail-pane"></a>詳細ペイン  
 モニターのインターフェイスは、選択されているデータベースによって異なります。 モニターを開くと、詳細ペインに **[ミラー化されたデータベースの登録]** というリンクが表示されます。 このリンクをクリックすると、データベースを登録できます。 登録されたデータベースは、ナビゲーション ツリーの **[データベース ミラーリング モニター]** ノードに一覧表示されます。 データベース ミラーリング モニターは常に、資格情報を保持しているすべてのサーバー インスタンスに対して接続を試みます。  
  
 データベースを選択すると、その状態が詳細ペインの **[状態]** タブ ページに表示されます。 このページには、プリンシパル サーバー インスタンスとミラー サーバー インスタンスの両方から取得された情報が表示されます。 状態はプリンシパル サーバー インスタンスとミラー サーバー インスタンスへの別個の接続を使用して収集されるので、このページの値は非同期に設定されます。 状態は 30 秒間隔で自動的に更新されます。  
  
> [!NOTE]  
>  監視の更新頻度を変更することはできません。ただし、 **[データベース ミラーリングの履歴]** ダイアログ ボックスから状態テーブルを更新することは可能です。  
  
 システム管理者は、 **[警告]** タブ ページをクリックすることにより、データベースに対する現在の警告構成を表示できます。 このページから、 **[警告しきい値の設定]** ダイアログ ボックスを起動し、警告しきい値を有効にしたり構成したりできます。  
  
 詳細ペインの一連のタブの上にはバナーが表示されています。ここには、前回モニターによって状態情報が更新された日時が **最終更新:** _\<日付>\<時刻>_ と表示されます。 通常、状態情報は、プリンシパル サーバー インスタンスおよびミラー サーバー インスタンスから別々の時間に取得されます。 表示されるのは、この 2 つの更新日時の古い方になります。  
  
## <a name="action-menu"></a>[アクション] メニュー  
 **[アクション]** メニューには、常に次のコマンドが表示されます。  
  
|コマンド|[説明]|  
|-------------|-----------------|  
|**[ミラー化されたデータベースの登録]**|**[ミラー化されたデータベースの登録]** ダイアログ ボックスを開きます。 このダイアログ ボックスを使用すると、特定のサーバー インスタンスに対し、ミラー化されたデータベース (複数可) を登録できます。登録は、データベースをデータベース ミラーリング モニターに追加することによって行います。 データベースを追加すると、データベースとそのパートナーに関する情報、およびパートナーへの接続方法に関する情報が、データベース ミラーリング モニターによってローカルにキャッシュされます。|  
|**[サーバー インスタンスの接続管理]**|このコマンドを選択すると、 **[サーバー インスタンスの接続管理]** ダイアログ ボックスが開きます。 ここでサーバー インスタンスを選択し、モニターが特定のパートナーへの接続時に使用する資格情報を指定します。<br /><br /> パートナーの資格情報を編集するには、 **[サーバー インスタンス]** グリッドから対応するエントリを探し、その行の **[編集]** をクリックします。 **[サーバーへの接続]** ダイアログ ボックスが開き、現在キャッシュされている値に資格情報が初期化されて表示されます。サーバー インスタンス名は編集できません。 認証情報を必要に応じて変更し、 **[接続]** をクリックします。 その資格情報に十分な特権がある場合は、 **[接続に使用する認証]** 列が新しい資格情報で更新されます。|  
  
 データベースが選択されている場合、 **[アクション]** メニューには、さらに次のコマンドが表示されます。  
  
|コマンド|[説明]|  
|-------------|-----------------|  
|**[このデータベースの登録を解除]**|選択されたデータベースをデータベース ミラーリング モニターから削除します。|  
|**[警告しきい値の設定]**|**[警告しきい値の設定]** ダイアログ ボックスを開きます。 ここでは、システム管理者が、各パートナーのデータベースに対する警告の有効/無効を切り替えたり、警告ごとにしきい値を変更したりできます。 データベースのフェールオーバーが発生しても警告が保持されるように、警告のしきい値は、両方のパートナーに対して設定することをお勧めします。 適切なしきい値は、各パートナーのシステムのパフォーマンスによって異なります。<br /><br /> イベントがパフォーマンスのイベント ログに書き込まれるのは、状態テーブルの更新時に、該当する値がしきい値以上になった場合だけです。 状態が更新されるまでの間に、一時的にピーク値がしきい値に達した場合、そのピーク値は反映されません。|  
  
 **SQL Server Management Studio を使用してデータベース ミラーリングを監視するには**  
  
-   [データベース ミラーリング モニターの起動 &#40;SQL Server Management Studio&#41;](../../database-engine/database-mirroring/start-database-mirroring-monitor-sql-server-management-studio.md)  
  
## <a name="see-also"></a>参照  
 [データベース ミラーリングの監視 &#40;SQL Server&#41;](../../database-engine/database-mirroring/monitoring-database-mirroring-sql-server.md)   
 [データベース ミラーリング セキュリティ構成ウィザードの起動 &#40;SQL Server Management Studio&#41;](../../database-engine/database-mirroring/start-the-configuring-database-mirroring-security-wizard.md)  
  
  
