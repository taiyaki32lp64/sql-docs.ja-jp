---
title: メモリ最適化オブジェクトの持続性の定義 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: in-memory-oltp
ms.topic: conceptual
ms.assetid: 0fe85fbf-8e8d-4983-96fd-d04b3c7d6d65
author: CarlRabeler
ms.author: carlrab
manager: craigg
ms.openlocfilehash: ecf171c8c50e1f7ce1e7cdc9e86cd27ac6fe558b
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "63161994"
---
# <a name="defining-durability-for-memory-optimized-objects"></a>メモリ最適化オブジェクトの持続性の定義
  インメモリ OLTP では、完全な原子性、一貫性、分離性、および完全な持続性 (ACID) の各プロパティが保証されます。 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] およびメモリ最適化テーブルのコンテキストにおける持続性では、次の事項が保証されます。  
  
 トランザクションの持続性  
 メモリ最適化テーブルに対して (DDL または DML の) 変更を行った完全に持続性があるトランザクションをコミットする場合、持続性のあるメモリ最適化テーブルに対して行った変更は永久保存されます。  
  
 メモリ最適化テーブルに対して遅延した持続性トランザクションをコミットする場合、トランザクションは、インメモリ トランザクション ログがディスクに保存された後にのみ持続可能になります。  
  
 再起動の持続性  
 クラッシュまたは計画シャットダウンの後で [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] が再起動する場合、持続性のあるメモリ最適化テーブルは再インスタンス化されて、シャットダウンやクラッシュの前の状態に復元されます。  
  
 メディア障害の持続性  
 失敗または破損したディスクに、持続性のあるメモリ最適化オブジェクトの保存されたコピーが 1 つ以上保持されている場合は、 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] のバックアップおよび復元機能により、新しいメディアのメモリ最適化テーブルが復元されます。  
  
 メモリ最適化テーブルには持続性のオプションが 2 つあります。  
  
 SCHEMA_ONLY (持続性のないテーブル)  
 このオプションは、インデックスを含むテーブル スキーマの持続性を確認します。 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] を再起動すると、持続性のないテーブルが再作成されますが、最初はデータがありません (これは tempdb のテーブルとは異なり、テーブルとテーブルのデータはどちらも再起動時に失われます)。持続性のないテーブルを作成するための一般的なシナリオは、ETL プロセスのステージング テーブルなどの一時的なデータを格納することです。 SCHEMA_ONLY の持続性により、トランザクションのログ記録とチェックポイントの両方が回避されるため、I/O 操作が大幅に減少します。  
  
 SCHEMA_AND_DATA (持続性のあるテーブル)  
 このオプションは、スキーマとデータの両方の持続性を提供します。 データ持続性のレベルは、完全に持続性があるトランザクションと持続性に遅延が生じているトランザクションのどちらとしてコミットするかによって異なります。 完全に持続性があるトランザクションでは、ディスク ベース テーブルの場合と同様に、データとスキーマに対して同じ持続性が保証されます。 遅延した持続性ではパフォーマンスが向上しますが、サーバー クラッシュまたはフェールオーバー時にデータが失われる場合があります。 (遅延持続性の詳細については、「 [コントロールのトランザクションの持続性](../logs/control-transaction-durability.md)」を参照してください。)  
  
 メモリ最適化テーブルのスキーマは、ディスク ベース テーブルの場合と同様に、データベースのプライマリ ファイル グループに保存されます。  
  
 持続性のあるメモリ最適化テーブル内のデータは、データ ファイルとデルタ ファイルのペアに保存されます。  
  
 メモリ最適化テーブルで定義されているインデックス ストレージではなく、メタデータにのみ保持されます。 インデックス構造は、メモリ最適化テーブル読み込みの一部として生成されます。  
  
 行は、DELETE ステートメントによって明示的に、または UPDATE ステートメントによって間接的に削除されます。 UPDATE 操作は削除として実行され、その後に挿入が続きます。 行を削除しても、データ ファイルに対して変更は行われませんが、削除された行を識別する新しい行が対応するデルタ ファイルに追加されます。  
  
 復旧操作または復元操作中に、インメモリ OLTP エンジンは物理メモリに読み込むためにデータ ファイルとデルタ ファイルを読み取ります。 読み込み時間は次の事項によって決まります。  
  
-   読み込むデータの量。  
  
-   シーケンシャル I/O 帯域幅。  
  
-   ファイル コンテナーの数およびプロセッサ コアの数によって決まる、並列処理の次数。  
  
-   再実行される必要があるログのアクティブな部分のログ レコードの量。  
  
## <a name="see-also"></a>参照  
 [メモリ最適化オブジェクト用ストレージの作成と管理](creating-and-managing-storage-for-memory-optimized-objects.md)  
  
  
