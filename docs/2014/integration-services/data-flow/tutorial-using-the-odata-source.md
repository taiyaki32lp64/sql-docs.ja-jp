---
title: チュートリアル:[SSIS] OData ソースの使用 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
ms.assetid: 2c64cf8b-5edb-48df-8ffe-697096258f71
author: janinezhang
ms.author: janinez
manager: craigg
ms.openlocfilehash: 7a799707dc57e07528afb29c135a5ee394c56354
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "62770218"
---
# <a name="tutorial-using-the-odata-source-ssis"></a>チュートリアル:[SSIS] OData ソースの使用
  このチュートリアルでは、サンプルの **Northwind** OData サービス (http://services.odata.org/V3/Northwind/Northwind.svc/) ) から **Employees** (従業員) コレクションを抽出し、フラット ファイルに読み込むプロセスについて説明します。  
  
## <a name="1-create-an-integration-services-project"></a>1.Integration Services プロジェクトの作成  
  
1.  **SQL Server Data Tools** または [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]を起動します。  
  
2.  **[ファイル]** メニューの **[新規作成]** をポイントし、 **[プロジェクト]** をクリックします。  
  
3.  **[新しいプロジェクト]** ダイアログ ボックスで **[インストール済み]** 、 **[テンプレート]** 、 **[ビジネス インテリジェンス]** の順に展開し、 **[Integration Services]** をクリックします。  
  
4.  プロジェクトの種類として、 **[Integration Services プロジェクト]** をクリックします。  
  
5.  プロジェクトの **[名前]** を入力し、 **[場所]** を選択して、 **[OK]** をクリックします。  
  
## <a name="2-add-and-configure-odata-source-to-the-ssis-package"></a>2.SSIS パッケージへの OData ソースの追加と構成  
  
1.  **[SSIS ツールボックス]** の **[データ フロー タスク]** を、SSIS パッケージの制御フロー デザイン画面にドラッグ アンド ドロップします。  
  
2.  **[データ フロー]** タブをクリックするか、新しく追加した **[データ フロー タスク]** をダブルクリックして、 **[データ フロー]** デザイン画面を起動します。  
  
3.  **[SSIS ツールボックス]** の **[共通]** から **[OData ソース]** をドラッグ アンド ドロップします。 **OData ソース** を最初にインストールするときに、OData ソースは **[SSIS ツールボックス]** の **[共通]** グループの下に表示されます。  
  
4.  **OData ソース** コンポーネントをダブルクリックして、 **[OData ソース エディター]** ダイアログ ボックスを開きます。  
  
5.  **[新規]** をクリックし、新しい OData 接続マネージャーを追加します。  
  
6.  **[サービス ドキュメントの場所]** に対応する OData サービスの URL を入力します。 サービス ドキュメントに対応する URL、または特定のフィードかエンティティに対応する URL を指定できます。 このチュートリアルでは、「 [ http://services.odata.org/V3/Northwind/Northwind.svc/](http://services.odata.org/V3/Northwind/Northwind.svc/)します。  
  
7.  OData サービスにアクセスするために、 **[認証]** で **[Windows 認証]** が選択されていることを確認します。 既定では、 **[Windows 認証]** が選択されています。 基本認証を使用するには、 **[次のユーザー名とパスワードを使用]** を選択します。  
  
8.  接続に対応する **[接続テスト]** をクリックし、 **[OK]** をクリックして OData 接続マネージャーのインスタンスを作成します。  
  
9. **[OData ソース エディター]** ダイアログ ボックスの **[リソースのパスでコレクションを使用する]** オプションで **[コレクション]** が選択されていること確認します。  
  
10. **[コレクション]** ドロップダウン リストで、 **[Employees]** を選択します。  
  
11. **[クエリ オプション]** で、追加の OData クエリ オプションまたはフィルターを入力します。 例: $orderby=CompanyName&$top=100. このチュートリアルでは、「 **$top=5**」と入力します。  
  
12. **[プレビュー]** をクリックして、データをプレビューします。  
  
13. 左側のナビゲーション ウィンドウで **[列]** をクリックし、 **[列]** ページに切り替えます。  
  
14. **[使用できる外部列]** で **[EmployeeID]** 、 **[FirstName]** 、 **[LastName]** の各チェック ボックスをオンにし、これらを選択します。  
  
15. **[OK]** をクリックし、 **[OData ソース エディター]** ダイアログ ボックスを閉じます。  
  
## <a name="3-add-flat-file-destination-and-test-the-solution"></a>3.フラット ファイル変換先の追加とソリューションのテスト  
  
1.  今度は、 **[SSIS ツールボックス]** の **[フラット ファイル変換先]** を、 **[OData ソース]** コンポーネントの下にある [データ フロー] デザイン画面にドラッグ アンド ドロップします。  
  
2.  青い矢印を使用して、 **[OData ソース]** コンポーネントを **[フラット ファイル変換先]** コンポーネントに接続します。  
  
3.  **[フラット ファイル変換先]** をダブルクリックします。 **[フラット ファイル変換先エディター]** ダイアログ ボックスが表示されます。  
  
4.  **[フラット ファイル変換先エディター]** ダイアログ ボックスで **[新規]** をクリックし、新しいフラット ファイル接続マネージャーを作成します。  
  
5.  **[フラット ファイル形式]** ダイアログ ボックスで、 **[区切り記号]** を選択します。 **[フラット ファイル接続マネージャー エディター]** ダイアログ ボックスが表示されます。  
  
6.  **[フラット ファイル接続マネージャー エディター]** ダイアログ ボックスの **[ファイル名]** で、「 **c:\Employees.txt**」と入力します。  
  
7.  左側のナビゲーション ウィンドウで、 **[列]** をクリックします。 このページで、データをプレビューできます。  
  
8.  **[OK]** をクリックして、[ファイル接続マネージャー エディター] ダイアログ ボックスを閉じます。  
  
9. **[フラット ファイル変換先エディター]** ダイアログ ボックスにある左側のナビゲーション ウィンドウで **[マッピング]** をクリックします。 マッピングを確認します。  
  
10. [OK] をクリックして、 **[フラット ファイル変換先エディター]** ダイアログ ボックスを閉じます。  
  
11. SSIS パッケージをコンパイルして実行します。 OData フィードから得られた 5 人の従業員の ID、名、姓を使用して出力ファイルが作成されたことを確認します。  
  
  
