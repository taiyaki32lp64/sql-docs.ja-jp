---
title: 作成および共有データ ソース (Reporting Services の SharePoint 統合モード) の管理 |Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- SharePoint integration [Reporting Services], shared data sources
- shared data sources [Reporting Services]
ms.assetid: 2d3428e4-a810-4e66-a287-ff18e57fad76
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 5eedb74dd5a24f40469b3ee6a4a24e97e6e59174
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "66109632"
---
# <a name="create-and-manage-shared-data-sources-reporting-services-in-sharepoint-integrated-mode"></a>共有データ ソースを作成および管理する (Reporting Services の SharePoint 統合モード)
  SharePoint ライブラリからレポートを実行する場合は、レポート内で、またはそのレポートにリンクされている外部ファイルで、接続情報を定義できます。 レポートに埋め込む接続情報をカスタム データ ソースと呼びます。 外部ファイル内で定義する接続情報を共有データ ソースと呼びます。 外部ファイルとしては、レポート サーバー データ ソース (.rsds) ファイルまたは Office データ接続 (.odc) ファイルを使用できます。  
  
 .rsds ファイルは、.rds ファイルと似ていますが、スキーマが異なります。 .rsds ファイルを作成するには、レポート デザイナーまたはモデル デザイナーから SharePoint ライブラリに .rds をパブリッシュできます (新しい .rsds ファイルが元の .rds ファイルから作成されます)。 または、SharePoint サイトのライブラリに新しいファイルを作成することもできます。  
  
 共有データ ソースを作成またはパブリッシュした場合は、後で接続プロパティを編集したり、使用されなくなったファイルを削除することができます。 共有データ ソースを削除する前に、共有データ ソースがレポートおよびレポート モデルによって使用されているかどうかを判断する必要があります。 共有データ ソースを参照している依存アイテムを表示することによって、この操作を行えます。  
  
 依存アイテムの一覧では、共有データ ソースが参照されているかどうかを確認することはできますが、アイテムがアクティブに使用されているかどうかは確認できません。 共有データ ソースまたはモデルが実際に使用されているかどうかを判断するには、レポート サーバー コンピューターのログ ファイルを調べます。 ログ ファイルへのアクセス許可がない場合や、ログ ファイルに必要な情報が記載されていない場合は、レポートの現状を確認する間、アクセスを受ける心配のないフォルダーにそのレポートを移動することを検討します。  
  
### <a name="to-create-a-shared-data-source-rsds-file-sharepoint-2010"></a>共有データ ソース (.rsds) ファイルを作成するには (SharePoint 2010)  
  
1.  ライブラリ リボンで、 **[ドキュメント]** タブをクリックします。  
  
2.  **[新しいドキュメント]** メニューの **[レポート データ ソース]** をクリックします。  
  
    > [!NOTE]  
    >  メニューに **[レポート データ ソース]** アイテムが表示されない場合は、レポート データ ソースのコンテンツ タイプが有効化されていません。 詳細については、次を参照してください。[追加レポート サーバー コンテンツ タイプをライブラリに&#40;Reporting Services SharePoint 統合モードで&#41;](../../2014/reporting-services/add-reporting-services-content-types-to-a-sharepoint-library.md)します。  
  
3.  **[名前]** に、.rsds ファイルに付けるわかりやすい名前を入力します。  
  
4.  **[データ ソースの種類]** で、一覧からデータ ソースの種類を選択します。 詳細については、「[Reporting Services でサポートされるデータ ソース &#40;SSRS&#41;](create-deploy-and-manage-mobile-and-paginated-reports.md)」をご覧ください。  
  
5.  **[接続文字列]** で、外部データ ソースへの接続を確立するために必要な設定として、データ ソースへのポインターなどを指定します。 使用するデータ ソースの種類によって、接続文字列の構文が異なります。 詳細と例については、次を参照してください。[データ接続、データ ソース、および Reporting Services の接続文字列](../../2014/reporting-services/data-connections-data-sources-and-connection-strings-in-reporting-services.md)します。  
  
6.  **[資格情報]** で、外部データ ソースにアクセスする際にレポート サーバーが資格情報を取得する方法を指定します。 資格情報は、自動レポート処理用に保存、要求、統合、または構成できます。  
  
    -   レポートを開いたユーザーの資格情報を使用してデータにアクセスする場合は、 **[Windows 認証 (統合)]** を選択します。 SharePoint サイトまたはファームでフォーム認証を使用する場合や、信頼済みアカウントを使用してレポート サーバーに接続する場合は、このオプションを選択しないでください。 このレポートのサブスクリプションまたはデータ処理をスケジュールする場合は、このオプションを選択しないでください。 Kerberos 認証が有効なドメインに参加している場合、またはレポート サーバーと同一のコンピューターにデータ ソースがある場合に、このオプションは最適です。 Kerberos 認証が無効になっている場合、Windows 資格情報は別のコンピューター 1 台にしか渡すことができません。 つまり、外部データ ソースが別のコンピューターにあり、別の接続が必要な場合、意図したデータを取得できずにエラーが発生します。  
  
    -   ユーザーがレポートを実行するたびに資格情報の入力を要求する場合は、 **[資格情報を要求する]** をクリックします。 このレポートのサブスクリプションまたはデータ処理をスケジュールする場合は、このオプションを選択しないでください。  
  
    -   1 組の資格情報を使用してデータにアクセスする場合は、 **[保存された資格情報]** を選択します。 資格情報は暗号化されてから保存されます。 保存されている資格情報の認証方法を指定するオプションを選択できます。 保存された資格情報が Windows ユーザー アカウントに属する場合は、[データ ソースへの接続時に Windows 資格情報として使用する] をクリックします。 データベース サーバーの実行コンテキストを設定する場合は、 **[実行コンテキストをこのアカウントに設定する]** をクリックします。 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)] データベースの場合、このオプションによって SETUSER 関数が設定されます。 詳細については、「[SETUSER &#40;Transact-SQL&#41;](/sql/t-sql/statements/setuser-transact-sql)」を参照してください。  
  
    -   接続文字列で資格情報を指定する場合や、レポート サーバーで構成されている最小特権アカウントを使用してレポートを実行する場合は、 **[資格情報は必要ありません]** を選択します。 レポート サーバーでこのアカウントが構成されていない場合、ユーザーは資格情報の入力を要求され、そのレポート用に定義したスケジュール済みの操作は実行されません。  
  
7.  データ ソースをアクティブにする場合は、 **[このデータ ソースを有効にする]** を選択します。 データ ソースが構成されていてもアクティブでない場合は、ユーザーがそのデータ ソースに基づくレポートを使用しようとするとエラー メッセージが表示されます。  
  
8.  データ ソース構成を検証するには、 **[接続テスト]** をクリックします。  
  
    > [!NOTE]  
    >  [接続テスト] ボタンは、XML データ ソースの種類ではサポートされません。  
  
9. **[OK]** をクリックして、共有データ ソースを作成します。  
  
### <a name="to-view-dependent-items"></a>依存アイテムを表示するには  
  
1.  .rsds ファイルを含むライブラリを開きます。  
  
2.  共有データ ソースをポイントします。  
  
3.  クリックして下矢印を表示し、 **[依存アイテムの表示]** を選択します。  
  
     レポート モデルの依存アイテムの一覧には、レポート ビルダーで作成したレポートが表示されます。 共有データ ソースの依存アイテムの一覧には、レポートとレポート モデルの両方が表示される場合があります。  
  
### <a name="to-delete-a-shared-data-source-rsds-file"></a>共有データ ソース (.rsds) ファイルを削除するには  
  
1.  .rsds ファイルを含むライブラリを開きます。  
  
2.  共有データ ソースをポイントします。  
  
3.  クリックして下矢印を表示し、 **[削除]** を選択します。  
  
 保存しておく必要のある共有データ ソースを誤って削除した場合は、同じ接続情報が含まれた新しい共有データ ソースを作成できます。 共有データ ソースを作成し直した後、そのデータ ソースを使用していたレポートおよびモデルをすべて開き、新しい共有データ ソースを選択する必要があります。 新しい共有データ ソース アイテムには、削除した共有データ ソースとは異なる名前、資格情報、または接続文字列構文を指定できます。 接続が同一のデータ ソースに解決される限り、データ ソースのプロパティが元の値と異なっても問題ありません。  
  
 レポート モデルを削除するときは注意してください。 モデルを削除すると、そのモデルを基にしているレポートをレポート ビルダーで開いて変更することができなくなります。 既存のレポートによって使用されているモデルを誤って削除した場合は、そのモデルを再生成し、そのモデルを使用するレポートの再作成と保存を行って、使用するモデル アイテム セキュリティを再指定する必要があります。 モデルを生成し直して既存のレポートに関連付けるだけでは元の状態に戻りません。  
  
## <a name="see-also"></a>参照  
 [レポート データ ソースに関する資格情報と接続情報を指定する](report-data/specify-credential-and-connection-information-for-report-data-sources.md)  
  
  
