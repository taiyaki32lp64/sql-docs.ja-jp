---
title: SharePoint リストのクエリ デザイナー (レポート ビルダー) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
f1_keywords:
- "10016"
ms.assetid: b8a3122c-8008-4950-b515-937636d7967f
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: e16dc91040596b1d083226683abe76a7e2e2c4ba
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "66107072"
---
# <a name="sharepoint-list-query-designer-report-builder"></a>SharePoint リストのクエリ デザイナー (レポート ビルダー)
  レポート ビルダーにはグラフィカル クエリ デザイナーとテキスト ベースのクエリ デザイナーが用意されており、レポート データセットの SharePoint サイトから取得するデータを指定するクエリの作成に使用できます。 SharePoint リスト メタデータを検索してクエリを対話的に作成し、クエリの結果を表示する場合は、グラフィカル クエリ デザイナーを使用します。 グラフィカル クエリ デザイナーで作成されたクエリの表示、クエリの変更、またはクエリ コマンドの入力を行う場合は、テキスト ベースのクエリ デザイナーを使用します。 ファイルまたはレポートから既存のクエリをインポートすることもできます。  
  
> [!IMPORTANT]  
>  ユーザーは、クエリを作成して実行する際にデータ ソースにアクセスします。 したがって、データ ソースに対する最小限の権限 (読み取り専用権限など) を付与する必要があります。  
  
## <a name="graphical-query-designer"></a>グラフィカル クエリ デザイナー  
 グラフィカル クエリ デザイナーでは、SharePoint サイトを検索し、データセットの SharePoint リスト データを取得するコマンドを対話的に作成できます。 データセットに含めるフィールドを選択し、必要に応じて、データセットのデータを制限するフィルターを指定します。 フィルターをパラメーターとして使用することを指定すると、フィルターの値を実行時に提供できます。  
  
 SharePoint リストには、レポートに含めるには適さない大量の SharePoint 固有フィールドが含まれています。 クエリ デザイナーには、使用するフィールドを見つけやすいようにフィールドを非表示にするオプションが用意されています。  
  
 グラフィカル クエリ デザイナーは、3 つの領域に分割されています。  
  
-   使用するリスト アイテムおよびそのフィールドを選択するための探索ペイン。  
  
-   クエリを作成するためのデザイン領域。  
  
-   クエリ結果を表示するための結果ペイン。  
  
 次の図は、SharePoint リストを使用した場合のグラフィカル クエリ デザイナーです。  
  
 ![rsQD_Relational_Graphical_SharePoint](../media/rsqd-relational-graphical-sharepoint.gif "rsQD_Relational_Graphical_SharePoint")  
  
 次の表に各ペインの機能を示します。  
  
 [SharePoint リスト](#DatabaseView)  
 SharePoint リストとリストに含まれる各アイテム内のフィールドを表示します。  
  
 [選択されたフィールド](#SelectedFields)  
 SharePoint リスト ペインで選択したアイテムの SharePoint リストのフィールド名の一覧を表示します。 これらのフィールドがレポート データセットのフィールド コレクションになります。  
  
 [適用されたフィルター](#AppliedFilters)  
 データベース ビューのテーブルまたはビューのフィールドおよびフィルター条件の一覧を表示します。  
  
 [クエリ結果](#QueryResults)  
 自動的に生成されたクエリの結果セットのサンプル データを表示します。  
  
###  <a name="DatabaseView"></a> SharePoint リスト ペイン  
 SharePoint リスト ペインには、表示する権限のあるデータベース オブジェクトのメタデータが表示されます。表示されるメタデータは、データ ソース接続と資格情報によって決まります。 階層ビューに、データベース スキーマ別に編成されたデータベース オブジェクトが表示されます。 各スキーマのノードを展開すると、テーブル、ビュー、ストアド プロシージャ、およびテーブル値関数が表示されます。 テーブルまたはビューを展開すると列が表示されます。  
  
###  <a name="SelectedFields"></a> 選択されたフィールド ペイン  
 選択されたフィールド ペインには、SharePoint リスト アイテムについて選択したリスト アイテム フィールドが表示されます。 このペインに表示されるフィールドがレポート データセットのフィールド コレクションになります。 データセットとクエリを作成した後、レポート データ ペインを使用して、レポート データセットのフィールド コレクションを表示できます。 これらのフィールドは、レポートを表示するときにテーブル、グラフ、およびその他のレポート アイテムに表示できるデータを表します。  
  
 このペインのフィールドを追加したり削除したりするには、SharePoint リスト ペインでテーブルまたはビューのフィールドのチェック ボックスをオンまたはオフにします。  
  
###  <a name="AppliedFilters"></a> 適用されたフィルター ペイン  
 適用されたフィルター ペインには、実行時に取得されるデータの行数を制限するために使用される条件が表示されます。 このペインで指定された条件を使用して [!INCLUDE[tsql](../../includes/tsql-md.md)] の WHERE 句が生成されます。 パラメーター オプションを選択すると、レポート パラメーターが自動的に生成されます。 クエリ パラメーターに基づくレポート パラメーターを使用すると、ユーザーがクエリの値を指定してレポートのデータを制御できるようになります。  
  
 次の列が表示されます。  
  
-   **[フィールド名]** 条件を適用するフィールドの名前を表示します。  
  
-   **[演算子]** フィルター式で使用する演算を表示します。  
  
-   **[値]** フィルター式で使用する値を表示します。  
  
-   **パラメーター** : クエリ パラメーターをクエリに追加するオプションを表示します。 [データセットのプロパティ] を使用すると、クエリ パラメーターとレポート パラメーターの関係を表示できます。  
  
###  <a name="QueryResults"></a> クエリ結果ペイン  
 クエリ結果ペインには、その他のペインの選択内容によって指定されている自動的に生成されたクエリの結果が表示されます。 結果セットの列は選択されたフィールド ペインで指定したフィールドで、行データは適用されたフィルター ペインで指定したフィルターによって制限されます。  
  
 このデータは、クエリの実行時にデータ ソースから取得された値を表します。 このデータはレポート定義に保存されません。レポートの実際のデータは、レポートの処理時に取得されます。  
  
 結果セットの並べ替え順序は、データがデータ ソースから取得された順序によって決まります。 並べ替え順序は、クエリの修正によって変更することも、レポートのデータが取得された後に変更することもできます。  
  
### <a name="graphical-query-designer-toolbar"></a>グラフィカル クエリ デザイナーのツール バー  
 リレーショナル クエリ デザイナーのツール バーにある次のボタンを使用すると、クエリを指定したりその結果を表示したりすることができます。  
  
|ボタン|説明|  
|------------|-----------------|  
|**[テキストとして編集]**|テキスト ベースのクエリ デザイナーに切り替えて、自動的に生成されたクエリの表示や変更を行います。|  
|**[インポート]**|ファイルまたはレポートから既存のクエリをインポートします。 サポートされているファイルの種類は .sql と .rdl です。|  
|**[クエリの実行]**|クエリを実行します。 クエリ結果ペインに結果セットが表示されます。|  
|**[非表示フィールドの表示]**|SharePoint リンク アイテムの ProgID やレベルなど、SharePoint で自動的に生成されたが、レポートでは通常使用されないフィールドの表示と非表示を切り替えます。 これらのフィールドを非表示にすると、フィールド一覧が簡略化され、使いやすくなります。|  
  
## <a name="see-also"></a>参照  
 [クエリ デザイナー &#40;レポート ビルダー&#41;](../query-designers-report-builder.md)  
  
  
