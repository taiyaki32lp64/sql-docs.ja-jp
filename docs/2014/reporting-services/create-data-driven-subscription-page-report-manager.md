---
title: 作成するデータ ドリブン サブスクリプション ページ (レポート マネージャー) |Microsoft Docs
ms.custom: ''
ms.date: 05/24/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
ms.assetid: 814b4653-572a-48c7-847f-b310ba0f3046
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 130027d60f5458b451d4f853a79228510c5e7d66
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "66109618"
---
# <a name="create-data-driven-subscription-page-report-manager"></a>[データ ドリブン サブスクリプションの作成] ページ (レポート マネージャー)
  [データ ドリブン サブスクリプションの作成] ページでは、実行するたびにサブスクライバー データベースにサブスクリプション情報をクエリするサブスクリプションを作成または変更できます。 データ ドリブン サブスクリプションはクエリ結果を使用して、サブスクリプションの受信先、配信設定、およびレポート パラメーターの値を決定します。 実行時に、レポート サーバーで、サブスクリプションの設定に使用されている値を取得するクエリが実行されます。 [データ ドリブン サブスクリプションの作成] ページを使用して、クエリを定義し、クエリの値をサブスクリプションの設定に割り当てることができます。 データドリブン サブスクリプションに指定する値およびオプションは、いくつかのウィザード形式になったページに分かれて表示されます。 ページは全部で 7 ページあります。  
  
 データドリブン サブスクリプションを作成するには、サブスクリプションのデータを取得するクエリまたはコマンドの記述方法についての知識が必要です。 また、サブスクリプションで使用するサブスクライバー データ (サブスクライバーの名前や電子メール アドレスなど) を格納するデータ ストアが必要です。  
  
 このページを表示できるのは、高度な権限を持つユーザーのみです。 既定のセキュリティを設定している場合、[個人用レポート] フォルダーにあるレポートに対してデータ ドリブン サブスクリプションを使用することはできません。  
  
> [!NOTE]  
>  この機能は、 [!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]のすべてのエディションで使用できるわけではありません。 エディションでサポートされている機能の一覧については[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]を参照してください[機能は、SQL Server 2014 の各エディションでサポートされている](../../2014/getting-started/features-supported-by-the-editions-of-sql-server-2014.md)します。  
  
## <a name="navigation"></a>ナビゲーション  
 ユーザー インターフェイス (UI) のこの場所に移動するには、次の手順に従います。  
  
###### <a name="to-open-the-data-driven-subscription-page"></a>[データ ドリブン サブスクリプション] ページを開くには  
  
1.  レポート マネージャーを開き、データ ドリブン サブスクリプションを作成するレポートを探します。  
  
2.  レポートの上にマウス ポインターを移動し、下矢印をクリックします。  
  
3.  ドロップダウン メニューの **[管理]** をクリックします。 この操作により、レポートの **[全般]** プロパティ ページが開きます。  
  
4.  **[サブスクリプション]** タブをクリックし、 **[新しいデータ ドリブン サブスクリプション]** をクリックします。  
  
    > [!NOTE]  
    >  このボタンを有効にするには、保存されている資格情報をレポートのデータ ソースで使用する必要があります。  
  
## <a name="start-a-subscription-page-1"></a>サブスクリプションの開始 (ページ 1)  
 **[説明]**  
 サブスクリプションの説明が表示されます。 この説明は、 **[個人用サブスクリプション]** およびレポートの **[サブスクリプション]** タブのサブスクリプションの一覧に表示されます。  
  
 **受信者の通知方法を指定します。**  
 レポートの配信に使用する配信拡張機能を選択します。 サブスクリプションごとに使用できる配信拡張機能は、1 つだけです。 使用できるオプションは以下のとおりです。  
  
-   ファイル共有にレポートを配信するには、 **[レポート サーバーのファイル共有]** を選択します。 レポートは、レポート サーバーから切断された静的ファイルとして配信されます。 詳細については、「 [File Share Delivery in Reporting Services](subscriptions/file-share-delivery-in-reporting-services.md)」を参照してください。  
  
-   電子メールの受信トレイにレポートを配信するには、 **[レポート サーバーの電子メール]** を選択します。 詳細については、「 [E-Mail Delivery in Reporting Services](subscriptions/e-mail-delivery-in-reporting-services.md)」を参照してください。  
  
-   レポート サーバー データベースにレポートを配信するには、 **[NULL 配信プロバイダー]** を選択します。 このオプションを使用すると、レポート スナップショットが作成されます。 特定のスケジュールに基づいて、ユーザー固有のレポート スナップショットまたはパラメーター化されたレポート スナップショットをレポート サーバーに事前に読み込む場合に、このオプションを選択します。 詳細については、「 [レポートのキャッシュ (SSRS)](report-server/caching-reports-ssrs.md)でキャッシュを事前に読み込む唯一の方法でした。  
  
 **受信者の情報を含むデータ ソースを指定します。**  
 データ ソース接続の定義方法を指定します。 必要な接続情報が含まれている共有データ ソースがあれば、それを選択することができます。 このサブスクリプションで接続情報を直接指定することもできます。  
  
 データ ソースで、サブスクライバー データを提供します。 サブスクライバーのデータは、従業員名、従業員 ID、電子メール アドレス、およびエクスポート形式 (HTML、PDF など) の設定から構成されます。 レポート サーバーの電子メール配信拡張機能を使用している場合、データ ソースに電子メール アドレスを含める必要があります。  
  
## <a name="specify-a-connection-page-2"></a>接続の指定 (ページ 2)  
 共有データ ソースを指定した場合、このページで共有データ ソース アイテムを選択します。 アイテムを参照および選択する際には、ツリー コントロールを使用できます。 このサブスクリプションに対して接続を定義している場合、このページで以下のオプションを指定します。  
  
 **接続の種類**  
 データ ソースに対して使用するデータ処理拡張機能を選択します。  
  
 **接続文字列**  
 データ ソースへの接続に使用する接続文字列を入力します。  
  
 **使用して接続します。**  
 データ ソースに接続するときに使用する資格情報を入力します。 この資格情報は、値が暗号化されてレポート サーバー データベースに保存されます。  
  
 データ ソースで Windows 認証を使用する場合は、接続の指定時に **[Windows 資格情報として使用する]** をオンにします。  
  
 ユーザー接続を認証しないデータ ソースを使用する場合 (データ ソースが XML ファイルの場合など) は、[資格情報は必要ありません] をオンにします。 このオプションを使用するには、自動実行アカウントをあらかじめ構成しておく必要があります。 詳細については、「[自動実行アカウントを構成する &#40;SSRS 構成マネージャー&#41;](install-windows/configure-the-unattended-execution-account-ssrs-configuration-manager.md)」を参照してください。  
  
## <a name="specify-a-query-page-3"></a>クエリの指定 (ページ 3)  
 このページを使用して、サブスクライバー データを取得するクエリを入力します。 最適な結果を得るには、クエリを最初に SQL Server Management Studio で実行してから、データ ドリブン サブスクリプションで使用します。 こうすると、結果を調べて必要な情報が含まれているかどうかを確認できます。 クエリ結果に関して重要な点は次のとおりです。  
  
-   結果セット内の列によって、配信オプションおよびレポート パラメーターに指定できる値が決まります。 たとえば、電子メール配信のデータ ドリブン サブスクリプションを作成する場合は、電子メール アドレスの列が必要です。  
  
-   結果セット内の行によって、生成されるレポート配信の数が決まります。 行数が 10,000 の場合、レポート サーバーから通知と配信が 10,000 回生成されます。  
  
 **クエリ**  
 サブスクリプションの各受信者を表す行が 1 行ずつ格納されている結果セットを取得する SQL クエリまたは SQL コマンドを指定します。 以降のページでは、結果セットを使用してデータ ドリブン拡張機能の設定を定義します。  
  
 **Timeout**  
 クエリのタイムアウト値を指定します。 クエリの処理が完了できるだけの大きな値にする必要があります。  
  
 **[検証]**  
 **[検証]** をクリックすると、クエリが検証されます。 クエリから有効な結果を得られないと、次へ進めません。 **[検証]** をクリックしなかった場合、 **[次へ]** をクリックしたときにクエリが検証されます。  
  
## <a name="set-delivery-options-page-4"></a>配信オプションの設定 (ページ 4)  
 4 ページ目は、配信拡張機能オプションを指定します。 このページに表示されるオプションは、配信拡張機能から派生したものです。 使用する配信拡張機能により表示されるオプションが変わると、オプションの指定方法も大幅に変わります。 拡張機能に設定項目がない場合、このページにはオプションが表示されません。  
  
|選択するオプション|目的|  
|-----------------|----------------|  
|**静的な値を指定します。**|配信設定に定数値を使用します。 一部の配信拡張機能では、静的な値の候補が表示されます。 たとえば、レポート サーバーの電子メール配信機能の場合、 **[レポートを含める]** 、 **[表示形式]** 、 **[優先度]** 、および **[リンクを含める]** の値が表示されます。|  
|**データベースから値を取得します。**|結果セットの値を使用します。 結果セットの列は、サブスクライバー データおよびレポート パラメーターの値の指定に使用できます。|  
|**値はありません。**|サブスクリプションの設定を省略します。|  
  
#### <a name="set-delivery-options-for-file-share-delivery"></a>ファイル共有配信の配信オプションの設定  
 ファイル共有配信拡張機能は事前構成を必要としないため、よく使用されます。 ファイル共有配信拡張機能を使用する場合、次に示すオプションを設定できます。  
  
 **[ファイル名]**  
 レポートのファイル名を指定します。 ファイル共有配信拡張機能では、レポートを静的なアプリケーション ファイルとして共有フォルダーに配信します。 ほとんどの場合、データベースの値を使用してファイル名を作成する必要があります。 静的な値を使用すると、書き込みモードの設定によっては、新しい配信のたびに以前の配信が上書きされることがあります。  
  
 **[パス]**  
 ネットワーク接続経由でアクセス可能な共有フォルダーを指定します。 そのフォルダーにアクセスできることを確認するには、次のようにクリックします**実行**スタート メニューにこの形式でフォルダー パスを入力します: \\ \\< computername\>\\< sharedfoldername\>.  
  
 **[表示形式]**  
 ファイルの出力形式を指定します。 レポート サーバーでは、レポート サーバーにインストールされている表示拡張機能のアプリケーション形式で、ファイルを書き込むことができます。  
  
 **[書き込みモード]**  
 レポート サーバーで同じ名前のファイルが見つかった場合に、ファイルを新しいバージョンに置換するか、ファイルを追加するか、または配信を削除するかを指定します。  
  
 **[ファイル拡張子]**  
 選択した表示形式に適合するファイル拡張子を追加するには、この値を TRUE に指定します。  
  
 **ユーザー名**  
 この形式で共有フォルダーにファイルを追加する権限を持つドメイン ユーザー アカウントを入力します:\<ドメイン >\\< ユーザー名\>します。  
  
 **Password**  
 アカウントのパスワードを入力します。  
  
## <a name="set-parameters-page-5"></a>パラメーターの設定 (ページ 5)  
 レポートにパラメーターが含まれている場合、そのレポートで使用するパラメーターの値を指定する必要があります。 パラメーターの値はサブスクライバーのデータ ソースから取得できます (たとえば、地域コードを基にパラメーター化されている地域別売上レポートがあるとすると、従業員ごとの地域別情報が従業員データベースに保存されている場合、その情報を取得できます)。  
  
|選択するオプション|目的|  
|-----------------|----------------|  
|**静的な値を指定します。**|すべてのサブスクリプションで同一のパラメーターを使用する場合、パラメーターに定数値を使用します。 パラメーターが複数の値を持つ場合は、一覧から値を選択できます。|  
|**既定値の使用**|パラメーターのすべてまたは一部に対して既定値が含まれているレポートもあります。 レポート パラメーターに既定値がある場合、その既定値を使用するにはこのチェック ボックスをオンにします。|  
|**データベースから値を取得します。**|結果セットの値を使用します。 結果セットの列は、サブスクリプションの各インスタンスで使用するデータ値の取得元として選択できます。|  
  
## <a name="specify-a-trigger-page-6"></a>トリガーの指定 (ページ 6)  
 サブスクリプション処理を開始するイベントを選択します。  
  
|選択するオプション|目的|  
|-----------------|----------------|  
|**レポート サーバーでレポート データの更新時**|レポートをレポート実行スナップショットとして実行するよう構成している場合、スナップショットの更新時にサブスクリプションを実行するよう指定できます。|  
|**このサブスクリプション用に作成されたスケジュールで**|指定した日時にサブスクリプションを実行します。|  
|**共有スケジュールで実行**|共有スケジュールで指定されているスケジュール情報を使用してサブスクリプションを実行します。|  
  
## <a name="schedule-a-subscription-page-7"></a>サブスクリプションのスケジュールの設定 (ページ 7)  
 サブスクリプションのスケジュールを設定する場合、レポートを配信する頻度を指定する必要があります。 最初のオプション群で、頻度のカテゴリ (時間単位、日単位、週単位など) を指定します。 2 番目のオプション群は、最初の選択に基づいて表示されます。  
  
 **1 時間ごと**  
 1 時間ごとに実行されるスケジュールを定義します。  
  
 **毎日**  
 選択した日の指定した時刻に実行されるスケジュールを定義します。 次の方法では、日を指定できます。すべて *\<日>* 、すべての平日、毎回 *\<数>* 日。 いずれかのオプションを選択すると、それ以外のオプションは表示されていても無効になります。  
  
 **毎週**  
 毎週特定の曜日の指定した時刻に実行されるスケジュールを定義します。 実行間隔は、2 週間ごとのようにちょうど 1 週間を単位としているものでも、週の複数の曜日を指定するものでもかまいません。  
  
 **月単位**  
 1 か月ごとに実行されるスケジュールを定義します。 1 か月の中で、あるパターンを基にした日 (毎月最終日曜日など) か、特定の日付 (たとえば、1 と 15 を指定して毎月 1 日と 15 日) を選択できます。 コンマおよびハイフンを使用して、複数の日や期間を指定できます (たとえば、1, 5, 7-12, 21)。  
  
 **1 回。**  
 一度だけ実行されるスケジュールを定義します。 **[開始日および終了日]** セクションを使用して、スケジュールを実行する日を指定します。 このスケジュールは、処理が終了すると失効します。  
  
 **開始と終了日**  
 スケジュール タスクが発効する日を確定する開始日、およびスケジュールが失効する日を確定する終了日を指定します。 スケジュールは予告なく失効します。 終了日を過ぎると、スケジュールは実行されません。  
  
## <a name="saving-the-subscription"></a>サブスクリプションの保存  
 サブスクリプションについての情報が揃うと、 **[完了]** ボタンが有効になります。 **[完了]** をクリックすると、サブスクリプションが完成します。  
  
## <a name="see-also"></a>参照  
 [レポート マネージャー &#40;SSRS ネイティブ モード&#41;](../../2014/reporting-services/report-manager-ssrs-native-mode.md)   
 [データ ドリブン サブスクリプション](subscriptions/data-driven-subscriptions.md)   
 [データ ドリブン サブスクリプションの作成 &#40;SSRS チュートリアル&#41;](create-a-data-driven-subscription-ssrs-tutorial.md)   
 [レポート データ ソースに関する資格情報と接続情報を指定する](report-data/specify-credential-and-connection-information-for-report-data-sources.md)   
 [サブスクリプションと配信 &#40;Reporting Services&#41;](subscriptions/subscriptions-and-delivery-reporting-services.md)   
 [レポート マネージャー F1 ヘルプ](../../2014/reporting-services/report-manager-f1-help.md)  
  
  
