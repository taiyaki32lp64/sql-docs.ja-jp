---
title: データ更新 (PowerPivot for SharePoint) のスケジュール |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- unattended data refresh [Analysis Services with SharePoint]
- scheduled data refresh [Analysis Services with SharePoint]
- data refresh [Analysis Services with SharePoint]
ms.assetid: 8571208f-6aae-4058-83c6-9f916f5e2f9b
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: 429b35f6865deb5c0c3dd79e21cfe16cac7fae91
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "66070008"
---
# <a name="schedule-a-data-refresh-powerpivot-for-sharepoint"></a>データ更新のスケジュール (PowerPivot for SharePoint)
  データ更新をスケジュールすると、SharePoint サイトにパブリッシュした Excel ブック内の PowerPivot データが自動更新されるようになります。  
  
 **[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010  
  
 **このトピックの内容:**  
  
 [前提条件](#prereq)  
  
 [データ更新の概要](#intro)  
  
 [データ更新の有効化とスケジュール](#drenablesched)  
  
 [データ更新を確認します。](#drverify)  
  
> [!NOTE]  
>  PowerPivot データ更新は、SharePoint ファーム内の Analysis Services サーバー インスタンスによって実行されます。 Excel Services のデータ更新機能とは関係ありません。 PowePivot スケジュールのデータ更新機能では、PowerPivot 以外のデータは更新されません。  
  
##  <a name="prereq"></a> 前提条件  
 データ更新スケジュールを作成するには、ブックの投稿レベル以上の権限を持っている必要があります。  
  
 データ更新時にアクセスされる外部データ ソースが使用可能であること、およびスケジュールに指定した資格情報がそれらのデータ ソースにアクセスする権限を持っていることが必要です。 スケジュールされたデータ更新には、ネットワーク接続を介してアクセスできるデータ ソースの場所が必要になります (たとえば、ワークステーションのローカル フォルダーではなく、ネットワーク ファイル共有など)。  
  
 データ ソースには、Office ドキュメントまたは Access データベースを指定することはできません。 Office では、サーバー環境での Office データ接続コンポーネントの使用をサポートしていません。 ブックにそれらのソースからのデータが含まれている場合は、データ更新スケジュールのデータ ソースの一覧からそれらのソースを削除してください。  
  
 ブックは [!INCLUDE[ssSQL11](../includes/sssql11-md.md)] のバージョンであることが必要です。 以前のリリースの PowerPivot for Excel で作成されたブックを使用する場合、データベースを最新のバージョンにアップグレードしないと、データ更新のスケジュールが正常に機能しません。  
  
 更新操作の終了時に、ブックがチェックインされている必要があります。 ブックに対するロックは、データ更新の最後に、ファイルに対して行われます (更新の開始時ではなく、ファイルが保存されるときに実行されます)。  
  
> [!NOTE]  
>  データ更新の進行中に、サーバーによってブックがロックされることはありません。 ただし、更新されたファイルをチェックインするために、ファイルはデータ更新の終了時にロックされます。 この時点でファイルが別のユーザーにチェックアウトされると、更新されたデータは破棄されます。同様に、データ更新の開始時にサーバーが取得したコピーと大幅に異なるファイルがチェックインされた場合、更新されたデータは破棄されます。  
  
##  <a name="intro"></a> データ更新の概要  
 Excel ブックの PowerPivot データは、リモート サーバーやネットワーク ファイル共有からアクセスされる外部のデータベースやデータ ファイルなど、複数の外部データ ソースから取得できます。 接続された外部データ ソースからインポートされたデータを含む PowerPivot ブックの場合は、データ更新を構成して、元のソースで更新されたデータを自動的にインポートするようにスケジュールできます。  
  
 外部データ ソースには、PowerPivot クライアント アプリケーションを使用してブックに元のデータをインポートしたときに指定した、埋め込まれた接続文字列、URL、または UNC パスを通してアクセスします。 PowerPivot ブックに格納された元の接続情報が、その後のデータ更新操作に再利用されます。 データ ソースへの接続に使用される資格情報を上書きできますが、データ更新の目的で接続文字列を上書きすることはできません。既存の接続情報のみが使用されます。  
  
 各ブックには、データ更新スケジュール ページが 1 つだけあり、そのページにすべてのスケジュール情報が指定されています。 通常は、ブックの作成者がスケジュールを定義します。  
  
 スケジュール所有者として、次のタスクを実行できます。  
  
-   既定のスケジュールを定義する。 これは、データ ソース レベルで定義されているスケジュールがない場合に使用されるスケジュールです。  
  
-   データ更新の実行に使用される資格情報を指定する。  
  
-   どのデータ ソースを更新操作に含めるかを選択する。  
  
-   必要に応じて、データ更新時に照会される各データ ソースの個別のスケジュールと資格情報をインラインで指定します。 各データ ソースは、個別に更新できます。 すべてのデータ ソースにカスタム スケジュールを作成すると、既定のスケジュールは無視されます。  
  
 個々のデータ ソースに対して詳細なスケジュールを作成することで、外部データ ソースでの変動に合わせた更新スケジュールを作成できます。 たとえば、1 日をとおして生成されるトランザクション データが含まれる外部データ ソースに対しては、更新された情報を毎晩取得するようなデータ更新スケジュールを個別に作成できます。  
  
##  <a name="drenablesched"></a> データ更新の有効化とスケジュール  
 SharePoint ライブラリにパブリッシュした Excel ブック内の PowerPivot データ用にデータ更新をスケジュールするには、次の手順に従ってください。  
  
1.  ブックが含まれているライブラリで、ブックを選択して下矢印をクリックし、コマンドの一覧を表示します。  
  
2.  **[PowerPivot データ更新の管理]** をクリックします。 データ更新スケジュールが既に定義されている場合は、代わりに [データ更新履歴の表示] ページが表示されます。 **[データ更新の構成]** をクリックすると、スケジュール定義ページが開きます。  
  
3.  スケジュール定義ページで、 **[有効]** チェック ボックスをオンにします。  
  
4.  [スケジュールの詳細] で、スケジュールの種類とその詳細を指定します。 この手順では、既定のスケジュールを作成します。  
  
    > [!IMPORTANT]  
    >  **[さらに、できるだけ早く更新を行います]** チェック ボックスをオンにしてください。 これにより、このブックに対してデータ更新が機能していることを確認できます。 スケジュールを保存した後、データ更新が開始するまで最大 1 分かかることがあります。  
  
5.  [最も早い開始時刻] で、次のいずれかを選択します。  
  
    1.  **[営業時間後]** は、営業時間外の処理期間を示します。これは、その日の営業時間に生成された最新のデータがデータベース サーバーに保存されている可能性が高い期間です。  
  
    2.  **[特定の最も早い開始時刻]** は、データ更新要求が処理キューに追加される最も早い開始時刻です。 15 分間隔で指定できます。 この設定は、現在の日付や将来の日付に適用されます。 たとえば、午前 6 時 30 分の値を指定して 現在の時間が午後 4 時 30 分である場合、午後 4 時 30 分は午前 6 時 30 分の後であるため、更新要求は現在の日付のキューに追加されます。 午前 6 時 30 分後にします。  
  
     最も早い開始時刻は、要求が処理キューに追加される時間を表します。 実際の処理は、データ処理の開始に適したリソースがサーバーに存在する時点で行われます。 処理完了後に、実際の処理時間がデータ更新の履歴に記録されます。  
  
6.  **[さらに、できるだけ早く更新を行います]** チェック ボックスをオンにして、データ更新をサーバーが処理できるようになったらすぐに実行します。 データ更新ジョブが成功したら、データ ソースが利用可能であり、権限とサーバー構成が正しく設定されていることが確認できます。  
  
7.  [電子メール通知] に、処理エラーの発生時に通知するユーザーの電子メール アドレスを入力します。  
  
8.  [資格情報] では、データ更新ジョブの実行に使用するアカウントを指定します。 データ更新のためにブックを開くことができるように、このアカウントにはブックに対する投稿権限が必要です。 また、Windows ドメイン ユーザー アカウントであることも必要です。 多くの場合、このアカウントにはデータ更新時に使用される外部データ ソースに対する読み取り権限も必要です。 特に、最初に [Windows 認証を使用する] オプションを使用してデータをインポートした場合、現在のユーザーの Windows 資格情報を使用する接続文字列が作成されます。 現在のユーザーがデータ更新アカウントの場合、データ更新を成功させるためには、そのアカウントに外部データ ソースに対する読み取り権限が必要です。 次のいずれかのオプションを選択します。  
  
    1.  PowerPivot 自動データ更新アカウントを使用してデータ更新操作を処理する場合は、 **[管理者によって構成されたデータ更新アカウントを使用します]** を選択します。  
  
    2.  ユーザー名とパスワードを入力する場合は、 **[次の Windows ユーザー資格情報を使用して接続する]** を選択します。 アカウント情報は、"ドメイン\ユーザー" の形式で入力します。  
  
    3.  使用する保存済みの資格情報を含んでいる対象アプリケーションの ID がわかっている場合は、 **[Secure Store Service で保存した資格情報を使用して接続する]** を選択します。  
  
     これらのオプションの詳細については、「[Power Pivot データ更新用の保存された資格情報の構成&#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)」および「[Power Pivot 自動データ更新アカウントの構成 &#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md)」を参照してください。  
  
9. データ更新で更新前のすべてのデータ ソースに対してクエリを再実行する場合は、[データ ソース] の **[すべてのデータ ソース]** チェック ボックスをオンにします。  
  
     このオプションをオンにすると、PowerPivot データを提供するすべての外部データ ソースが自動的に更新に含まれます。ブックにデータを提供するデータ ソースの追加や削除に伴ってデータ ソースの一覧が変更されても、影響を受けません。  
  
     更新に含めるデータ ソースを手動で選択する場合は、[データ ソース] の **[すべてのデータ ソース]** チェック ボックスをオフにします。 後で新しいデータ ソースを追加してブックを変更する場合は、スケジュールのデータ ソースの一覧を更新してください。 この操作を実行しないと、新しいデータ ソースが更新操作に含まれません。  
  
     選択に使用できるデータ ソースの一覧は、ブックの [PowerPivot データ更新の管理] ページを開いたときに、PowerPivot ブックから取得されます。  
  
     次の条件を満たすデータ ソースのみを選択します。  
  
    -   データ ソースは、データ更新時に指定の場所に存在し、使用可能になっている必要があります。 元のデータ ソースが、ブックを作成したユーザーのローカル ディスク ドライブにある場合は、そのデータ ソースをデータ更新操作から除外するか、何らかの方法でそのデータ ソースをネットワーク接続経由でアクセス可能な場所にパブリッシュする必要があります。 データ ソースをネットワーク上の場所に移動する場合は、 [!INCLUDE[ssGeminiClient](../includes/ssgeminiclient-md.md)] でブックを開いて、データ ソースの接続情報を更新します。 この操作は、PowerPivot ブックに格納された接続情報を再確立するために必要です。  
  
    -   データ ソースへのアクセスには、PowerPivot ブックに埋め込まれている資格情報、またはスケジュールに指定されている資格情報を使用する必要があります。 埋め込みの資格情報は、PowerPivot for Excel を使用してデータをインポートするときに、PowerPivot ブックに格納されます。 通常、埋め込みの資格情報は SSPI=IntegratedSecurity または SSPI=TrustedConnection です。これは、現在のユーザーの資格情報を使用して、データ ソースに接続することを表します。 データ更新スケジュールの資格情報をオーバーライドする場合は、定義済みの保存された資格情報を指定できます。 詳細については、「[PowerPivot データ更新用の保存された資格情報の構成 &#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)」を参照してください。  
  
    -   データ更新は、指定したすべてのデータ ソースに対して成功する必要があります。 成功しなかった場合、更新されたデータは破棄され、最後に保存したバージョンのブックが維持されます。 確実でないデータ ソースは除外してください。  
  
    -   ブック内の他のデータを無効にするようなデータ更新を行わないでください。 データのサブセットを更新するときは、時期の異なる静的データと新しいデータを集計してもブックが引き続き有効になるかどうかの判断が重要になります。 データの依存関係を理解し、データ更新がブックにとって適切かどうかを確認するのは、ブック作成者の責任です。  
  
10. 必要に応じて、特定のデータ ソースに個別のスケジュールを定義できます。 これは、元のデータ ソースもスケジュールに基づいて更新される場合に便利です。 たとえば、毎週月曜日の 2 時に更新されるデータ マートのデータを PowerPivot データ ソースで使用している場合、そのデータ マートに対して、更新されたデータを毎週月曜日の 4 時に取得するインライン スケジュールを定義できます。  
  
11. **[OK]** をクリックして、スケジュールを保存します。  
  
##  <a name="drverify"></a> データ更新を確認します。  
 データ更新を確認する最善の方法は、データ更新をすぐに実行し、履歴ページを確認して、データ更新が正常に完了したかどうかを確認することです。 スケジュールの **[さらに、できるだけ早く更新を行います]** チェック ボックスをオンにすると、データ更新が動作することを確認できます。  
  
 データ更新操作の現在と過去のレコードは、ブックの [データ更新の履歴] ページで表示できます。 このページは、ブックにデータ更新がスケジュールされている場合にだけ表示されます。 データ更新スケジュールがない場合は、代わりにスケジュール定義ページが表示されます。  
  
 データ更新の履歴を表示するには、投稿権限以上の権限が必要です。  
  
1.  SharePoint サイトで、PowerPivot ブックを含んだライブラリを開きます。  
  
     SharePoint ライブラリ内のどのブックに PowerPivot データが含まれているかを、外観で判別することはできません。 更新可能な PowerPivot データが含まれているブックを、あらかじめ調べておく必要があります。  
  
2.  ドキュメントを選択し、右側にある下矢印をクリックします。  
  
3.  **[PowerPivot データ更新の管理]** をクリックします。  
  
 履歴ページが開き、現在の Excel ブック内の PowerPivot データに関するすべての更新操作の完全な記録が表示されます。最新のデータ更新操作の状態も表示されます。  
  
 場合によっては、表示される実際の処理時間が、指定した時間とは異なることもあります。 これは、サーバーの処理負荷が高い場合に起こります。 負荷が高い場合、 [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] サービス インスタンスは十分なシステム リソースが空くまで待機してから、データ更新を開始します。  
  
 更新操作の終了時に、ブックがチェックインされている必要があります。 このときに、更新されたデータがブックに保存されます。 ファイルがチェックアウトされている場合、データ更新は、次回の予定時刻までスキップされます。  
  
 予期しない状態メッセージ (更新操作の失敗や取り消しなど) が表示される場合は、問題の調査のため、権限やサーバーが使用できるかどうかを確認します。  
  
 データ更新の問題の解決方法については、TechNet wiki の PowerPivot データ更新のトラブルシューティングのページをご確認ください。 詳細については、「 [PowerPivot データ更新のトラブルシューティング](https://go.microsoft.com/fwlink/?LinkId=251594)」をご覧ください。  
  
> [!NOTE]  
>  SharePoint 管理者は、サーバーの全体管理で PowerPivot 管理ダッシュボードにある統合データ更新レポートを表示して、データ更新の問題をトラブルシューティングできます。 詳細については、「 [PowerPivot Management Dashboard and Usage Data](power-pivot-sharepoint/power-pivot-management-dashboard-and-usage-data.md)」をご参照ください。  
  
## <a name="see-also"></a>参照  
 [SharePoint 2010 で PowerPivot データ更新](powerpivot-data-refresh-with-sharepoint-2010.md)   
 [データ更新履歴表示&#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)   
 [PowerPivot データ更新用の保存された資格情報の構成&#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)  
  
  
