---
title: モデル構造に追加 (データ マイニング Excel 用アドイン) |Microsoft Docs
ms.custom: ''
ms.date: 12/29/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- mining models, creating
ms.assetid: 8efd5bf4-4e6a-4ee8-971a-6efaed5f3b76
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: ce68071f27897e181063299e561dfaa7d9f8aab7
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "66062879"
---
# <a name="add-model-to-structure-data-mining-add-ins-for-excel"></a>構造へのモデルの追加 (Excel 用データ マイニング アドイン)
  ![モデル構造 ボタンを追加](media/dmc-addmodel.gif "モデル構造 ボタンの追加")  
  
 クリックすると**構造への追加モデル**、既存のマイニング構造で使用する新しいマイニング モデルを作成するのに役立つウィザードが起動します。 このオプションは、同じデータに基づくモデルを比較したり、カスタマイズしたモデルを作成したりできるため便利です。  
  
 使用して、Analysis Services のインスタンスに必要なデータが含まれない場合、 [Create Mining Structure &#40;SQL Server データ マイニング アドイン&#41;](create-mining-structure-sql-server-data-mining-add-ins.md)マイニング構造を設定するウィザード。 または、モデリング ウィザードのいずれかを起動してから、ウィザードで作成した構造に新しいモデルを追加することもできます。  
  
 ウィザードでサポートされていないアルゴリズムを使用して高度なモデルを作成するマイニング構造を作成しを使用してモデルを追加し、**データ マイニング詳細クエリ エディター**します。  
  
## <a name="add-a-new-model-to-an-existing-structure"></a>既存の構造に新しいモデルを追加する  
  
1.  **データ マイニング**リボンで、下の矢印をクリックします。 **詳細設定**、し、**構造にモデルの追加**します。  
  
2.  **構造の選択** ダイアログ ボックスで、をクリックし、使用するデータが含まれている構造を選択**次**します。  
  
     **ヒント**:不明などのマイニング構造には、必要なデータ使用にはが含まれています場合、**ドキュメント モデル**ウィザード列とデータに関する基本的な統計情報を表示します。  
  
     マイニング構造が見つからない場合を使用している現在の接続を確認します。 別のサーバーへの接続を開く必要がある場合もあります。  
  
3.  **マイニング アルゴリズムの選択** ダイアログ ボックスで、新しいマイニング モデルで使用するマイニング アルゴリズムを選択します。  
  
     ダイアログ ボックスがウィザードよりも、はるかに多くのオプションを提供することを確認します。 データに互換性がある場合は、[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] サーバーでサポートされているアルゴリズムを使用してモデルを作成できます。  
  
4.  クリックすることもお勧め、**パラメーター**ボタンをクリックする、**アルゴリズム パラメーター**  ダイアログ ボックスし、アルゴリズム パラメーターをカスタマイズします。 このオプションは、カスタム マイニング モデルを作成する最も簡単な方法です。  
  
5.  **[次へ]** をクリックします。  
  
6.  **列の選択** ダイアログ ボックスでは、列の一覧を確認し、必要に応じて、これらの値のいずれかに、列の使用法を変更します。  
  
    -   **入力**します。 列に含まれる変数が結果に影響する可能性があり、モデルへの入力として使用されます。  
  
    -   **入力し、予測**します。 データは入力として使用され、これらの値が予測されます。  
  
    -   **予測のみ**します。 データはモデルの入力として使用されません。  
  
    -   **[キー]** 各モデルには、少なくとも 1 つのキーが必要です。 モデルの種類によってもあります特殊なキーの追加をするためのオプションなど、 **[sequencekey]** または**TimeKey**します。  
  
    -   **使用しない**します。 データが構造内に存在してもモデルには使用されません。  
  
7.  参照 をクリックして **(...)** ボタンをクリックする、**列モデル フラグの設定** ダイアログ ボックス。  
  
     各データ列の使用法がモデルに適切かどうかを確認します。 これは、モデルを処理するときに発生するエラーを回避するための重要な手順です。  
  
     たとえば、デシジョン ツリー モデルに対して作成された構造を再利用して、Naïve Bayes アルゴリズムをこれに適用する場合、データ型が `Numeric` でコンテンツの種類が `Continuous` の列はビン分割するか、離散変数に変更する必要があります。  
  
     選択してバイパスできる場合は、構造内の列は、新しいアルゴリズムに適用されない、**使用しないでください**します。  
  
8.  **列モデル フラグの設定** ダイアログ ボックス、レビュー、または存在する場合は、モデリング フラグを設定します。  
  
     モデリング フラグを使用すると、特に null 値の処理方法を制御できます。 詳細については、「[モデリング フラグ &#40;データ マイニング&#41;](data-mining/modeling-flags-data-mining.md)」を参照してください。  
  
     クリックして**OK**完了ダイアログ ボックスを閉じます。  
  
9. **完了** ダイアログ ボックスに、新しいマイニング モデルの説明と名前を入力します。  
  
     作成したモデルの種類に応じて、次のオプションも表示される場合があります。  
  
    -   作成後に完成したマイニング モデルを参照します。  
  
    -   モデルからソース データへのドリルスルーを使用します。  
  
         詳細については、次を参照してください。[マイニング モデルでのドリルスルー](data-mining/drillthrough-on-mining-models.md)します。  
  
10. クリックして**完了**変更を保存します。 これにより、新しいモデルはサーバーに配置され処理されます。  
  
### <a name="related-options"></a>関連するオプション  
  
|オプション|コメント|  
|------------|--------------|  
|**構造またはモデルの選択** ダイアログ ボックス|新しいモデルの作成の基礎として使用する既存のマイニング構造を選択します。  選択する構造は、現在の接続にある必要があります。 そうでない場合は、を使用して接続を変更、[ソース データへの接続&#40;Excel 用データ マイニング クライアント&#41;](connect-to-source-data-data-mining-client-for-excel.md)ツール。|  
|**マイニング アルゴリズムの選択** ダイアログ ボックス|接続先のサーバーに応じて、データ マイニング アルゴリズムの一覧は異なります。 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] の Standard Edition と Enterprise Edition には異なるアルゴリズムが用意されています。 管理者が、カスタム アルゴリズムを追加している場合もあります。<br /><br /> 任意のアルゴリズムが見つからない場合は、インスタンスに接続されていることを確認[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)]します。|  
|**アルゴリズム パラメーター**  ダイアログ ボックス|これらの設定では、分析メソッドに固有のパラメーターを使用して各アルゴリズムをカスタマイズできます。 また、モデルの結果を複数のトレーニング パス間で再現できるようにシードを設定することもできます。<br /><br /> 詳細については、次を参照してください。[アルゴリズム パラメーター &#40;SQL Server データ マイニング アドイン&#41;](algorithm-parameters-sql-server-data-mining-add-ins.md)します。|  
|**列モデル フラグの設定** ダイアログ ボックス|モデリング フラグを使用すると、欠落しているデータの処理方法を指定してモデルを改善できます。 詳細については、「[モデリング フラグ &#40;データ マイニング&#41;](data-mining/modeling-flags-data-mining.md)」を参照してください。|  
  
###  <a name="Bkmk_mdlcolumn"></a> 列の使用法の設定  
 新しいモデルを既存のマイニング構造に追加する場合は、マイニング構造の各データ列をどのようにモデルで使用するかを指定する必要があります。 このウィザードのオプションは、マイニング構造のオプションに比べて非常に詳細をする可能性がありますがわかります。 なぜでしょうか。  
  
 これは、ウィザードを使用してモデルと構造を一緒に作成すると、アルゴリズムでデータが使用される方法を制御する多くのオプションが自動的に設定されるためです。 ただし、既存のモデルに新しいモデルを追加する場合は、これらのオプションを手動で確認し、データを分析に使用するかどうか、データ型が正しいかどうかなどを指定する必要があります。  
  
 新しいアルゴリズムを既存のデータに適用すると、エラー メッセージが表示されることがありますが、これらは一般的に、モデルを処理するために必要な修正に関する詳細情報を提供するメッセージです。 一般的な問題を次に示します。  
  
-   モデルがその構造に含まれているデータ型とは異なるデータ型を必要としている。  
  
     アルゴリズムには、数字のみを使用できるものや、テキストのみを使用できるものがあります。 データが新しいモデルに対して無効な型である場合、モデルで処理できるように構造を変更する必要があります。  
  
-   マイニング構造に予測可能な属性が含まれていない。  
  
     クラスター モデルは予測可能な値を指定せずに作成できますが、その他のモデルは通常、予測に使用する単一列を指定する必要があります。  
  
-   データの構成は、選択したアルゴリズムと互換性がありません。  
  
     分析の種類によっては、一意の規則に従って慎重に構造化されたデータが必要です。 例として、予測モデル、アソシエーション モデルなどがあります。 たとえば、カスタマイズを行って同じ種類の新しいモデルを簡単に追加できますが、データが他のアルゴリズムでは動作しない場合があります。  
  
### <a name="requirements"></a>必要条件  
 データ マイニング モデルを作成するには、[!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] のインスタンスに接続する必要があります。 作成または接続を変更する方法の詳細については、次を参照してください。[ソース データへの接続&#40;Excel 用データ マイニング クライアント&#41;](connect-to-source-data-data-mining-client-for-excel.md)します。  
  
 必要なデータ マイニング構造が表示されない場合、その構造が別のインスタンスまたは別の [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] データベースに保存されている可能性があります。 別のデータ マイニング接続に変更する方法については、次を参照してください。[データ マイニング サーバーに接続する](connect-to-a-data-mining-server.md)します。  
  
## <a name="see-also"></a>参照  
 [データ マイニング モデルの作成](creating-a-data-mining-model.md)   
