---
title: 正常性ルールのリファレンス (PowerPivot for SharePoint) |Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 47ae04ce-7b9d-49c2-8dbc-bafcb73d4603
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: bae8efeda0a82873498af93b0b79061f6135fd0c
ms.sourcegitcommit: f912c101d2939084c4ea2e9881eb98e1afa29dad
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/23/2019
ms.locfileid: "72797599"
---
# <a name="health-rules-reference-powerpivot-for-sharepoint"></a>正常性ルールのリファレンス (PowerPivot for SharePoint)
  ここでは、PowerPivot for SharePoint のインストールによって追加される SharePoint の正常性ルールついて説明します。 正常性ルールは、 [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] サービス アプリケーションまたはそれに関連する [!INCLUDE[ssASnoversion](../../includes/ssasnoversion-md.md)] インスタンスのサーバー状態、可用性、または構成に関する問題をレポートするために使用されます。  
  
 次の表に示すルールは、SharePoint サーバーの全体管理の [正常性アナライザー ルールの定義] ページに表示される順に示されています。 構成可能なルールでは、ルールがトリガーされるしきい値を変更できます。 詳細については、「 [PowerPivot の正常性ルール-構成](configure-power-pivot-health-rules.md)」を参照してください。 "自動修復" は、問題のレポートのページからクリックして、問題を解決できる修復機能が組み込まれていることを示しています。  
  
||  
|-|  
|**[!INCLUDE[applies](../../includes/applies-md.md)]**  SharePoint 2013 &#124; SharePoint 2010|  
  
 **注:** [!INCLUDE[ssGeminiShort](../../includes/ssgeminishort-md.md)] によってインストールされる正常性ルール セットは、SharePoint のバージョンに応じて異なります。 次の表の "バージョン" 列を参照してください。または、次の Windows PowerShell コマンドを実行して、インストールされている規則を確認することもできます。  
  
```powershell
Get-SPHealthAnalysisRule | Select name, enabled, summary | Where {$_.summary -like "*power*"}  | Format-Table -Property * -AutoSize | Out-Default  
```  
  
|Rule|構成可能|自動修復|[バージョンのオプション]|Description|  
|----------|------------------|-----------------|-------------|-----------------|  
|[PowerPivot: Analysis Services OLE DB プロバイダーはこのコンピューターにインストールされていません。]|[いいえ]|[いいえ]|SharePoint 2010|Analysis Services OLE DB プロバイダーがサーバーにインストールされていないか、バージョンが正しくありません。 このルールは、SharePoint ファーム内の PowerPivot for SharePoint がインストールされていないアプリケーション サーバー上に Excel Services のインスタンスが存在する場合に表示されます。 Excel Services が PowerPivot データに接続するために使用する Analysis Services OLE DB プロバイダーがインストールされていないことを警告しています。 この問題を解決するには、Analysis Services OLE DB プロバイダーがインストールされていない各 Excel Services サーバーに OLE DB プロバイダーをインストールします。 Analysis Services OLE DB プロバイダーは、Microsoft ダウンロード センターからダウンロードしてインストールできます。 詳細については、「 [SharePoint サーバーへの Analysis Services OLE DB プロバイダーのインストール](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md)」を参照してください。|  
|[PowerPivot: MSOLAP プロバイダーの SQL Server 2008 R2 バージョンをこのコンピューターにインストールしましたが、Microsoft.AnalysisServices.ChannelTransport.dll のレジストリ設定が有効な設定になっていません。]|[いいえ]|[ユーザー アカウント制御]|SharePoint 2010|これは、サーバー構成の問題です。 ほとんどの場合、ChannelTransport.dll がグローバル アセンブリに登録されていないことが原因です。 PowerPivot for SharePoint がインストールされている各サーバーに ChannelTransport.dll を登録するには、このルールの自動修復を実行します。 また、regasm.exe を手動で実行して、ファイルを登録することもできます。 SharePoint Timer Service がローカル管理者として実行されていない場合は、手動で登録する必要があります。 レジストリ設定の更新に失敗すると、Excel Services と PowerPivot System サービス間のサーバー通信が低速になります。セキュリティ構成によっては、接続エラーが発生する場合があります。|  
|[PowerPivot: PowerPivot サービス アプリケーションには、この操作を実行する権限が与えられていません。]|[いいえ]|[いいえ]|SharePoint 2010|このルールでは、PowerPivot サービス アプリケーションの ID が PowerPivot サーバー アプリケーション データベースのデータベース所有者であり、ローカルの SQL Server Analysis Services インスタンスに対する管理権限を持っているかどうかを確認します。 これらの権限は、インストール中および配置中に自動的に付与されますが、この手順が正常に完了しなかった場合は、この正常性ルールがトリガーされます。|  
|[PowerPivot: PowerPivot サービス アプリケーションの ID をローカルの Administrators グループのメンバーにすることはできません。]|[いいえ]|[いいえ]|SharePoint 2010|これは、配置全体のセキュリティを強化するベスト プラクティスです。 ローカルの管理者グループに属するアカウントで実行するように PowerPivot サービス アプリケーションを構成した場合は、サービス アカウントをそのグループに属していないアカウントに変更する必要があります。 各サービス専用の最小特権アカウントを使用することをお勧めします。 そうすることで、サービスが分離され、ログインの監査が簡単になります。 サービスアカウントの変更の詳細については、「 [PowerPivot サービスアカウントの構成](configure-power-pivot-service-accounts.md)」を参照してください。|  
|[PowerPivot: Analysis Services インスタンスは表形式モードで実行しますが、このモードを指定する構成設定が無効になっています。]|[いいえ]|[いいえ]|SharePoint 2010|このルールでは、PowerPivot for SharePoint インストールの SQL Server Analysis Services インスタンスで `DeploymentMode` サーバー プロパティが 1 に設定されているかどうかを確認します。 このプロパティが別の値に設定されている場合、またはルール チェッカーを実行する SharePoint Timer Service にファイルを開く権限がない場合、このルールは失敗します。 配置モード プロパティの詳細については、「 [Analysis Services インスタンスのサーバー モードの決定](../instances/determine-the-server-mode-of-an-analysis-services-instance.md)」を参照してください。|  
|[PowerPivot: PowerPivot データ更新タイマー ジョブが無効になっています。]|[いいえ]|[いいえ]|SharePoint 2013<br /><br /> SharePoint 2010|タイマー ジョブが有効になっていることを確認するには、タイマー ジョブの設定を確認します。 PowerPivot のデータ更新機能を使用していない場合は、このルールを無視できます。 詳細については、「 [SharePoint 2010 での PowerPivot データ更新](../powerpivot-data-refresh-with-sharepoint-2010.md)」を参照してください。|  
|[PowerPivot: SQL Server 構成マネージャーで管理されている SQL Server Analysis Services (PowerPivot) サービス アカウント情報が、SharePoint サーバーの全体管理で管理されているアカウント情報と異なります。]|[いいえ]|[いいえ]|SharePoint 2010|このルールでは、SQL Server 構成マネージャーのサービス アカウント情報が、同じ Analysis Services インスタンスのサーバーの全体管理における管理アカウント情報と同一かどうかを確認します。 アカウントが異なる場合は、SQL Server 構成マネージャーのサービス アカウント情報を変更して、サーバーの全体管理で指定されたアカウントに戻すことができるように、"問題と解決策" レポートにエンティティが追加されます。 SQL Server 構成マネージャーは、PowerPivot for SharePoint インストールのサービス アカウントのユーザー名またはパスワードを変更するためのツールとして使用できません。 サーバーの全体管理を使用すると、SharePoint の管理アカウント機能を使用できます。 さらに、ファームに PowerPivot for SharePoint サーバーが複数ある場合、サービス アカウントの設定に一貫性がないと、サービス情報の正しくないサーバーにおける処理操作とクエリ操作が中断される可能性があります。<br /><br /> 1 つのサーバーでこのルールがトリガーされた場合、PowerPivot ブックは一時的に機能しますが、問題をできるだけ早く解決することをお勧めします。 データベースとファイル システムの権限は、サーバーの全体管理で指定されたアカウント情報を使用して更新されます。|  
|[PowerPivot: 配置済みのファーム ソリューションが最新ではありません。]|[いいえ]|[ユーザー アカウント制御]|SharePoint 2010|PowerPivot for SharePoint のインストールでは、ファーム レベルのソリューションと Web アプリケーション レベルのソリューションを使用して、その機能をインストールします。 このルールは、ファーム ソリューションがバージョン、サーバー、または Web ソリューションに対して最新でないことを示します。 ほとんどの場合、これはサーバーの配置の問題です。 この問題を解決するには、SQL Server セットアップを実行して、ファーム内のいずれかの PowerPivot for SharePoint のインストールを修復することを検討してください。 PowerPivot for SharePoint のインストールにおけるソリューションの詳細については、「 [SharePoint への PowerPivot ソリューションの配置](deploy-power-pivot-solutions-to-sharepoint.md)」を参照してください。|  
|[PowerPivot: 全体的な CPU 使用率が高すぎます。]|[ユーザー アカウント制御]|[いいえ]|SharePoint 2010|このルールでは、システム レベルの CPU 消費量がレポートされます。 CPU 全体の使用率は、ファーム内の複数の PowerPivot for SharePoint サーバー間での正常性ベースの負荷分散のために、PowerPivot System サービスサーバーの正常性の尺度として使用されるため、監視されます。 ファームに別のアプリケーション サーバーを追加し、CPU を集中的に使用するアプリケーションをそのサーバーに移動することを検討してください。|  
|[PowerPivot: Analysis Services には要求された操作を実行するのに十分な CPU リソースがありません。]|[ユーザー アカウント制御]|[いいえ]|SharePoint 2010|Analysis Services プロセス (msmdsrv.exe) に使用できる CPU リソースの量が、このサーバーのアクティビティ レベルに対して不足しています。 ファームに別の PowerPivot for SharePoint サーバーを追加することを検討してください。 詳細については、「[配置のチェックリスト: SharePoint 2010 ファームへの PowerPivot サーバーの追加によるスケールアウト](../../sql-server/install/deployment-checklist-scale-out-adding-powerpivot-servers-sharepoint-2010-farm.md)」を参照してください。|  
|[PowerPivot: Analysis Services には要求された操作を実行するのに十分なメモリがありません。]|[いいえ]|[いいえ]|SharePoint 2010|このルールは、Analysis Services の使用可能なメモリが 5% しか残っていない場合にトリガーされます。 SharePoint アプリケーション サーバー上の SQL Server Analysis Services インスタンスには、常に未使用のメモリをいくらか確保しておく必要があります。 サーバーのほとんどの操作はメモリ バインドされているため、サーバーは上限まで実行されない場合に最適に実行されます。<br /><br /> 既定では、使用可能なメモリが 5% にまで下がると、メモリ不足の警告が発生します。 Analysis Services インスタンスの設定を調整して、この値を増減させることができます。 詳細については、「 [PowerPivot の正常性ルール-構成](configure-power-pivot-health-rules.md)」を参照してください。<br /><br /> 5% の未使用メモリは、Analysis Services に割り当てられているメモリに対する割合として計算されます。 たとえば、メモリの合計が 200 GB で、Analysis Services にその 80% (つまり 160 GB) が割り当てられている場合、5% の未使用メモリは 160 GB の 5% (つまり 8 GB) です。|  
|[PowerPivot: 大量の接続は、現在の負荷を処理するにはより多くのサーバーを配置する必要があることを示しています。]|[ユーザー アカウント制御]|[いいえ]|SharePoint 2010|既定では、この正常性ルールは、異なるユーザー接続の数が 100 を超えている場合にトリガーされます。 この既定値は恣意的なものです (サーバーのハードウェアの仕様やユーザーの利用状況に基づいていません)。そのため、使用している環境のサーバー容量およびユーザーの利用状況に応じて、値を増減できます。 詳細については、「 [PowerPivot の正常性ルール-構成](configure-power-pivot-health-rules.md)」を参照してください。|  
|[PowerPivot: 接続に対する読み込みイベントの比率が高すぎます。]|[ユーザー アカウント制御]|[いいえ]|SharePoint 2013<br /><br /> SharePoint 2010|既定では、この正常性ルールは、接続イベントに対する読み込みイベントの比率がデータ収集期間全体 (既定では 4 時間) の 50% を超えている場合にトリガーされます。 比率が高い場合は、一意のブックへの接続数が非常に多いか、キャッシュの削減設定が厳しすぎることを示しています (厳しすぎる場合、ブックはすぐにアンロードされ、システムから削除されますが、そのデータに対する要求はアクティブな状態のままになります)。 偽陽性をカウントしないようにするには、4 時間あたりの接続数が 20 以上の場合に比率を計算する必要があります。 この正常性ルールは、別の比率に基づいて構成できます。 詳細については、「 [PowerPivot の正常性ルール-構成](configure-power-pivot-health-rules.md)」を参照してください。 キャッシュの構成の詳細については、「 [Configure Disk &#40;Space&#41;Usage PowerPivot for SharePoint](configure-disk-space-usage-power-pivot-for-sharepoint.md)」を参照してください。|  
|[PowerPivot: Logs ディレクトリでプログラムのクラッシュを示す 1 つ以上のミニダンプ ファイルが見つかりました。]|[いいえ]|[いいえ]|SharePoint 2013<br /><br /> SharePoint 2010|プログラムのクラッシュ時に、クラッシュする直前の PowerPivot サービス アプリケーションの状態に関する情報を記録したミニダンプ ファイルが生成されます。 この情報はマイクロソフトに送信したり、トラブルシューティングに使用したりできます。 このルールは、.dmp ファイルがサーバーで検出された場合にトリガーされます。 このルールでは、ファイルへのリンクが提供されます。このリンクは、PowerPivot for SharePoint インスタンスの \OLAP\Log フォルダーにあります。 テキスト エディターを使用して、ファイルの内容を表示することはできません。 ミニダンプ ファイルを表示するには、デバッグ ツールを別途ダウンロードしてインストールする必要があります。 詳細については、「 [Windows 用デバッグ ツールのダウンロードとインストール](/windows-hardware/drivers/debugger/)」を参照してください。|  
|[PowerPivot: PowerPivot データがキャッシュされるドライブのディスク領域が不足しています。]|[ユーザー アカウント制御]|[いいえ]|SharePoint 2010|既定では、バックアップ フォルダーが置かれているディスク ドライブ上のディスク領域が 5% 未満になると、この正常性ルールがトリガーされます。 この割合の設定の詳細については、「 [PowerPivot の正常性ルール-構成](configure-power-pivot-health-rules.md)」を参照してください。 ディスク使用量の詳細については、「 [Configure &#40;disk&#41;Space usage PowerPivot for SharePoint](configure-disk-space-usage-power-pivot-for-sharepoint.md)」を参照してください。|  
|[PowerPivot: 使用状況データが必要な頻度で更新されていません。]|[ユーザー アカウント制御]|[いいえ]|SharePoint 2013<br /><br /> SharePoint 2010|PowerPivot for SharePoint では、組み込みの使用状況データ収集システムを使用して、接続、データ更新、およびクエリ応答時間に関するメトリックを収集します。 この使用状況データを PowerPivot サービス アプリケーション データベースに格納し、PowerPivot 管理ダッシュボードのレポートにデータを提供する PowerPivot ブック (PowerPivot Management Data.xlsx) を更新します。 このルールは、使用状況データが十分な頻度で PowerPivot Management Data.xlsx ファイルに移動されていないことを示します。 このルールでは、ファイルが更新されている証拠として .xlsx ファイルのタイムスタンプを使用します。 データの正確性を損なう他の問題が使用状況データ収集システムにある場合、その問題はこのルールでは検出されません。 このエラーのトラブルシューティングを実行するには、タイマー ジョブが実行されていることを確認します。 使用状況データ収集の詳細については、「 [PowerPivot for SharePoint の&#40;使用状況データ収集の構成](configure-usage-data-collection-for-power-pivot-for-sharepoint.md)」を参照してください。|  
|PowerPivot: Midtier process アカウントは、関連付けられているすべての Spwebapplication に対して ' 完全読み取り ' アクセス許可を持っている必要があります。|[いいえ]|[ユーザー アカウント制御]|SharePoint 2013<br /><br /> SharePoint 2010|ドキュメントに対する表示のみの権限を持つユーザーに代わって SharePoint コンテンツデータベースにアクセスするには、PowerPivot サービスアプリケーションの id に**フル読み取り**権限が必要です。 PowerPivot サービスアプリケーションの id として使用されているアカウントを確認するには、サーバーの全体管理で **[サービスアカウントの構成]** ページを開きます。 通常、サービス アプリケーションは、 **SharePoint Web サービスのシステム** のサービス アプリケーション プールまたは専用のアプリケーション プールで実行されます。 この規則には [自動修復] オプションがありますが、次の手順でアクセス許可を手動で付与すると、より良い結果が得られます。<br /><br /> 1) サーバーの全体管理で、 **[Web アプリケーションの管理]** をクリックします。<br /><br /> 2) Web サイトを選択し、 **[ユーザー ポリシー]** をクリックします。<br /><br /> 3) **[ユーザーの追加]** をクリックします。<br /><br /> 4) [(すべての領域)] を選択し、 **[次へ]** をクリックします。<br /><br /> 5) ユーザー で、PowerPivot サービスアプリケーションの id を入力し、**フル読み取り** チェックボックスをオンにします。 **[完了]** をクリックします。<br /><br /> 6) 修復を確認します。 [監視] で、 **[ルール定義の確認]** をクリックします。 検索し、PowerPivot ルールを開きます。 **[今すぐ実行]** をクリックします。 **[問題とソリューションの確認]** に戻り、ルールが表示されないことを確認します。|  
|[PowerPivot: セカンダリ ログオン サービス (seclogon) は無効になっています。]|[いいえ]|[いいえ]|SharePoint 2013<br /><br /> SharePoint 2010|セカンダリ ログオン サービスは、PowerPivot ギャラリーの PowerPivot ブックのサムネイル画像を生成するために使用されます。 既定では、セカンダリ ログオン サービスは手動スタートアップに設定されています。 サービスが無効になっている場合、サムネイルの生成は失敗します。 さらに、ULS ログには次のエラーが記録されます。 "エラー1058には、Windows サービスの" セカンダリログオン "が無効になっていることを示す根本的な原因があります。<br /><br /> サービス構成を確認するには、サービス コンソール アプリケーションを使用してセカンダリ ログオンを検索し、 **[スタートアップの種類]** を **[手動]** に変更します。 サービスを有効にできない場合は、組織でこのサービスを無効にするグループ ポリシーが適用されている可能性があります。 管理者に連絡して、これに該当するかどうかを確認してください。<br /><br /> サービスを有効にすると、サムネイルまたはスナップショットの画像が経時的に更新されます。 必要に応じて、サービスを再起動し、特定のレポートのプロパティ ページを開いて再保存することで、強制的に更新することもできます。 詳細については、「 [PowerPivot ギャラリーの使用方法](https://go.microsoft.com/fwlink/?LinkId=246462)」を参照してください。|  
|[PowerPivot: サーバーの全体管理用に構成されているスタンドアロン WFE に ADOMD.NET がインストールされていません。]|[いいえ]|[いいえ]|SharePoint 2013<br /><br /> SharePoint 2010|ADOMD.NET は、Analysis Services データベースへの接続をサポートする Analysis Services クライアント ライブラリです。 PowerPivot for SharePoint の配置では、ADOMD.NET を使用して、サーバーの全体管理で PowerPivot 管理ダッシュボードの組み込みレポートにアクセスできます。 組み込みレポートは、実際には、埋め込み Analysis Services のデータが含まれた PowerPivot ブックです。 管理ダッシュボードでは、ADOMD.NET を使用して、ブックに含まれているデータを読み込むサーバーに接続要求を送信します。<br /><br /> スタンドアロン Web フロントエンド サーバーで実行されているサーバーの全体管理を含むトポロジで、管理ダッシュボードにこれらのレポートを表示する場合は、ADOMD.NET を手動でインストールする必要があります。 詳細については、「 [サーバーの全体管理を実行している Web フロントエンド サーバーに ADOMD.NET をインストールする方法](../../sql-server/install/install-adomd-net-on-web-front-end-servers-running-central-administration.md)」を参照してください。|  
