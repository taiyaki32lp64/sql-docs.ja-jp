---
title: ポーリング クエリ ダイアログ ボックス (Analysis Services - 多次元データ) の作成 |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
f1_keywords:
- sql12.asvs.createpollingquerydialog.f1
ms.assetid: 0f2902b5-796a-4eb0-be03-01514dc01b9a
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: faf96ad02005c0385ec56e1f8763da2e82f093ec
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "66086832"
---
# <a name="create-polling-query-dialog-box-analysis-services---multidimensional-data"></a>[ポーリング クエリの作成] ダイアログ ボックス (Analysis Services - 多次元データ)
  [!INCLUDE[ssBIDevStudioFull](../includes/ssbidevstudiofull-md.md)] の **[ストレージのオプション]** ダイアログ ボックスの **[通知]** タブから開く **[ポーリング クエリの作成]** ダイアログ ボックスを使用すると、ポーリング クエリを作成できます。 ポーリング クエリとは、 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] でテーブルやその他のリレーショナル オブジェクトに変更が加えられているかどうかの判断に使用できる値を返す、単一クエリです。 **[ポーリング クエリの作成]** ダイアログ ボックスを表示するには、 **[ストレージのオプション]** ダイアログ ボックスの **[通知]** タブで、 **[定期ポーリング]** オプションのグリッドの **[ポーリング クエリ]** 列にある参照ボタン ( **[...]** ) をクリックします。 **[ストレージのオプション]** ダイアログ ボックスの **[通知]** タブの詳細については、「[[通知] ([ストレージのオプション] ダイアログ ボックス) (Analysis Services - 多次元データ)](notifications-storage-options-dialog-analysis-services-multidimensional-data.md)」を参照してください。  
  
 ポーリング クエリによって返される値の種類は、クエリの対象となるテーブルに基づいたオブジェクトの、多次元 OLAP (MOLAP) キャッシュに設定されている更新の種類によって決まります。  
  
-   **[ストレージのオプション]** ダイアログ ボックスの **[通知]** タブで、 **[増分更新を有効にする]** が選択されていない場合、定期ポーリングの際に変更が検出されると、 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] によってオブジェクトの MOLAP キャッシュが完全更新されます。 使用されるポーリング クエリでは、前回のポーリング期間の後にテーブルにレコードが追加されたかどうかが判断されます。  
  
-   **[ストレージのオプション]** ダイアログ ボックスの **[通知]** タブで、 **[増分更新を有効にする]** が選択されている場合、定期ポーリングの際に変更が検出されると、 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] によってオブジェクトの MOLAP キャッシュが増分更新されます。 使用されるポーリング クエリでは、テーブルの最後のレコードが確認されます。  
  
 たとえば、 [!INCLUDE[ssAWDWsp](../includes/ssawdwsp-md.md)] の [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] サンプル データベースの Customer ディメンションの場合、次のポーリング クエリを使用して完全更新または増分更新を実行できます。  
  
|更新の種類|[通知]|  
|-----------------|-------------------|  
|完全更新|`SELECT`<br /><br /> `COUNT(*) AS TotalCount`<br /><br /> `FROM`<br /><br /> `[dbo].[DimCustomer]`|  
|増分更新|`SELECT`<br /><br /> `MAX([CustomerKey]) AS LastCustomerKey`<br /><br /> `FROM`<br /><br /> `[dbo].[DimCustomer]`|  
  
 定期ポーリング通知の完全更新と増分更新の詳細については、「[プロアクティブ キャッシュ (パーティション)](multidimensional-models-olap-logical-cube-objects/partitions-proactive-caching.md)」を参照してください。  
  
 入力するクエリは、基になるプロバイダーで有効なクエリ コマンドである必要があります。 クエリは検証用に基になるプロバイダーが指定された状態で用意され、返される列を識別できるようになっています。 ダイアログ ボックスでは、次の 2 つのビューを表示できます。  
  
-   Visual Database Tools (VDT) クエリ ビルダー  
  
     すべてのユーザー向けです。VDT クエリ ビルダーには、SQL クエリをビジュアルに構築しテストするためのユーザー インターフェイス ツールが備えられています。  
  
-   汎用クエリ ビルダー  
  
     上級ユーザー向けです。汎用クエリ ビルダーには、SQL クエリを構築しテストするための、より単純で直接的なユーザー インターフェイスが備えられています。  
  
## <a name="options"></a>および  
 **Data Source**  
 クエリのデータ ソースを指定します。  
  
 **クエリの定義**  
 クエリ定義では、選択したビューに応じて、クエリの定義とテストを行うためのツール バーとペインを表示します。  
  
 **[ツール バー]**  
 ツール バーは、データセットの管理、表示するペインの選択、さまざまなクエリ機能の制御に使用します。  
  
|値|説明|  
|-----------|-----------------|  
|**汎用クエリ ビルダーに切り替えます**|選択すると、汎用クエリ ビルダーのビューで使用されるオプションのみが表示されます。 次のオプションのみが表示されます。<br /><br /> **SQL ペイン**<br /><br /> **結果ペイン**<br /><br /> **[ツール バー]** 。 **[VDT クエリ ビルダーに切り替えます]** と **[実行]**<br /><br /> <br /><br /> 注:場合にのみ、このオプションは表示**VDT クエリ ビルダーに切り替えます**が選択されています。|  
|**VDT クエリ ビルダーに切り替えます**|選択すると、Visual Database Tools (VDT) クエリ ビルダーのビューで使用できるオプションがすべて表示されます。<br /><br /> 注:場合にのみ、このオプションは表示**汎用クエリ ビルダーに切り替えます**が選択されています。|  
|**[ダイアグラム ペインの表示/非表示]**|**[ダイアグラム]** ペインの表示と非表示を切り替えます。<br /><br /> 注:場合にのみ、このオプションは表示**VDT クエリ ビルダーに切り替えます**が選択されています。|  
|**[グリッド ペインの表示/非表示]**|**[グリッド]** ペインの表示と非表示を切り替えます。<br /><br /> 注:場合にのみ、このオプションは表示**VDT クエリ ビルダーに切り替えます**が選択されています。|  
|**[SQL ペインの表示/非表示]**|**[SQL]** ペインの表示と非表示を切り替えます。<br /><br /> 注:場合にのみ、このオプションは表示**VDT クエリ ビルダーに切り替えます**が選択されています。|  
|**結果ペインの表示/非表示**|**[結果]** ペインの表示と非表示を切り替えます。<br /><br /> 注:場合にのみ、このオプションは表示**VDT クエリ ビルダーに切り替えます**が選択されています。|  
|**[実行]**|クエリを実行します。 結果は **結果ペイン**に表示されます。|  
|**[SQL の確認]**|クエリの SQL ステートメントを確認します。<br /><br /> 注:場合にのみ、このオプションは表示**VDT クエリ ビルダーに切り替えます**が選択されています。|  
|**[昇順で並べ替え]**|**グリッド ペイン**で選択した列の出力行を昇順で並べ替えます。<br /><br /> 注:場合にのみ、このオプションは表示**VDT クエリ ビルダーに切り替えます**が選択されています。|  
|**[降順で並べ替え]**|**グリッド ペイン**で選択した列の出力行を降順で並べ替えます。<br /><br /> 注:場合にのみ、このオプションは表示**VDT クエリ ビルダーに切り替えます**が選択されています。|  
|**[フィルターの削除]**|**グリッド ペイン**で選択されている行に並べ替え条件を適用できる場合、その条件を削除します。<br /><br /> 注:場合にのみ、このオプションは表示**VDT クエリ ビルダーに切り替えます**が選択されています。|  
|**[Group By の使用]**|クエリにグループ化機能を追加します。<br /><br /> 注:場合にのみ、このオプションは表示**VDT クエリ ビルダーに切り替えます**が選択されています。|  
|**[テーブルの追加]**|**[テーブルの追加]** ダイアログ ボックスを表示し、クエリに新しいテーブルやビューを追加できます。 **[テーブルの追加]** ダイアログ ボックスの詳細については、「[[テーブルの追加] ダイアログ ボックス &#40;Analysis Services - 多次元データ&#41;](add-table-dialog-box-analysis-services-multidimensional-data.md)」を参照してください。<br /><br /> 注:場合にのみ、このオプションは表示**VDT クエリ ビルダーに切り替えます**が選択されています。|  
  
 **ダイアグラム ペイン**  
 クエリによって参照されるオブジェクトをダイアグラムとして表示します。 このダイアグラムには、クエリに含まれるテーブルと、その結合状態が表示されます。 テーブルの列の横にあるチェック ボックスをオンにすると、クエリの出力にその列が追加されます。オフにすると、削除されます。  
  
 テーブルをクエリに追加すると、ダイアログ ボックスでは、テーブルのキーを基にしてテーブル間の結合が行われます。 結合を追加するには、あるテーブルのフィールドを別のテーブルのフィールドにドラッグします。 結合を管理するには、結合を右クリックします。  
  
 **ダイアグラム ペイン** を右クリックすると、テーブルの追加や削除、すべてのテーブルの選択、ペインの表示と非表示の切り替えができます。  
  
> [!NOTE]  
>  **ダイアグラム ペイン**、 **グリッド ペイン**、および **SQL ペイン** の内容は同期しているため、1 つのペインで加えた変更は他の 2 つのペインにも反映されます。  
  
> [!IMPORTANT]  
>  クエリの種類の変更は、ダイアログ ボックスではサポートされません。  
  
 **グリッド ペイン**  
 クエリから参照されるオブジェクトをグリッドに表示します。 このペインを使用して、クエリに列を追加したり、列を削除したりできます。また、各列の設定の変更も変更できます。  
  
> [!NOTE]  
>  **ダイアグラム ペイン**、 **グリッド ペイン**、および **SQL ペイン** の内容は同期しているため、1 つのペインで加えた変更は他の 2 つのペインにも反映されます。  
  
 **SQL ペイン**  
 クエリを SQL ステートメントとして表示します。 入力することで、クエリの SQL ステートメントを変更できます。  
  
> [!NOTE]  
>  **ダイアグラム ペイン**、 **グリッド ペイン**、および **SQL ペイン** の内容は同期しているため、1 つのペインで加えた変更は他の 2 つのペインにも反映されます。  
  
 **結果ペイン**  
 **ツール バー** ペインで **[実行]** をクリックしたときに、クエリの結果を表示します。  
  
## <a name="see-also"></a>参照  
 [Analysis Services のデザイナーおよびダイアログ ボックス&#40;多次元データ&#41;](analysis-services-designers-and-dialog-boxes-multidimensional-data.md)  
  
  
