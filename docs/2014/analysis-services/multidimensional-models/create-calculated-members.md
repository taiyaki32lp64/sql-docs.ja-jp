---
title: 計算されるメンバーの作成 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- calculated members [Analysis Services]
- custom measures [Analysis Services]
- members [Analysis Services], calculated
- calculations [Analysis Services], calculated members
ms.assetid: 820e4b18-9c3a-4b12-a126-ca16d8364a00
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: f6b7ca79cefee4d19593d20320da13b4253a89ee
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "66076276"
---
# <a name="create-calculated-members"></a>計算されるメンバーの作成
  キューブ データ、算術演算子、数値、関数などを組み合わせることによって、「計算されるメンバー」と呼ばれる、カスタマイズされたメジャーまたはディメンション メンバーを作成できます。 たとえば、既存のドル メジャーに換算率を掛けて、ドルをユーロに換算する、Euro という計算されるメンバーを作成できます。 Euro は、別個の行または列に表示されます。  
  
 計算されるメンバーの定義は格納されますが、その値はメモリにしか存在しません。 上記の例では、Euro の値はエンド ユーザーに表示されますが、キューブ データとしては格納されません。  
  
 計算されるメンバーはキューブで作成します。 計算されるメンバーを作成するには、キューブ デザイナーの **[計算]** タブで、ツール バーの **[新しい計算されるメンバー]** アイコンをクリックします。 このコマンドでは、計算されるメンバーの次のオプションを指定するためのフォームが表示されます。  
  
 **名前**  
 計算されるメンバーの名前を選択します。 キューブを参照すると、この名前は、計算されるメンバーの値の列または行のヘッダーとして表示されます。  
  
 **親階層**  
 計算されるメンバーに含める親階層を選択します。 階層は、キューブ内の数値データ (メジャー) を分析目的で分割する基準となる、ディメンションの記述カテゴリです。 表形式のブラウザーでは、エンド ユーザーがキューブ内のデータを参照すると、階層に列ヘッダーと行ヘッダーが表示されます。 グラフィカルなブラウザーでは、別の種類の説明ラベルが表示されますが、機能は表形式のブラウザーの場合と同じです。計算されるメンバーでは、選択した親ディメンション内に新しいヘッダー (ラベル) が作成されます。  
  
 また、計算されるメンバーを、ディメンションではなくメジャーに含めることもできます。 この場合も、新しい列ヘッダーまたは行ヘッダーが表示されますが、ブラウザーではメジャーに付加されます。  
  
 **[親メンバー]**  
 計算されるメンバーを含める親メンバーを選択するには、 **[変更]** をクリックします。 親ディメンションとして 1 レベルの階層または MEASURES を選択した場合、このオプションは使用できません。  
  
 階層はレベルに分割され、そこにメンバーが含まれています。 各メンバーによってヘッダーが作成されます。 キューブ内のデータを参照中、選択したヘッダーから、これまで表示されていなかった下位のヘッダーにドリル ダウンできます。 計算されるメンバーのヘッダーは、選択した親メンバーの直下に属するレベルに追加されます。  
  
 **[式]**  
 計算されるメンバーの値を作成する式を指定します。 この式は、多次元式 (MDX) で記述できます。 式には、次の要素を含めることができます。  
  
-   ディメンション、レベル、メジャーなどのキューブのコンポーネントを表すデータ式  
  
-   算術演算子  
  
-   数値  
  
-   関数  
  
 **[計算ツール]** ペインの **[メタデータ]** タブからキューブのコンポーネントをドラッグまたはコピーして、簡単に式に追加できます。  
  
> [!IMPORTANT]  
>  計算されるメンバーが、別の計算されるメンバーの値式で使用される場合は、先に作成しておく必要があります。  
  
 書式設定文字列  
 計算されるメンバーに基づいたセル値の書式を指定します。 このプロパティは、メジャーの `Display Format` プロパティと同じ値を使用します。 表示形式の詳細については、「 [メジャーのプロパティの構成](configure-measure-properties.md)」を参照してください。  
  
 [表示]  
 計算されるメンバーをキューブ メタデータの取得時に表示するかどうかを決定します。 計算されるメンバーを表示しない場合でも、そのメンバーを MDX 式、ステートメント、およびスクリプトで使用できますが、クライアント ユーザー インターフェイスでは選択可能なオブジェクトとしては表示されません。  
  
 空以外の動作  
 MDX の NON EMPTY クエリの解決に使用するメジャー名を格納します。 このプロパティが空白の場合、メンバーが空であるかどうかを判断するために、計算されるメンバーを繰り返し評価する必要があります。 このプロパティに 1 つまたは複数のメジャーの名前が格納されている場合、指定されたすべてのメジャーが空であれば、計算されるメンバーも空として処理されます。 このプロパティは、Null 値以外のレコードだけを返す最適化ヒントとして Analysis Services に渡されます。 Null 値以外のレコードだけが返されるので、NON EMPTY 演算子や NonEmpty 関数を利用する MDX クエリや、セル値の計算を必要とする MDX クエリのパフォーマンスが向上します。 セルの計算で最良のパフォーマンスを得るには、できるだけ 1 つのメンバーのみを指定してください。  
  
 [色の式]  
 計算されるメンバーの値に基づいてセルの前景色と背景色を動的に設定する MDX 式を指定します。 クライアント アプリケーションでサポートされていない場合、このプロパティは無視されます。  
  
 [フォントの式]  
 計算されるメンバーの値に基づいてセルのフォント、フォント サイズ、およびフォントの属性を動的に設定する MDX 式を指定します。 クライアント アプリケーションでサポートされていない場合、このプロパティは無視されます。  
  
 キューブ コンポーネントは、 **[計算ツール]** ペインの **[メタデータ]** タブから計算式ペインの **[式]** ボックスにコピーまたはドラッグできます。 関数は、 **[計算ツール]** ペインの **[関数]** タブから計算式ペインの **[式]** ボックスにコピーまたはドラッグできます。  
  
## <a name="addressing-calculated-members"></a>計算されるメンバーのアドレス指定  
 **キューブ デザイナー** の **[計算]** タブで、計算されるメンバーを作成する場合は、そのメンバーを格納する親階層を指定します。 親階層では、次の規則に従って、計算されるメンバーのアドレス指定方法を決定します。  
  
-   計算されるメンバーがメジャー ディメンションで作成された場合、そのメンバーはそのディメンション内でアドレス指定可能です。  
  
## <a name="see-also"></a>参照  
 [多次元モデルの計算](calculations-in-multidimensional-models.md)  
  
  
