---
title: SharePoint 2010 で PowerPivot データ更新 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- unattended data refresh [Analysis Services with SharePoint]
- scheduled data refresh [Analysis Services with SharePoint]
- data refresh [Analysis Services with SharePoint]
ms.assetid: 01b54e6f-66e5-485c-acaa-3f9aa53119c9
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: 04dea4a32303e06d7f0e6c015eef38ba6d267a30
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "66070847"
---
# <a name="powerpivot-data-refresh-with-sharepoint-2010"></a>SharePoint 2010 での PowerPivot データ更新
  [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] のデータ更新は、外部データ ソースにクエリを実行して、コンテンツ ライブラリに保存されている Excel 2010 ブック内の埋め込み [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] データを更新する、スケジュールされたサーバー側の操作です。  
  
 データ更新は [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] for SharePoint に組み込まれている機能ですが、これを使用するには、SharePoint 2010 ファーム内で特定のサービスおよびタイマー ジョブを実行する必要があります。 データ更新を成功させるには、データ プロバイダーのインストールやデータベース権限の確認など、追加の管理手順が必要になることもよくあります。  
  
 **[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010  
  
> [!NOTE]  
>  [!INCLUDE[ssCurrent](../includes/sscurrent-md.md)] および SharePoint Server 2013 の Excel Services では、 [!INCLUDE[ssGemini](../includes/ssgemini-md.md)] データ モデルのデータ更新に新しいアーキテクチャを使用しています。 新しいアーキテクチャでは、PowerPivot データ モデルを読み込むための主要なコンポーネントとして Excel Services が使用されます。 以前に使用されていたデータ更新のアーキテクチャでは、データ モデルを読み込むために、SharePoint モードで PowerPivot System サービスおよび [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] を実行しているサーバーが使用されていました。 詳細については、次を参照してください。 [SharePoint 2013 で PowerPivot データ更新](power-pivot-sharepoint/power-pivot-data-refresh-with-sharepoint-2013.md)します。  
  
 **このトピックの内容:**  
  
 [ステップ 1: Secure Store Service を有効にして、マスター _ キーの生成](#bkmk_services)  
  
 [手順 2:サポートしない資格情報オプションをオフにします。](#bkmk_creds)  
  
 [ステップ 3:データ更新で使用される資格情報を格納する対象のアプリケーションを作成します。](#bkmk_stored)  
  
 [手順 4:スケーラブルなデータ更新のサーバーを構成します。](#bkmk_scale)  
  
 [手順 5:PowerPivot データのインポートに使用されるデータ プロバイダーをインストールします。](#bkmk_installdp)  
  
 [手順 6:スケジュールの作成および外部データ ソースにアクセスするアクセス許可を付与します。](#bkmk_accounts)  
  
 [手順 7:データ更新用のブックのアップグレードを有効にします。](#bkmk_upgradewrkbk)  
  
 [手順 8:データ更新の構成を確認します。](#bkmk_verify)  
  
 [データ更新の構成設定を変更します。](#bkmk_config)  
  
 [PowerPivot データ更新タイマー ジョブのスケジュールを変更します。](#configTimerJob)  
  
 [データ更新タイマー ジョブを無効にします。](#bkmk_disableDR)  
  
 サーバー環境と権限が構成されていることを確認したら、データ更新を使用できる状態になります。 SharePoint ユーザーがデータ更新を使用するには、データ更新の実行頻度を指定したスケジュールを PowerPivot ブックに対して作成します。 スケジュールの作成は一般的に、ファイルを SharePoint にパブリッシュしたユーザーである、ブックの所有者または作成者が行います。 このユーザーが、自分が所有するブックのデータ更新スケジュールを作成し、管理します。 詳細については、次を参照してください。[データ更新のスケジュール&#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md)します。  
  
##  <a name="bkmk_services"></a> ステップ 1:Secure Store Service の有効化とマスター キーの生成  
 PowerPivot のデータ更新は、Secure Store Service に依存して、データ更新ジョブの実行および保存された資格情報を使用する外部データ ソースへの接続に使用する資格情報を提供します。  
  
 [新しいサーバー] オプションを使用して PowerPivot for SharePoint をインストールした場合は、Secure Store Service が構成されています。 その他のすべてのインストール シナリオに対しては、サービス アプリケーションを作成して構成し、Secure Store Service 用のマスター暗号化キーを生成する必要があります。  
  
> [!NOTE]  
>  Secure Store Service を構成したり Secure Store Service の管理を別のユーザーに委任したりするには、ファームの管理者である必要があります。 サービス アプリケーションを有効にした後に設定を構成または変更するには、サービス アプリケーションの管理者である必要があります。  
  
1.  サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。  
  
2.  サービス アプリケーション リボンの作成、**新規**します。  
  
3.  選択**Secure Store Service**します。  
  
4.  **Secure Store アプリケーション作成**ページで、アプリケーションの名前を入力します。  
  
5.  **データベース**、このサービス アプリケーション データベースをホストする SQL Server インスタンスを指定します。 既定値は、ファーム構成データベースをホストする SQL Server データベース エンジン インスタンスです。  
  
6.  **データベース名**、サービス アプリケーション データベースの名前を入力します。 既定値は、secure_store_service_db _\<guid >。 既定の名前は、既定のサービス アプリケーション名に対応しています。 独自のサービス アプリケーション名を入力した場合は、サービス アプリケーションとデータベースを一緒に管理できるように、データベース名に対しても同様の命名規則を使用してください。  
  
7.  **[データベース認証]** の既定値は、"Windows 認証" です。 "SQL 認証" を選択する場合は、SharePoint 管理者ガイドを参照して、ファームでその認証の種類を使用する方法を確認してください。  
  
8.  アプリケーション プールでは、次のように選択します。**新しいアプリケーション プールを作成します。** 他のサーバー管理者がアプリケーション プールの使用方法を理解できるように、わかりやすい名前を指定します。  
  
9. アプリケーション プールのセキュリティ アカウントを選択します。 ドメイン ユーザー アカウントを使用するマネージド アカウントを指定します。  
  
10. 残りの既定値をそのまま使用し、 **ok をクリックします。** 作成したサービス アプリケーションが、他のマネージド サービスと共にファームのサービス アプリケーションの一覧に表示されます。  
  
11. 一覧で、Secure Store Service アプリケーションをクリックします。  
  
12. サービス アプリケーション リボン**管理**します。  
  
13. キーの管理 でクリックして**新しいキーの生成**します。  
  
14. パス フレーズを入力し、そのパス フレーズを確認します。 パス フレーズは、Secure Store 共有サービス アプリケーションを追加するために使用されます。  
  
15. **[OK]** をクリックします。  
  
 トラブルシューティングの目的に役立つ Store Service 操作の監査ログを使用可能にするには、事前にこの監査ログを有効にしておく必要があります。 詳細ログ記録を有効にする方法については、次を参照してください。 [Secure Store Service を構成する (SharePoint 2010)](https://go.microsoft.com/fwlink/p/?LinkID=223294)します。  
  
##  <a name="bkmk_creds"></a> ステップ 2:サポートしない資格情報オプションをオフにします。  
 PowerPivot データ更新には、データ更新スケジュールに 3 つの資格情報オプションが用意されています。 ブックの所有者がデータ更新をスケジュールする際には、これらのオプションの 1 つを選択して、データ更新ジョブの実行に使用するアカウントを指定します。 管理者は、スケジュールの所有者がどの資格情報オプションを使用できるかを決定できます。  
  
 データ更新が動作するためには、少なくとも 1 つのオプションが使用可能になっている必要があります。  
  
 ![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")  
  
 オプション 1、**データ更新アカウント、管理者が構成されている使用**スケジュールの定義 ページで、常に表示されますが、自動データ更新アカウントを構成する場合にのみ機能します。 アカウントを作成する方法の詳細については、次を参照してください。 [PowerPivot 自動データ更新アカウントを構成する&#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md)します。  
  
 オプション 2 の**次の windows 資格情報を使用して接続**、常に ページで、表示されますが、有効にした場合にのみ機能、**カスタムの Windows 資格情報を入力できるように**サービスのオプションアプリケーションの構成 ページ。 このオプションは既定で有効になりますが、これを使用するデメリットがメリットよりも大きい場合は無効にできます (下記を参照)。  
  
 オプション 3、 **Secure Store Service で保存された資格情報を使用して接続**、 ページで、常に表示されますが、スケジュール所有者が有効な対象アプリケーションを提供する場合にのみ機能します。 管理者は、あらかじめこれらの対象アプリケーションを作成してから、データ更新スケジュールを作成するユーザーにアプリケーション名を提供する必要があります。 データのターゲット アプリケーションを作成する方法の詳細については、更新操作を参照してください[格納されている資格情報の構成の PowerPivot データ更新&#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)します。  
  
 **資格情報オプション 2 では、[次の Windows ユーザー資格情報を使用して接続] を構成します。**  
  
 PowerPivot サービス アプリケーションには、スケジュール所有者がデータ更新ジョブの実行用の任意の Windows ユーザー名およびパスワードを入力できる資格情報オプションが含まれています。 これは、スケジュール定義ページの第 2 の資格情報オプションです。  
  
 ![SSAS_PPS_ScheduleDataRefreshCreds](media/ssas-pps-scheduledatarefreshcreds.gif "SSAS_PPS_ScheduleDataRefreshCreds")  
  
 この資格情報オプションは、既定で有効になります。 この資格情報オプションが有効になっている場合、PowerPivot System サービスでは Secure Store Service に対象アプリケーションが生成され、スケジュール所有者が入力したユーザー名とパスワードが保存されます。 この名前付け規則を使用して生成される対象アプリケーションが作成されます。Powerpivotdatarefresh _\<guid >。 Windows 資格情報のセットごとに 1 つの対象アプリケーションが作成されます。 PowerPivot System サービスによって所有されている対象アプリケーションが既に存在し、スケジュールを定義するユーザーが入力したユーザー名とパスワードを保存する場合、PowerPivot System サービスでは新しい対象アプリケーションを作成する代わりにその対象アプリケーションが使用されます。  
  
 この資格情報オプションを使用する主な利点は、使いやすく簡単であることです。 対象アプリケーションが自動的に作成されるため、高度な作業は最小限です。 また、スケジュール所有者 (多くの場合、ブックを作成したユーザー) の資格情報で更新を実行すると、下流の権限要件が簡略化されます。 ほとんどの場合、このユーザーは対象データベースに対する権限を既に持っています。 接続を指定するこのユーザーの Windows ユーザー id、すべてのデータでデータ更新の実行時に '現在のユーザー' は自動的に動作します。  
  
 欠点は、管理機能が制限されていることです。 対象アプリケーションは自動的に作成されますが、アカウント情報が変更されたときに自動的な削除や更新は行われません。 パスワード有効期限ポリシーが原因で、これらの対象アプリケーションが古くなることがあります。 期限切れの資格情報を使用するデータ更新ジョブの開始は失敗します。 この状況が発生した場合、スケジュール所有者は、データ更新スケジュールの現在のユーザー名およびパスワード値を提供することで資格情報を更新する必要があります。 その時点で新しい対象アプリケーションが作成されます。 ユーザーは時間の経過と共にデータ更新スケジュールの資格情報を追加および改訂するため、自動生成された対象アプリケーションがシステムに多数存在することがあります。  
  
 現在、これらの対象アプリケーションがアクティブか非アクティブかを判断する方法はなく、特定の対象アプリケーションを使用するデータ更新スケジュールをトレースする方法もありません。 一般に、対象アプリケーションを削除すると既存のデータ更新スケジュールが破損する可能性があるため、対象アプリケーションは残しておく必要があります。 まだ使用されている対象アプリケーションを削除すると、「ターゲット アプリケーションが見つかりません」、ブックのデータ更新履歴ページに表示される、メッセージで失敗するデータ更新が発生します。  
  
 この資格情報オプションを無効にすることを選択した場合は、PowerPivot データ更新用に生成されたすべての対象アプリケーションを安全に削除できます。  
  
 **データ更新スケジュールでの任意の Windows 資格情報の使用を無効にします。**  
  
1.  サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。  
  
2.  PowerPivot サービス アプリケーションの名前をクリックします。 PowerPivot 管理ダッシュボードが表示されます。  
  
3.  [動作] で次のようにクリックします**サービス アプリケーションの設定を構成する**PowerPivot サービス アプリケーションの設定ページを開く。  
  
4.  データ更新 セクションでは、オフ、**カスタムの Windows 資格情報を入力できるように**チェック ボックスをオンします。  
  
     ![SSAS_PowerPivotDatarefreshOptions_AllowUser](media/ssas-powerpivotdatarefreshoptions-allowuser.gif "SSAS_PowerPivotDatarefreshOptions_AllowUser")  
  
##  <a name="bkmk_stored"></a> ステップ 3:データ更新で使用される資格情報を格納する対象のアプリケーションを作成します。  
 Secure Store Service が構成されると、SharePoint 管理者は、保存された資格情報をデータ更新に使用できるようにする対象アプリケーションを作成できます。この資格情報には、PowerPivot 自動データ更新アカウントや、ジョブの実行または外部データ ソースへの接続に使用されるその他のアカウントが含まれます。  
  
 前のセクションで説明したように、特定の資格情報オプションを使用可能にするには対象アプリケーションを作成する必要があります。 具体的には、PowerPivot 自動データ更新アカウント用の対象アプリケーションに加えて、データ更新操作で使用する追加の保存された資格情報を作成する必要があります。  
  
 保存された資格情報を含む対象アプリケーションを作成する方法の詳細については、次を参照してください[PowerPivot 自動データ更新アカウントを構成する&#40;PowerPivot for SharePoint&#41; ](configure-unattended-data-refresh-account-powerpivot-sharepoint.md)と[。PowerPivot データ更新用の保存された資格情報の構成&#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)します。  
  
##  <a name="bkmk_scale"></a> 手順 4:スケーラブルなデータ更新のサーバーを構成します。  
 既定では、PowerPivot for SharePoint の各インストールで、オンデマンド クエリとスケジュールされたデータ更新の両方がサポートされます。  
  
 インストールごとに、Analysis Services サーバー インスタンスがクエリとスケジュールされたデータ更新の両方をサポートするか、特定の種類の操作専用であるかを指定できます。 ファームに PowerPivot for SharePoint が複数インストールされている場合に、ジョブが遅延または失敗していることがわかったときには、サーバーをデータ更新操作専用にすることを検討できます。  
  
 また、基になるハードウェアでサポートされている場合は、並列に実行するデータ更新ジョブの数を増やすことができます。 既定では、並列に実行できるジョブの数はシステム メモリに基づいて計算されますが、ワークロードをサポートする追加の CPU 容量がある場合はこの数を増やすことができます。  
  
 詳細については、次を参照してください。[専用のデータ更新の構成または Query-Only 処理&#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md)します。  
  
##  <a name="bkmk_installdp"></a> 手順 5:PowerPivot データのインポートに使用されるデータ プロバイダーのインストール  
 データ更新操作は、基本的には元のデータを取得したインポート操作の繰り返しです。 つまり、PowerPivot クライアント アプリケーションでデータのインポートに使用されたデータ プロバイダーを、PowerPivot サーバーにもインストールする必要があるということです。  
  
 Windows サーバーにデータ プロバイダーをインストールするには、ローカル管理者である必要があります。 追加のドライバーをインストールする場合は、必ず PowerPivot for SharePoint がインストールされている SharePoint ファーム内の各コンピューターにインストールします。 ファームに複数の PowerPivot サーバーがある場合は、それぞれのサーバーにプロバイダーをインストールする必要があります。  
  
 SharePoint サーバーは 64 ビット アプリケーションです。 データ更新操作をサポートするには、使用しているデータ プロバイダーの 64 ビット バージョンをインストールしてください。  
  
##  <a name="bkmk_accounts"></a> 手順 6:スケジュールの作成および外部データ ソースにアクセスするアクセス許可を付与します。  
 ブックに対するデータ更新をスケジュールするには、ブックの所有者または作成者が **投稿** 権限を持っている必要があります。 このアクセス許可レベルを指定するには、自分を開くおよび資格情報を指定し、データを更新するための情報をスケジュールするブックのデータ更新構成ページを編集することができます。  
  
 SharePoint 権限に加えて、外部データ ソースに対するデータベース権限を確認して、データ更新中に使用されるアカウントにデータへの十分なアクセス権があることを確認する必要があります。 付与する必要のある権限は、ブック内の接続文字列およびデータ更新ジョブの実行に使用しているユーザー ID によって異なるため、権限要件を判断するには自身を慎重に評価する必要があります。  
  
 **PowerPivot ブックで既存の接続文字列が PowerPivot データ更新操作に重要である理由**  
  
 データ更新の実行時に、サーバーはデータが最初にインポートされたときに作成された接続文字列を使用して外部データ ソースに接続要求を送信します。 その接続文字列で指定されたサーバーの場所、データベース名、および認証パラメーターは、同じデータ ソースにアクセスするためにデータ更新時に再利用されます。 接続文字列とその全体的な構造は、データ更新の目的では変更できません。 データ更新時にはそのまま再利用されます。 Windows 以外の認証を使用してデータ ソースに接続する場合は、接続文字列のユーザー名とパスワードをオーバーライドできることがあります。 この詳細については、このトピックで説明します。  
  
 ほとんどのブックでは、接続の既定の認証オプションで信頼関係接続または Windows 統合セキュリティが使用されるため、結果として接続文字列には `SSPI=IntegratedSecurity` または `SSPI=TrustedConnection` が含まれます。 この接続文字列を使用して、データ更新の際に、データ更新ジョブの実行に使用するアカウントは「現在のユーザー」になります。 そのため、このアカウントには、信頼関係接続を介してアクセスされる外部データ ソースに対する読み取り権限が必要です。  
  
 **有効にすると、PowerPivot 自動データ更新アカウントですか?**  
  
 有効にした場合は、データ更新中にアクセスされるデータ ソースに対する読み取り権限をそのアカウントに付与する必要があります。 なぜ、このアカウントでは読み取りアクセス許可が既定の認証オプションを使用するブックで自動アカウントになるため、'現在のユーザー' データの中に必要がある理由を更新します。 スケジュール所有者が接続文字列で資格情報をオーバーライドしない限り、このアカウントには、組織でアクティブに使用されている任意の数のデータ ソースに対する読み取り権限が必要です。  
  
 **資格情報オプション 2 を使用する: スケジュールの所有者、Windows ユーザー名とパスワードを入力することができますか?**  
  
 通常、PowerPivot ブックを作成するユーザーは、最初にデータを既にインポートしているため、十分な権限を既に持っています。 その後これらのユーザーが自身の Windows ユーザー ID で実行するようにデータ更新を構成した場合、データベースに対する権限を既に持っている Windows ユーザー アカウントがデータ更新中のデータの取得に使用されます。 既存の権限で十分です。  
  
 **資格情報オプション 3 を使用するには: Secure Store Service 対象アプリケーションを使用してデータ更新ジョブを実行するため、ユーザーの id を提供しますか?**  
  
 データ更新ジョブの実行に使用するアカウントには、PowerPivot 自動データ更新アカウントについて説明したのと同じ理由で読み取り権限が必要です。  
  
 **データ更新時に使用される資格情報を上書きできるかどうかを判断する接続文字列を確認する方法**  
  
 前に述べたように、接続で Windows 以外の認証 (SQL Server 認証など) を使用している場合は、データ更新ジョブのレベルで別のユーザー名とパスワードに置き換えることができます。 Windows 以外の資格情報は、UserID および Password パラメーターを使用して接続文字列で渡されます。 これらのパラメーターを含む接続文字列がブックに含まれている場合は、オプションでデータ ソースからのデータの更新に別のユーザー名とパスワードを指定できます。  
  
 次の手順では、ユーザー名とパスワードのオーバーライドを受け入れる接続文字列があるかどうかを確認する方法を説明します。  
  
1.  Excel でブックを開きます。  
  
2.  PowerPivot ウィンドウを開きます (Excel の PowerPivot リボンで [PowerPivot ウィンドウ] をクリックします)。  
  
3.  クリックして**デザイン**します。  
  
4.  クリックして**既存の接続**します。  
  
     すべてのブックで使用される接続が表示**PowerPivot データ接続**します。  
  
5.  接続を選択し、をクリックして**編集**、 をクリックし、**詳細**。 接続文字列はページの下部にあります。  
  
 表示された場合**Integrated Security = SSPI**接続文字列では、接続文字列の資格情報をオーバーライドすることはできません。 接続では常に現在のユーザーが使用されます。 指定した資格情報は無視されます。  
  
 表示された場合**Persist Security Info = False, Password =\* \* \* \* \* \* \* \* \* \* \*、UserID =\<userlogin >** 、接続文字列、資格情報のオーバーライドを許可する必要があります。 接続文字列に表示される資格情報 (UserID や Password など) は、Windows 資格情報ではなく、対象のデータ ソースに対して有効なデータベース ログインまたはその他のサインイン アカウントです。  
  
 **接続文字列の資格情報を上書きする方法**  
  
 資格情報のオーバーライドは、データ更新スケジュールでデータ ソース資格情報を指定することで行います。 管理者は、外部データへのアクセスに使用する資格情報をマップする対象アプリケーションを Secure Store Service で提供できます。 これにより、スケジュール所有者は、定義するデータ更新スケジュールに対象アプリケーション ID を入力することができます。 この対象アプリケーションを作成する方法の詳細については、次を参照してください。[格納されている資格情報の構成の PowerPivot データ更新&#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)します。  
  
 または、スケジュール所有者は、データ更新中にデータ ソースへの接続に使用される資格情報のセットを入力できます。 次の図に、スケジュール定義ページのこのデータ ソース オプションを示します。  
  
 ![SSAS_PowerPivotKJ_DataRefreshDSOptions](media/ssas-powerpivotkj-datarefreshdsoptions.gif "SSAS_PowerPivotKJ_DataRefreshDSOptions")  
  
 **データ アクセス要件の識別**  
  
 前のセクションに示したように、多くの場合、データ更新の実行と外部データ ソースへの接続に使用されるアカウントは 1 つの同じアカウントです。 そのため、外部データ ソースへのアクセスに使用されるアカウントは、データ更新スケジュール ページのこの部分のオプション セットによって決定されます。 これは、PowerPivot 自動データ更新アカウント、個々のユーザーの Windows アカウント、または定義済み対象アプリケーションに保存されているアカウントの場合があります。  
  
 ![SSAS_PowerpivotKJ_DataRefreshCreds](media/ssas-powerpivotkj-datarefreshcreds.gif "SSAS_PowerpivotKJ_DataRefreshCreds")  
  
 データ更新の実行に使用されるアカウントが、データのインポートに使用されるアカウントと異なる場合 (たとえば、資格情報オプション 1 による PowerPivot 自動データ更新アカウント、または資格情報オプション 3 による保存された資格情報の他のセット)、そのアカウント用に新しいデータベース ログインを作成し、外部データ ソースに対する読み取り権限を付与する必要があります。  
  
 どのアカウントにデータ アクセスが必要かを理解した後で、PowerPivot ブックで最も頻繁に使用されるデータ ソースに対する権限のチェックを開始できます。 アクティブに使用されている任意のデータ ウェアハウスまたはレポート データベースから開始しますが、最もアクティブな PowerPivot ユーザーからの入力も要求して、そのユーザーが使用しているデータ ソースを調べます。 データ ソースの一覧を入手したら、各データ ソースのチェックを開始して、権限が正しく設定されていることを確認できます。  
  
##  <a name="bkmk_upgradewrkbk"></a> 手順 7:データ更新用のブックのアップグレードを有効にします。  
 既定では、[!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] バージョンの PowerPivot for Excel を使用して作成されたブックに対して、[!INCLUDE[ssSQL11](../includes/sssql11-md.md)] バージョンの PowerPivot for SharePoint 上で定期データ更新を構成することはできません。 SharePoint 環境で新しいバージョンと古いバージョンの PowerPivot ブックをホストしている場合は、[!INCLUDE[ssKilimanjaro](../includes/sskilimanjaro-md.md)] ブックをアップグレードしてからでなければ、サーバーでの自動データ更新をスケジュールすることはできません。  
  
##  <a name="bkmk_verify"></a> 手順 8:データ更新の構成を確認します。  
 データ更新を確認するには、SharePoint サイトにパブリッシュされる PowerPivot ブックが必要です。 ブックに対する投稿権限と、データ更新スケジュールに含まれているデータ ソースへのアクセス権が必要です。  
  
 スケジュールを作成するときに選択、**も、できるだけ早く更新**データ更新をすぐに実行するチェック ボックスをオンします。 その後、そのブックのデータ更新履歴ページをチェックして、正常に実行されたことを確認します。 PowerPivot データ更新タイマー ジョブは 1 分おきに実行されることに注意してください。 データ更新に成功したことを確認するには、それ以上の時間がかかります。  
  
 サポートを計画しているすべての資格情報オプションを試してください。 たとえば、PowerPivot 自動データ更新アカウントを構成した場合は、そのオプションを使用して、データ更新が成功することを確認します。 スケジュール設定と状態情報の表示の詳細については、次を参照してください[データ更新のスケジュール&#40;PowerPivot for SharePoint&#41; ](schedule-a-data-refresh-powerpivot-for-sharepoint.md)と[データ更新履歴の表示&#40;PowerPivot for SharePoint。&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md).  
  
 データ更新に失敗する場合を参照してください、 [PowerPivot データ更新のトラブルシューティング](https://go.microsoft.com/fwlink/?LinkID=223279)考えられる解決策の TechNet wiki のページ。  
  
##  <a name="bkmk_config"></a> データ更新の構成設定を変更します。  
 各 PowerPivot サービス アプリケーションには、データ更新操作に影響する構成設定が備えられています。 ここでは、これらの設定を変更する方法について説明します。  
  
###  <a name="procIntervals"></a> 設定 ' 営業時間"を業務時間外の処理を決定するには  
 データ更新操作をスケジュールする SharePoint ユーザーは、"営業時間後" の最も早い時刻を開始時刻として指定することができます。 これは、営業時間内に蓄積されたビジネス トランザクション データを取得する場合に便利です。 ファームの管理者は、組織の営業時間を最もよく定義する時間の範囲を指定できます。 営業時間を 04:00 ～ 20:00 と定義した場合、"営業時間後" の開始時刻に基づくデータ更新処理は 20:01 に開始されます。  
  
 営業時間外に実行されるデータ更新要求は、受信された順にキューに追加されます。 個々の要求は、サーバー リソースが使用可能になると処理されます。  
  
1.  サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。  
  
2.  PowerPivot サービス アプリケーションの名前をクリックします。 PowerPivot 管理ダッシュボードが表示されます。  
  
3.  [動作] で次のようにクリックします**サービス アプリケーションの設定を構成する**PowerPivot サービス アプリケーションの設定ページを開く。  
  
4.  [データ更新] セクションの [営業時間] に、営業時間後の処理期間を定義する開始時刻と終了時刻を入力します。  
  
     営業時間外の処理期間を定義しない場合は、[開始時刻] と [終了時刻] の両方に同じ値を入力します (両方に「12:00」と入力するなど)。 ただし、その場合も、SharePoint サイトのスケジュール定義のページには [営業時間後] がオプションとして表示されます。 営業時間外の処理期間が定義されていないファームでユーザーがそのオプションを選択すると、ジョブを開始できないためにデータ更新エラーが発生します。  
  
5.  **[OK]** をクリックします。  
  
###  <a name="usagehist"></a> データ更新の履歴が保持される期間を制限します。  
 データ更新の履歴とは、データ更新操作に対して生成された成功と失敗のメッセージの長期間にわたる詳細な記録です。 履歴情報は、ファームの使用状況データ収集システムによって収集および管理されます。 そのため、使用状況データの履歴に対して設定した制限がデータ更新の履歴にも適用されます。 使用状況のレポートには PowerPivot システム全体から収集されたデータが含まれるため、データ更新の履歴のデータ保有期間と、収集および格納される他のすべての使用状況データのデータ保有期間の両方が、1 つの履歴設定を使用して制御されます。  
  
1.  サーバーの全体管理で、[アプリケーション構成の管理] の **[サービス アプリケーションの管理]** をクリックします。  
  
2.  PowerPivot サービス アプリケーションの名前をクリックします。 PowerPivot 管理ダッシュボードが表示されます。  
  
3.  [動作] で次のようにクリックします**サービス アプリケーションの設定を構成する**PowerPivot サービス アプリケーションの設定ページを開く。  
  
4.  [使用状況データ収集] セクションの [使用状況データの履歴] で、各ブックのデータ更新操作の記録を保持する日数を入力します。  
  
     既定値は 365 日です。 最小値は 1 日であり、最大値は 5000 日です。 0 を指定すると保有期間が制限されず、データが削除されません。 履歴をオフにするための設定はありません。  
  
5.  **[OK]** をクリックします。  
  
 履歴情報は、データ更新の履歴があるブックで [データ更新の管理] オプションを選択すると使用できるようになります。 この情報は、ファームの管理者が PowerPivot サービスの操作を管理するために使用する PowerPivot 管理ダッシュボードでも使用されます。 詳細については、次を参照してください。[データ更新履歴の表示&#40;PowerPivot for SharePoint&#41;](power-pivot-sharepoint/view-data-refresh-history-power-pivot-for-sharepoint.md)します。  
  
 履歴データが長期間にわたって物理的に格納される場所は、PowerPivot サービス アプリケーションの PowerPivot サービス アプリケーション データベースです。 使用状況データの収集および保存する方法の詳細については、次を参照してください。 [PowerPivot 使用状況データ収集](power-pivot-sharepoint/power-pivot-usage-data-collection.md)します。  
  
##  <a name="configTimerJob"></a> PowerPivot データ更新タイマー ジョブのスケジュールを変更します。  
 スケジュールされたデータ更新は、PowerPivot サービス アプリケーション データベースのスケジュール情報を 1 分ごとにスキャンする PowerPivot データ更新タイマー ジョブによってトリガーされます。 データ更新の開始がスケジュールされていた場合、タイマー ジョブは、使用可能な PowerPivot サーバーの処理キューに要求を追加します。  
  
 パフォーマンス チューニングの一環として、このスキャンの間隔を長くできます。 また、トラブルシューティングの際にタイマー ジョブを無効にして、データ更新操作を一時的に停止することもできます。  
  
 既定の設定は 1 分です。これより低い値を指定することはできません。 この値を使用すると、1 日の任意の時刻に実行されるスケジュールの結果を最も予測しやすくなるため、この値を使用することをお勧めします。 たとえば、データ更新を午後 4 時 15 分にスケジュールした場合、タイマー ジョブがスケジュールを 1 分ごとにスキャンしていれば、スケジュールされたデータ更新要求が 4 時 15 分に検出され、その後数分以内に処理が実行されます。  
  
 スキャンの間隔を長くして、ごくたまにしかスキャンが行われないようにすると (1 日に 1 回、午前 0 時にスキャンが行われるようにするなど)、その間隔の間に実行するようにスケジュールされたすべてのデータ更新操作が一度に処理キューへ追加されます。この場合、サーバーに対する負荷が大きくなり、他のアプリケーション用のシステム リソースが不足する可能性があります。 スケジュールされていた更新数によっては、データ更新操作の処理キューが長くなりすぎて、完了できないジョブが生じる場合もあります。 その状態で次の処理間隔に入り、キューの末尾にあるデータ更新要求が削除される可能性があります。  
  
 使用するハードウェアがサポートしている場合は、追加のプロセッサでより多くのデータ更新ジョブが並列実行されるように指定すると、この問題を緩和できます。 詳細については、次を参照してください。[専用のデータ更新の構成または Query-Only 処理&#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md)します。 データ更新要求を検出、キューに追加および処理する方法の詳細については、次を参照してください。 [PowerPivot データ更新](power-pivot-sharepoint/power-pivot-data-refresh.md)します。  
  
1.  サーバーの全体管理で **[監視]** をクリックします。  
  
2.  **[ジョブ定義の確認]** をクリックします。  
  
3.  選択、 **PowerPivot データ更新タイマー ジョブは**します。  
  
4.  スケジュールの頻度を変更して、タイマー ジョブがデータ更新スケジュールの情報をスキャンする頻度を変更します。  
  
##  <a name="bkmk_disableDR"></a> データ更新タイマー ジョブを無効にします。  
 PowerPivot データ更新タイマー ジョブは、ファーム内のすべての PowerPivot サーバー インスタンスに対して有効または無効になるファーム レベルのタイマー ジョブです。 これは、特定の Web アプリケーションや PowerPivot サービス アプリケーションには関連付けられていません。 PowerPivot データ更新タイマー ジョブを一部のサーバーで無効にして、ファーム内の他のサーバーでデータ更新処理が行われるようにすることはできません。  
  
 PowerPivot データ更新タイマー ジョブを無効にすると、既にキューに入れられていた要求は処理されますが、再びジョブを有効にするまで新しい要求は追加されません。 過去にスケジュールされていた要求は処理されません。  
  
 タイマー ジョブを無効にしても、アプリケーション ページで使用できる機能には影響はありません。 Web アプリケーションのデータ更新機能を削除したり非表示にしたりすることはできません。 タイマー ジョブが永続的に無効になっていても、投稿権限以上の権限を持つユーザーはデータ更新操作の新しいスケジュールを作成できます。  
  
## <a name="see-also"></a>参照  
 [データ更新のスケジュール&#40;PowerPivot for SharePoint&#41;](schedule-a-data-refresh-powerpivot-for-sharepoint.md)   
 [データ更新専用またはクエリ専用処理構成&#40;PowerPivot for SharePoint&#41;](configure-dedicated-data-refresh-query-only-processing-powerpivot-sharepoint.md)   
 [構成、PowerPivot 自動データ更新アカウント&#40;PowerPivot for SharePoint&#41;](configure-unattended-data-refresh-account-powerpivot-sharepoint.md)   
 [PowerPivot データ更新用の保存された資格情報の構成&#40;PowerPivot for SharePoint&#41;](configure-stored-credentials-data-refresh-powerpivot-sharepoint.md)  
  
  
