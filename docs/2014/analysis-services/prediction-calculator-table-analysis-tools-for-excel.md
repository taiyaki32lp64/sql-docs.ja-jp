---
title: 予測計算 (Excel 用テーブル分析ツール) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- mining model, regression
- Table Analysis tools
- scorecard
- logistic regression
- prediction calculator
ms.assetid: 8bb8c318-e85f-4fd6-b32b-4cdfb13ca1b5
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: e57aee7142da5c256a213ddd2eb0390a0f3b042a
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "66070860"
---
# <a name="prediction-calculator-table-analysis-tools-for-excel"></a>予測計算 (Excel 用のテーブル分析ツール)
  ![予測計算ツール](media/tat-predcal.gif "予測計算ツール")  
  
 **予測計算**ツールを使用して、新しいデータを分析し、オプションやリスクの評価に使用できるスコアカードを作成できます。 たとえば、顧客に関する履歴データや人口統計データがある場合、**予測計算**ツールに役立つ 2 つの主要タスク。  
  
-   人口統計や購買行動など、さまざまな要因についての基礎となる分析の生成。  
  
-   メンバーを評価して新しい製品やサービスを提案する場合に役立つ作業スコアカードの作成。  
  
 ウィザードでは、基になるすべての計算が格納されたワークシートも作成されます。これにより、モデルを操作して、さまざまな入力値が最終的なスコアに与える影響を調べることができます。  
  
 また、必要に応じて、ワークシートの印刷バージョンを作成してオフラインでスコアリングを行うこともできます。 印刷バージョンは、オンラインの Excel ブックのようにモデルを操作することはできません。ただし印刷バージョンのワークシートには、値を記入して最終的なスコアを計算するためのすべての計算が含まれています。  
  
## <a name="using-the-prediction-calculator-tool"></a>予測計算ツールの使用  
  
1.  分析するデータが含まれている Excel テーブルを開きます。  
  
2.  クリックして**予測計算**上、**分析**タブ。  
  
3.  **予測計算** ダイアログ ボックスで、ターゲットの購買行動など、予測する列を選択します。  
  
4.  ターゲット値を指定します。 値が数値の場合は、オプションを使用して、**範囲で**、し、必要な範囲の最小値と最大値を入力します。 値が不連続で場合は、選択、**正確に**オプションし、ドロップダウン リストから値を選択します。  
  
5.  クリックして**分析に使用する列の選択**します。  
  
6.  **高度な列の選択** ダイアログ ボックスで、有用な情報を含む列を選択します。 分析に関係のない列は削除してください。 **[OK]** をクリックします。  
  
     結果がゆがめられるのを避けるためには、重複する情報を含む列も削除する必要があります。 たとえば、数値データを含む収入の列と、"高"、"中"、"低" というラベルを含む収入グループの列がある場合は、両方の列を同じモデルに含めないようにしてください。 代わりに、それぞれの列に対して別のモデルを作成します。  
  
7.  **出力オプション**セクションで、**操作可能な計算**分析とスコアカード、Excel ブックを作成します。 選択**印刷向けの計算**を分析を作成しても印刷して手動でスコア付けに使用できるレポートを生成します。  
  
8.  **[実行]** をクリックします。  
  
     レポートやスコアカードを含む新しいワークシートが作成されます。  
  
### <a name="requirements"></a>要件  
 **予測計算**ツールは、離散化と連続する数値データと不連続の値を使用できる Microsoft ロジスティック回帰アルゴリズムを使用します。  
  
## <a name="understanding-the-scoring-reports"></a>スコアリング レポートについて  
 両方の出力オプションを選択した場合は、現在のブックに次の 3 つの新しいワークシートが作成されます。  
  
-   A**予測レポート**、対話型のテーブルの完全な分析の結果を格納しているとする際に役立つグラフは、操作や利益に関する実験します。  
  
-   対話型**予測計算**スコアを作成するのに役立ちます。  
  
-   A**印刷可能な計算**スコアリングに使用するには、手順と係数。  
  
-   ここでは、各レポートに含まれる情報と、さまざまなレポート オプションの使用方法について説明します。  
  
### <a name="prediction-report-with-graphs"></a>グラフを含む予測レポート  
 最初の予測レポートのタイトルは**の予測計算レポート、\<対象の状態 > の\<ターゲット属性 >** します。 このレポートには、分析から得られた要因のテーブルと、特定の分析の財務的影響を評価するためのツールが含まれています。  
  
#### <a name="table-for-specifying-costs-and-profits"></a>コストと利益を指定するためのテーブル  
 このレポートの左上にある最初のツールは、値の正確な予測や不正確な予測に関連するコストと利益を指定できるテーブルです。  これらのコストと利益は、計算の最適なスコアしきい値を算出するために必要です。  
  
|アイテム|説明と例|  
|----------|-----------------------------|  
|偽陽性のコスト|モデルで予測された陽性の結果が実際には間違っているのに正しいと想定した場合のコスト。<br /><br /> たとえば、顧客が商品を購入するというモデルの予測に基づいて、その顧客を対象とするキャンペーンを企画した場合の、 顧客獲得に要するコストをここに入力します。|  
|偽陰性のコスト|モデルで予測された陰性の結果が実際には間違っているのに正しいと想定した場合のコスト。<br /><br /> たとえば、年齢層の高い顧客は自転車を購入しないとモデルで予測されたが、モデルがゆがめられていたために、結果として年齢層の高い顧客を対象とする機会を逃すことになった場合の 顧客あたりのコストをここに入力します。|  
|真陽性の利益|陽性の結果が正しく予測された場合の利益です。 たとえば、適切な顧客を対象にして売上に結び付いた場合に得られる顧客あたりの利益をここに入力します。|  
|真陰性の利益|陰性の結果が正しく予測された場合の利益です。<br /><br /> たとえば、対象にしない顧客を正しく特定できた場合に節約できる顧客あたりの広告費をここに入力します。|  
  
#### <a name="chart-for-viewing-maximum-profit"></a>最大の利益を表示するためのグラフ  
 テーブルに値を入力すると、関連するグラフが自動的に更新されて、現在のモデルで利益を最大化するための最適なポイントが示されます。 このテーブルの右側にある折れ線グラフには、さまざまなスコアしきい値の利益が表示されます。 この利益は、テーブルに入力した利益とコストの数値を使用し、モデルの予測と確率に基づいて評価されます。  
  
 たとえば、左上のテーブルのセルの場合、**利益を最大化する推奨されるしきい値**値が 500 を示しています、右側にあるグラフが 500 を最高点、線グラフとして表示されます。 この 500 という値は、マイニング モデルの上位 500 の推奨値 (確率の高い順) を使用すると利益が最大になることを表しています。  
  
#### <a name="table-listing-scores-for-each-attribute-and-value"></a>属性と値の各組み合わせのスコアを含むテーブル  
 レポートの左下にあるテーブルには、検出された値の詳細な内訳と、それぞれの値が結果に与える影響が表示されます。 このテーブルの値は変更できません。これらの値は、予測を理解しやすくするために表示されています。  
  
 たとえば次の表は、対象となる結果が顧客による自転車の購入である場合の結果の例を示しています。 このテーブルには、モデルで使用された各入力列が、モデルに影響を与えたかどうかに関係なく含まれています。 また、入力列に連続する数値データが格納されている場合は、不連続値や離散値も含まれます。  
  
 内の値、**相対的影響**列は、パーセンテージで表される確率です。 この値が結果に与える影響を視覚的に表すために、セルが網掛けされます。  
  
|属性|値|相対的影響|  
|---------------|-----------|---------------------|  
|Marital Status|Married|0|  
|Marital Status|単一|71|  
|Gender|Female|13|  
|Gender|Male|0|  
  
 これらの要因は次のように解釈できます。  
  
-   顧客が結婚していることは、その顧客が自転車を購入する可能性に影響しない。  
  
-   顧客が独身であることは、その顧客が自転車を購入する可能性が高いことを示す強力な要因となる (70%)。  
  
-   顧客の性別が自転車の購買行動の予測に与える影響は、顧客が女性の場合にはごくわずかで (13%)、顧客が男性の場合にはまったくない。  
  
#### <a name="chart-of-cumulative-misclassification-cost"></a>累積誤分類コストのグラフ  
 レポートの右下の面グラフは、さまざまなスコアしきい値の累積誤分類コストを示しています。 このグラフでも、偽陽性、真陽性、偽陰性、真陰性に対して入力するコストと利益の数値が使用されます。  
  
 利益の最大化を焦点とするレポートの右上のグラフとは違って、このグラフには、間違った予測が行われた場合のコストが組み込まれます。 正しい予測が行われた場合の利益より間違った決断が下された場合のコストの方がはるかに重視される、回避策などのシナリオで特に役に立ちます。  
  
 たとえば最初のグラフでは、モデルによって予測された上位 500 の顧客を対象にすることが利益を最大化する方法として示されていますが、この 2 つ目のグラフから、間違った顧客を対象にした場合のコストが大きすぎると判断し、最初の 400 の顧客まででマーケティング キャンペーンを打ち切ることを決断する場合も考えられます。  
  
### <a name="interactive-prediction-calculator"></a>対話型の予測計算  
 予測計算ツールによって作成される 2 番目のワークシートのタイトルは**の予測計算、\<対象の状態 > の\<ターゲット属性 >** します。 これは、個々のスコアを計算するために使用できる対話型ワークシートです。 このワークシートでは、モデルに格納されているパターンと統計が使用されるため、さまざまな値がスコアの予測にどのように影響するのかを試してみることができます。 またこのレポートには、対話型と参照用の 2 つのセクションが用意されています。  
  
#### <a name="first-table"></a>最初のテーブル  
 選択するかに新しい値を入力することができます、**値**値を変更するがスコアに与える影響を確認するテーブルの列。  
  
 たとえば、レポートに次の値が含まれていた場合、自動車の値を 1 に減らし、その後さらに 0 に減らして、顧客の購買行動にどのように影響するのかを調べることができます。 値を変更すると、**自動車**を 0 に、下部にある、予測が TRUE に変更します。  
  
|属性|値|相対的影響|  
|---------------|-----------|---------------------|  
|Marital Status|Married|0|  
|Gender|Male|0|  
|Income|39050 - 71062|117|  
|Children|0|157|  
|Education|Bachelors|22|  
|Occupation|Skilled Manual|33|  
|Home Owner|はい|8|  
|Cars|2|50|  
|Commute Distance|0-1 Miles|99|  
|Region|North America|0|  
|Age|37 - 46|5|  
|Total||491|  
|Prediction for 'Yes'||FALSE|  
  
 Prediction for Yes、セルに表示されるスコアが TRUE に変わり、新しい値を入力すると、**相対的影響**スコアのさまざまな属性がも更新されます。  
  
> [!NOTE]  
>  1 つの値 (車の数など) のみを変更した場合でも、他の属性の値や影響が変わることもあります。 データ マイニング モデルではデータの間に複雑な関係が検出されることが多く、1 つの変数の変更が予期しない影響をもたらすこともあるからです。 このため、対話型の予測計算を使用してさまざまな値を試してみたり、マイニング モデルを参照してその詳細を調べてみたりすることをお勧めします。 詳細については、次を参照してください。[参照モデル](prediction-calculator-table-analysis-tools-for-excel.md)します。  
  
#### <a name="score-breakdown"></a>スコアの内訳  
 このテーブルには、入力列の各状態の個々のスコアと、そのスコアが結果に与える相対的影響が示されています。 これは、参照専用の静的なテーブルです。  
  
### <a name="printable-prediction-calculator"></a>印刷可能な予測計算  
 予測計算ツールによって作成される 3 つ目のワークシートのタイトルは**の PrintablePrediction 電卓、\<対象の状態 > の\<ターゲット属性 >** します。 このスコアカードは、コンピューターを使用できない場所でスコアを手動で計算できるように印刷するためのものです。  
  
##### <a name="to-print-and-use-the-scoring-report-generated-by-the-prediction-calculator"></a>予測計算によって生成されるスコアリング レポートを印刷して使用するには  
  
1.  タイトルはタブをクリックして**の印刷可能な予測計算\<属性 >** します。  
  
2.  [Excel ファイル] メニューで、次のように選択します。**印刷プレビュー**します。  
  
3.  スコアカードが目的どおりに印刷されるように、ページの向きや余白などの印刷オプションを変更します。  
  
     このスコアカードは動的なものではなく、モデルには一切関連付けられていません。したがって、書式を整えるために列や行を移動しても、基になるデータには影響しません。  
  
4.  スコアカードを印刷します。  
  
5.  各属性について値を 1 つだけ選択します。 値の選択、ボックスに、チェック マークを配置してで対応する番号を記述、**スコア**列。  
  
6.  正確さを確保するため、できるだけ多くの属性のスコアを記入します。  
  
7.  各属性のスコアの合計を計算し、その番号を入力、**合計**行。  
  
8.  シートに印刷される条件を使用して、スコアを予測結果に変換した直後に、**合計**行。  
  
## <a name="related-tools"></a>関連ツール  
 [!INCLUDE[ssASnoversion](../includes/ssasnoversion-md.md)] には、この種類の分析に使用できる Microsoft ロジスティック回帰アルゴリズムが用意されています。 使用してロジスティック回帰モデルを簡単に作成したロジスティック回帰理解している場合、**詳細**Excel 用データ マイニング クライアントのオプション。 詳細については、次を参照してください。[高度なモデリング&#40;Excel 用データ マイニング アドインで&#41;](advanced-modeling-data-mining-add-ins-for-excel.md)します。 オプションおよびロジスティック回帰モデルのパラメーターの詳細については、トピックの「Microsoft ロジスティック回帰アルゴリズム」を参照してください[!INCLUDE[ssNoVersion](../includes/ssnoversion-md.md)]オンライン ブックの「します。  
  
## <a name="see-also"></a>参照  
 [Excel 用テーブル分析ツール](table-analysis-tools-for-excel.md)  
  
  
