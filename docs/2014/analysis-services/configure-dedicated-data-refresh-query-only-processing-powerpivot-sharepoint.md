---
title: データ更新専用またはクエリ専用処理 (PowerPivot for SharePoint) の構成 |Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 5e027605-1086-4941-bb01-f315df8f829b
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: eaf62d2bbe6e6becc21bbf5e870c9fe442c96f74
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "66087510"
---
# <a name="configure-dedicated-data-refresh-or-query-only-processing-powerpivot-for-sharepoint"></a>データ更新専用またはクエリ専用処理 (PowerPivot for SharePoint を) 構成します。
  SharePoint 統合モードでは、データ更新専用の処理やクエリ専用の処理など、特定の種類の処理要求をサポートするように Analysis Services サーバー インスタンスを構成できます。 既定では、どちらの種類の読み込み要求も有効になっています。 これらのどちらかの種類を無効にすることで、専用のクエリ エンジンまたはデータ更新サーバーを作成することができます。  
  
 **[!INCLUDE[applies](../includes/applies-md.md)]**  SharePoint 2010  
  
> [!NOTE]  
>  このリリースでは、データ更新ジョブまたはオンデマンド クエリについて、メモリまたは CPU の使用量を制限する構成設定はありません。 [!INCLUDE[ssGeminiSrv](../includes/ssgeminisrv-md.md)] インスタンスでは、管理しているクエリおよびデータ更新ジョブを実行するために使用できるすべてのリソースが使用されます。  
  
 このトピックには、次のセクションが含まれます。  
  
 [処理モードを構成します。](#config)  
  
 [並列で実行できるデータ更新ジョブの数を変更します。](#change)  
  
##  <a name="config"></a> 処理モードを構成します。  
  
1.  サーバーの全体管理で、[システム設定] の **[サーバーのサービスの管理]** をクリックします。  
  
2.  ページの上部にある [サーバー] の下矢印をクリックし、 **[サーバーの変更]** をクリックします。  
  
3.  構成する Analysis Services サーバー インスタンスを含む SharePoint サーバーを選択します。  
  
4.  **[SQL Server Analysis Services]** をクリックします。  
  
5.  [サービス インスタンスの使用状況] で、次のいずれかの操作を行います。  
  
    1.  チェック ボックスをオフ**の読み取り専用のデータベースの読み込みを有効にする**PowerPivot データを含むブックを開くときに発生するオンデマンド クエリ処理をオフにします。  
  
    2.  チェック ボックスをオフ**更新用のデータベースの読み込みを有効にする**定期データ更新をオフにします。  
  
    > [!NOTE]  
    >  データ更新を無効にしても SharePoint サイトのデータ更新オプションは削除されません。 PowerPivot ブックを所有するユーザーは引き続きデータ更新のスケジュールを作成できますが、そのサーバーでデータ更新は発生しません。  
  
6.  必要に応じて、データ更新操作の同時更新ジョブの数を変更できます。 サーバーをデータ更新専用に構成する場合やサーバーに他にもプロセッサがある場合は、同時ジョブの数を増やすことをお勧めします。 他のオンデマンド クエリ用にシステム リソースを解放する場合は、同時ジョブの数を減らします。  
  
7.  変更を保存します。 処理イベントが発生するまでは、サーバーで入力内容の検証は行われません。 入力した同時ジョブの数が無効な場合は、次の要求の処理時にエラーが検出されてログに記録されます。  
  
##  <a name="change"></a> 並列で実行できるデータ更新ジョブの数を変更します。  
 データ更新ジョブは、PowerPivot サービス アプリケーションで管理および監視される処理キューに追加される定期タスクです。 ジョブは、PowerPivot ブックの 1 つ以上のデータ ソースのスケジュール情報で構成されます。 定義されているスケジュールごとに個別のジョブが作成されます。 ブックの所有者がすべてのデータ ソースに対して 1 つのスケジュールを定義している場合は、データ更新操作全体に対してジョブが 1 つだけ作成されます。 ブックの所有者が外部データ ソースに対して個別のスケジュールを作成している場合は、そのブック全体のデータ更新を完了するために複数のジョブが作成されて実行されます。  
  
 他の読み込みにも対応できるだけの容量がシステムにある場合は、同時に実行できるデータ更新ジョブの数を増やすことができます。  
  
|設定|有効な値|説明|  
|-------------|------------------|-----------------|  
|既定値|RAM に基づいて計算されます。|既定値は、使用可能なメモリの量を 4 GB で除算して求められます。 既定値を式で計算することで、システムの容量に応じて設定を調整できるようになっています。<br /><br /> 注:4 ギガバイト除数は、実際の PowerPivot データ ソースの多数のサンプリングの RAM 使用量に基づく選択されました。 PowerPivot の物理的または論理的なアーキテクチャに基づくものではありません。|  
|最大値|CPU の数に基づいて計算されます。|指定できる同時ジョブの最大数は、コンピューターのプロセッサの数に基づきます。 たとえば、4 ソケットのクアッドコア コンピューターの場合、同時に実行できるジョブの最大数は 16 です。|  
  
#### <a name="increasing-the-default-value-to-a-higher-value"></a>既定値を大きくする  
 次のチャートは、RAM と CPU のさまざまな組み合わせと、その結果、システム特性に基づいて計算される既定値および最大値を示しています。 同時に実行できるデータ更新ジョブの数の計算された既定値はシステム メモリに基づき、計算された最大値は CPU に基づくことに注意してください。 最後の列は、同時データ更新ジョブの最大数を増やすことができるかどうかを示します。  
  
|実際の RAM (GB)|既定値の計算値|実際の CPU の数|最大値の計算値|同時ジョブを増やせるかどうか|  
|---------------------------------|------------------------------|------------------------|------------------------------|-------------------------------|  
|4|1|1|1|No. 既定値と最大値は同じです。|  
|4|1|4|4|可能。 同時ジョブの数を 2、3、または 4 に増やすことができます。|  
|8|2|4|4|可能。 同時ジョブの数を 3 または 4 に増やすことができます。|  
|16|4|4|4|No. 既定値と最大値は同じです。|  
|32|既定値を計算する式を使用すると、既定値は 8 になります。 既定値は許容される最大値を超えるため、この場合、計算された既定値は使用されません。|4|4|No. RAM の大きさに基づくと同時ジョブの既定値は 8 ですが、コンピューターにプロセッサが 4 つしかないため、サポートされる同時ジョブの最大数は 4 になります。|  
|32|8|8|8|No.|  
|32|8|16|16|可能。|  
|64|16|16|16|No.|  
  
 同時に複数のジョブを正常に実行できるかどうかは事前にはわからないため、同時ジョブの数を増やす場合は、事前にメモリ使用量の経時変化を分析し、全体的にサーバー メモリが不足しないことを確認してください。  
  
 各データ更新ジョブの負荷の特性は、更新するデータ ソースの数とサイズによって異なります。 1 つのデータ ソースから成る行数が少ないブックの方が、多数のデータ ソースから成る大規模な行セットのブックよりも負荷は少なくなります。  
  
## <a name="see-also"></a>関連項目  
 [SharePoint 2010 での PowerPivot データ更新](powerpivot-data-refresh-with-sharepoint-2010.md)  
  
  
