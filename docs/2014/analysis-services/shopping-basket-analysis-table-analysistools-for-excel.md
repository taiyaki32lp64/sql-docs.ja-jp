---
title: 買い物かご分析 (Excel 用テーブル分析ツール) |Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
helpviewer_keywords:
- shopping basket analysis
- mining model, association
- Table Analysis tools
- association [data mining]
- market basket analysis
ms.assetid: ba40cf43-f286-49ad-8316-70f5b11f1dae
author: minewiskan
ms.author: owend
manager: craigg
ms.openlocfilehash: 3dadc054a3f9927c09e9e236044dd5ddee7f3a9a
ms.sourcegitcommit: 3026c22b7fba19059a769ea5f367c4f51efaf286
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/15/2019
ms.locfileid: "66068680"
---
# <a name="shopping-basket-analysis-table-analysistools-for-excel"></a>買い物かご分析 (Excel 用のテーブル分析ツール)
  ![買い物かごツール](media/tat-shopbskt.gif "買い物かごツール")  
  
 **買い物かご分析**ツールでは、検索できます。`associations`データ。 アソシエーションにより、同時に購入される頻度が高いアイテムがわかります。 この手法はよく知られているメソッドと呼ばれる、データ マイニングで*マーケット バスケット分析*非常に大きなデータ セット内の顧客の購買行動を分析に使用されます。 マーケティング担当者は、この情報を使用して顧客に関連製品を提案したり、関連製品を Web ページ、カタログ、または棚の近接箇所に配置して宣伝したりすることができます。  
  
 買い物かご分析を使用するには、分析するアイテムがトランザクション ID で関連付けられている必要があります。 たとえば、Web サイトを通じて受け取ったすべての注文を分析する場合は、各注文に対して、1 つ以上の購入アイテムに関連付けられた注文 ID またはトランザクション ID が割り当てられます。  
  
 2 つの新しいワークシートを作成しますが、ウィザードでは、データの分析が完了したら、**買い物かごアイテム グループ**と**買い物かごルール**します。  
  
 **買い物かごアイテム グループ**ワークシートには、トランザクションで頻繁に一緒に出現する項目の一覧が含まれています。 これらの一般的なグループ化と呼びます*アイテム セット*します。 ワークシートも含まれています、統計など*サポート*と*リフト*、アイテム セットの有意性を理解するのに役立ちます。 価格情報を使用できる場合は、すべての関連アイテムの価値合計もワークシートで作成され、トランザクションの合計値が示されます。  
  
 レポート内の列では、フィルター処理および並べ替えを実行できます。 たとえば、2 つ以上の製品とアイテム セットのみを表示したり、アイテム セットを順序付けする可能性があります**買い物かごの平均値**します。  
  
 **買い物かごルール**ワークシート分析から得られた統計情報を使用して項目の関連付けに関するルールを作成します。 たとえば、ルールがある場合、顧客が製品 A が購入される製品 B. を購入する可能性が高い推奨事項を作成するルールを使用できます。 各ルールには、ルールの強さの評価に役立つサポート統計があり、ルールが特定の確率しきい値を超えた場合にのみ提案を行うことができます。  
  
## <a name="using-the-shopping-basket-analysis-tool"></a>買い物かご分析ツールの使用  
  
1.  適切なデータが保存されている Excel テーブルを開きます。 サンプル ブックで [関連付け] ワークシートをクリックします。  
  
2.  クリックして**買い物かご分析**します。  
  
3.  **買い物かご分析** ダイアログ ボックスで、トランザクション ID を含む列を選択し、項目または分析する製品を含む列を選択します。  
  
4.  必要に応じて、製品価値を含む列を追加できます。  
  
5.  クリックして**詳細設定**を開く、**パラメーター設定の高度な** ダイアログ ボックス。 値を大きく**最小のサポート**アイテム セットとしてグループ化されている製品の数を減らします。 増やす、**ルールの最小確率**を非常に一般的なアイテム セットをフィルター処理します。  
  
### <a name="requirements"></a>要件  
 使用する、**買い物かご分析**ツール、データが Excel テーブルに格納する必要があり、次の列を含める必要があります。  
  
-   トランザクションを表す一意の ID が格納された列。 ID は、各行の値が一意である限り、数値でもテキストでもかまいません。  
  
-   分析するアイテムまたは製品が格納された列。  
  
-   各アイテムの価格または価値を表す数値列 (省略可能)。 この列を使用すると、各製品が属するアイテムセットの価値が集計され、特定のトランザクションの合計値を把握しやすくなります。  
  
## <a name="how-items-are-associated"></a>アイテムを関連付ける方法  
 分析する個々のアイテムは、ケース、トランザクション、またはイベントごとにグループ化する必要があります。 したがって、顧客 ID 番号や製品 ID 番号ではなく、このトランザクション ID 列を識別子として選択します。  
  
 ツールで各トランザクション内の製品が調べられると、検出されたアイテムの組み合わせごとにアイテムセットが作成されます。 たとえば、顧客が 1 回の訪問で 3 つのアイテムを購入した場合は、7 つのアイテムセットが考えられます (それぞれの製品、別の製品とグループ化された各製品、および 3 つすべての製品の組み合わせ)。  
  
> [!NOTE]  
>  アイテムが 1 つしか含まれないアイテムセットは除外できますが、ツールでは、データ セットの意味のある統計を生成するために、このようなアイテムセットを分析する必要があります。  
  
 各アイテムセットのサポートは、アイテムセットを購入した顧客の数として計算されます。 上で示した例では、3 つのアイテムを購入した顧客が 1 人だけの場合、7 つのアイテムセットが考えられますが、その 7 つのアイテムセットのそれぞれのサポート値は 1 になります。 顧客の数や考えられる組み合わせの数が増えると、レポートの処理にかかる時間が長くなる可能性があります。 ただし、その中にはサポートが非常に小さいアイテムセットも含まれます。 したがって、レポートの生成にかかる時間を短縮するには、各アイテムセットのアイテム数を 3 つ以下に制限します。 一般的に、アイテムセットが大きくなるとサポートが少なくなるので、このトレードオフは妥当です。  
  
## <a name="specifying-minimum-support-and-rule-probability"></a>最小のサポートとルールの最小確率の指定  
 データ セットが大きくなると、考えられるアイテム グループおよびルールが膨大な数になる可能性があります。 ただし、ツールによって出力される結果の数を制御して、最も重要なアイテムセットおよびルールだけに絞り込むことができます。 これらのオプションを設定する、**買い物かご高度なパラメーター ダイアログ ボックス**します。  
  
### <a name="minimum-support"></a>最小のサポート  
 *最小のサポート*重要と見なされるアイテム セットの特定のアイテム セットを含める必要があるトランザクションの数を意味します。 たとえば、10 個以上の異なるトランザクションで購入されているアイテムセット以外には関心がない場合があります。 アイテム セットの有意性のしきい値を制御する 2 つの方法があり、両方を使用して、**最小のサポート**パラメーター。  
  
 **絶対値で指定します。** ターゲット項目を含むトランザクションの数を表す数値を入力します。 たとえば「10」と入力すると、10 個以上の買い物かごに表示されたすべてのアイテムセットが結果に含まれます。  
  
 **パーセンテージとして。** アイテム セットのコレクション全体の割合を表す数値を入力します。 たとえば「10」と指定すると、すべてのアイテムセットがカウントされ、そのアイテムセットの合計数の 10% 以上が対象のアイテムセットで構成されることになります。 大規模なデータセットがある場合は、パーセンテージを使用して、数ではなくできます最も重要な項目グループに注目します。  
  
> [!NOTE]  
>  アイテムセット数は、データ内のトランザクション数とは異なります。 各トランザクションには複数のアイテムセットが含まれる場合があります。ただし、ほとんどのアイテムセットは、データ セット全体で複数回繰り返し検出されます。  
  
### <a name="rule-probability-and-rule-importance"></a>ルールの確率と重要度  
 ルールの確率は、そのルールが実際に発生する可能性を示します。 ルールの確率は、ルールをサポートするアイテムセットの頻度を使用して計算されます。 アイテムセットの発生頻度が非常に低い場合、そのアイテムセットの確率は低くなります。  
  
 ただし、確率が高いルールが必ずしも有用であるとは限りません。 購入される頻度が高いためにプロモーションを追加する必要がないことを示している場合もあります。 重要度では、ルールの有用性が測定されます。 予測によって新しい情報は提供されないため、ルールの確率が非常に高くてもその重要度は低い場合があります。 たとえば、すべてのアイテムセットに特定の状態の属性が含まれている場合、確率が非常に高くても、その状態を予測するルールはあまり意味がありません。  
  
 これらの設定を試して結果の違いを確認し、最も興味深いルールが生成される設定を特定するようにしてください。  
  
## <a name="understanding-the-reports"></a>レポートを理解します。  
 **買い物かご分析**ツールは、2 つの補完的なレポートを作成します。 最初のレポートでは、「**大きなグループの項目分析中に識別**、検出されたすべてのアイテム セットの一覧を示します。 Microsoft Excel の新しいテーブル ツールを使用して、データの並べ替え、フィルター処理、および調査を実行できます。  
  
 2 番目のレポートでは、「**買い物かごルール**、どのような推測上に作成できるに基づいてアイテム セットの最初のレポートに表示されているかがわかります。 データを調べて理解するにはアイテムセットの一覧の方が便利ですが、予測や提案を行うにはルールの一覧の方が便利です。  
  
### <a name="shopping-basket-item-groups-report"></a>買い物かごアイテム グループ レポート  
 このレポートには、データ セットで検出されたアイテムに関して、有効なすべての組み合わせの一覧が示されます。 たとえば、トランザクション データには、注文ごとの注文が含まれている場合、**買い物かご分析**ツールは、個々 の項目が注文したし、そのアイテムとその他の項目のすべての組み合わせを計算の数の時間を計算します。  
  
 このレポートには、検出されたアイテムセットがリフト順に示されます。 リフトは、アイテムセットの重要度を示すスコアです。  
  
|レポート内の列|内容|  
|----------------------|-----------------------|  
|アイテム グループ|アイテムセット (アイテムの組み合わせ) を一覧表示します。|  
|グループ サイズ|アイテムセット内のアイテム数。 このフィールドでフィルター処理を行い、アイテムのペアだけの表示や単一のアイテムだけの表示などを実行できます。|  
|サポート|この組み合わせが検出されたケースの数。 この列を基準にして並べ替えを行い、最も一般的なアイテムセットを表示できます。|  
|平均値|このアイテムセット内のアイテムの価値合計をサポートで除算した値。 この列で並べ替えおよびフィルター処理を行い、さまざまな価格帯の製品を対象にすることができます。|  
|買い物かごの平均値|このアイテムセットを含む注文内にあるすべてのアイテムの価値合計をサポートで除算した値。 この統計は、アイテムセットの平均値と組み合わせて使用すると興味深い情報が得られます。|  
|リフト|データ セット全体におけるこのアイテムセットの有意性を表すスコア。 リフトは、2 つのアイテムが同時に検出される確率を取得し、2 つのアイテムが個別に検出される確率で除算することによって計算されます。 結果として、アイテム間の相関関係が密接な場合、リフト スコアは高くなります。|  
  
### <a name="shopping-basket-rules-report"></a>買い物かごルール レポート  
 このレポートには、検出されたアイテムセットを分析することで作成された一連のルールが示されます。 たとえば、製品 A および B が併せて購入される頻度が高いことがトランザクション データからわかった場合は、A が検出されると B が存在する、または B が検出されると A が存在することを予測するルールが買い物かご分析ツールによって作成されます。  
  
 各ルールは、サポート データから得られる確率に関連付けられます。 このような確率は、特定のアイテムを提案する場合などに有用です。 たとえば、既存のデータに基づいて、50% 以上の精度の確率のルールのみを表示できます。  
  
 このレポートには、検出されたアイテムセットがリフト順に示されます。 リフトは、アイテムセットの重要度を示すスコアです。  
  
|レポート内の列|内容|  
|----------------------|-----------------------|  
|既存のアイテム|提案を行うために必要なアイテムを一覧表示します。<br /><br /> データ マイニングでこれらの項目が上にあると言います、*左側*アソシエーション ルールの。|  
|予測されるアイテム|提案するアイテムを一覧表示します。<br /><br /> データ マイニングでこれらの項目が上にあると言います、*右側にある*アソシエーション ルールの。|  
|確率|このルールが正しいかどうかの確率を表示します。|  
|サポート|このルールの根拠となる既存のデータ内のケースの数を示します。|  
|ルールの価値|買い物かごのアイテムの価値を指定した場合は、この列で、アイテムのコストを前提とした予測の価値が計算されます。|  
|リフト|1 列目のアイテムと 2 列目のアイテム間の相関関係の強さを示します。 呼ば*重要度*します。<br /><br /> リフトが 0 の場合、相関関係はありません。 正の値の場合は、1 列目のアイテムによって 2 列目のアイテムが予測されます。 数値が大きいほど相関関係が強くなります。|  
  
## <a name="related-tools"></a>関連ツール  
 Excel 用のデータ マイニング クライアントは、より高度なデータ マイニング機能を備えた独立したアドインであり、アソシエーション分析を行うウィザードも用意されています。 詳細については、次を参照してください。[関連付けるウィザード&#40;Excel 用データ マイニング クライアント&#41;](associate-wizard-data-mining-client-for-excel.md)します。  
  
 この分析を行うために使用されるアルゴリズムの詳細については、SQL Server オンライン ブックの「Microsoft アソシエーション アルゴリズム」を参照してください。  
  
## <a name="see-also"></a>参照  
 [Excel 用テーブル分析ツール](table-analysis-tools-for-excel.md)  
  
  
