---
title: '[データベースのプロパティ] ([ミラーリング] ページ) | Microsoft Docs'
ms.custom: ''
ms.date: 08/25/2016
ms.prod: sql
ms.prod_service: database-engine
ms.reviewer: ''
ms.technology: configuration
ms.topic: conceptual
f1_keywords:
- sql13.swb.databaseproperties.mirroring.f1
ms.assetid: 5bdcd20f-532d-4ee6-b2c7-18dbb7584a87
author: stevestein
ms.author: sstein
ms.openlocfilehash: a25b2b40b147cd0bd23e8c7554e548b6a577d539
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/15/2019
ms.locfileid: "68099590"
---
# <a name="database-properties-mirroring-page"></a>[データベースのプロパティ] \([ミラーリング] ページ)
[!INCLUDE[appliesto-ss-xxxx-xxxx-xxx-md](../../includes/appliesto-ss-xxxx-xxxx-xxx-md.md)]
  このページにはプリンシパル データベースからアクセスし、データベース ミラーリングのプロパティを構成および変更します。 また、データベース ミラーリング セキュリティ構成ウィザードを起動し、ミラーリング セッションの状態の確認やデータベース ミラーリング セッションの一時停止または削除を行うこともできます。  
  
> **重要!!!** ミラーリングを開始する前に、セキュリティを構成しておく必要があります。 ミラーリングが開始されていない場合、このウィザードを使用して開始する必要があります。 ウィザードが終了するまで、 **[ミラーリング]** ページのテキスト ボックスは使用できません。  
  
 **SQL Server Management Studio を使用してデータベース ミラーリングを構成する**  
  
-   [Windows 認証を使用してデータベース ミラーリング セッションを確立する &#40;SQL Server Management Studio&#41;](../../database-engine/database-mirroring/establish-database-mirroring-session-windows-authentication.md)  
  
## <a name="options"></a>オプション  
 **[セキュリティの構成]**  
 このボタンをクリックすると、 **データベース ミラーリング セキュリティ構成ウィザード**が起動します。  
  
 ウィザードが正常に完了すると、ミラーリングが既に開始されているかどうかに応じて、次の動作が行われます。  
  
|||  
|-|-|  
|ミラーリングがまだ開始されていない場合|プロパティ ページは、その接続の情報をキャッシュします。また、ミラー データベースにパートナーのプロパティ セットが収められているかどうかを示す値もキャッシュされます。<br /><br /> ウィザードの最後に、既定のサーバー ネットワーク アドレスと動作モードを使用したデータベース ミラーリングを開始するように要求されます。 アドレスまたは動作モードを変更する場合は、 **[ミラーリングを開始しない]** をクリックします。|  
|ミラーリングが開始されている場合|ウィザードでミラーリング監視サーバーの構成が変更された場合、それに従って設定されます。|  
  
 **[サーバー ネットワーク アドレス]**  
 各サーバー インスタンスには、 **[プリンシパル]** 、 **[ミラー]** 、 **[ミラーリング監視]** という同等のオプションがあります。  
  
 サーバー インスタンスのサーバー ネットワーク アドレスは、データベース ミラーリング セキュリティ構成ウィザードを完了する際に自動的に指定されます。 ウィザードの完了後、必要に応じてネットワーク アドレスを手動で変更できます。  
  
 サーバー ネットワーク アドレスの基本構文を次に示します。  
  
 TCP **://** _fully_qualified_domain_name_ **:** _port_  
  
 パラメーターの説明  
  
-   *fully_qualified_domain_name* は、サーバー インスタンスが存在するサーバーです。  
  
-   *port* は、サーバー インスタンスのデータベース ミラーリング エンドポイントに割り当てられるポートです。  
  
     サーバーがデータベース ミラーリングに参加するには、データベース ミラーリング エンドポイントが必要になります。 データベース ミラーリング セキュリティ構成ウィザードを使用してサーバー インスタンスに対して最初のミラーリング セッションを確立した場合は、このウィザードによってエンドポイントが自動的に作成され、Windows 認証で使用するように構成されます。 証明書ベースの認証でウィザードを使用する方法の詳細については、「 [Windows 認証を使用してデータベース ミラーリング セッションを確立する &#40;SQL Server Management Studio&#41;](../../database-engine/database-mirroring/establish-database-mirroring-session-windows-authentication.md)をクリックします。  
  
    >**重要!!**  各サーバー インスタンスに必要となるデータベース ミラーリング エンドポイントは、サポートされるミラーリング セッションの数に関係なく、1 つのみです。  
  
 たとえば、 `DBSERVER9` という名前のコンピューター システム上のサーバー インスタンスで、エンドポイントにポート `7022`を使用する場合、ネットワーク アドレスは次のようになります。  
  
```  
TCP://DBSERVER9.COMPANYINFO.ADVENTURE-WORKS.COM:7022  
```  
  
 詳細については、「 [サーバー ネットワーク アドレスの指定 &#40;データベース ミラーリング&#41;](../../database-engine/database-mirroring/specify-a-server-network-address-database-mirroring.md)を使用します。  
  
> **注:** データベース ミラーリング セッションの間は、プリンシパル サーバー インスタンスとミラー サーバー インスタンスを変更することはできません。ただし、ミラーリング監視サーバー インスタンスはセッション中でも変更できます。 詳細については、後の「解説」を参照してください。  
  
 **[ミラーリングの開始]**  
 次の条件がすべて満たされているときに、ここをクリックするとミラーリングが開始されます。  
  
-   ミラーリング データベースが存在している。  
  
     ミラーリングを開始するには、NORECOVERY を指定して最新の完全バックアップを復元し、ミラーリング データベースを作成しておく必要があります。さらに状況に応じて、プリンシパル データベースのログ バックアップをミラー サーバーに復元する必要があります。 詳細については、「 [ミラーリングのためのミラー データベースの準備 &#40;SQL Server&#41;](../../database-engine/database-mirroring/prepare-a-mirror-database-for-mirroring-sql-server.md)を使用します。  
  
-   プリンシパル サーバー インスタンスとミラー サーバー インスタンスの TCP アドレスが既に指定されている ( **[サーバー ネットワーク アドレス]** セクション)。  
  
-   動作モードが [自動フェールオーバーを伴う高い安全性 (同期)] に設定されている場合、ミラー サーバー インスタンスの TCP アドレスも指定されている。  
  
-   セキュリティが正しく構成されています。  
  
 **[ミラーリングの開始]** をクリックすると、セッションが開始されます。 データベース エンジンはミラーリング パートナーに自動的に接続し、ミラー サーバーが適切に構成されていることを確認した後、ミラーリング セッションの開始を試行します。 ミラーリングを開始すると、データベースを監視するためにジョブが作成されます。  
  
 **[一時停止]** または **[再開]**  
 データベース ミラーリング セッション中にセッションを一時停止するには、 **[一時停止]** をクリックします。 確認を求めるメッセージが表示されます。 **[はい]** をクリックすると、セッションが一時停止し、ボタンが **[再開]** に変わります。 セッションを再開するには、 **[再開]** をクリックします。  
  
 セッションを一時停止した場合の影響の詳細については、「 [データベース ミラーリングの一時停止と再開 &#40;SQL Server&#41;](../../database-engine/database-mirroring/pausing-and-resuming-database-mirroring-sql-server.md)をクリックします。  
  
> **重要!!** 強制的なサービスの後に、最初のプリンシパル サーバーが再接続されると、ミラーリングが中断します。 この状況でミラーリングを再開すると、元のプリンシパル サーバーのデータが失われる可能性があります。 データ損失の可能性への対処の詳細については、「 [データベース ミラーリング セッション中の役割の交代 &#40;SQL Server&#41;](../../database-engine/database-mirroring/role-switching-during-a-database-mirroring-session-sql-server.md)をクリックします。  
  
 **[ミラーリングの削除]**  
 プリンシパル サーバー インスタンスで、セッションを停止してデータベースからミラーリング構成を削除する場合にクリックします。 確認を求めるメッセージが表示されます。 **[はい]** をクリックすると、セッションが停止し、ミラーリングが解除されます。 データベース ミラーリングの削除による影響の詳細については、「 [データベース ミラーリングの削除 &#40;SQL Server&#41;](../../database-engine/database-mirroring/removing-database-mirroring-sql-server.md)をクリックします。  
  
> **注:** サーバー インスタンス上のミラー化されたデータベースが他に存在しない場合、監視ジョブが削除されます。  
  
 **[フェールオーバー]**  
 クリックすると、手動でプリンシパル データベースをミラーリング データベースにフェールオーバーします。  
  
> **注:** ミラーリング セッションが高パフォーマンス モードで動作している場合、手動のフェールオーバーはサポートされません。 手動でフェールオーバーを行うには、最初に動作モードを **[自動フェールオーバーを伴わない高い安全性 (同期)]** に変更する必要があります。 フェールオーバー完了後、新しいプリンシパル サーバー インスタンスで動作モードを **[高パフォーマンス (非同期)]** に戻すことができます。  
  
 確認を求めるメッセージが表示されます。 **[はい]** をクリックするとフェールオーバーが実行されます。 Windows 認証を使用してミラー サーバーに接続しようとすると、プリンシパル サーバーが開始されます。 Windows 認証が機能しない場合は、プリンシパル サーバーに **[サーバーへの接続]** ダイアログ ボックスが表示されます。 ミラー サーバーで [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 認証を使用する場合は、 **[認証]** ボックスで **[SQL Server 認証]** を選択します。 **[ログイン]** テキスト ボックスで、ミラー サーバー上で接続するログイン アカウントを指定し、 **[パスワード]** テキスト ボックスで、そのアカウントのパスワードを指定します。  
  
 フェールオーバーに成功すると、 **[データベースのプロパティ]** ダイアログ ボックスが閉じます。 プリンシパル サーバー ロールとミラー サーバー ロールが切り替わります。つまり、以前のミラー データベースがプリンシパル データベースとなり、以前のプリンシパル データベースがミラー データベースとなります。 その直後から、前のプリンシパル データベースの **[データベースのプロパティ]** ダイアログ ボックスは使用できなくなります。これは、このデータベースがミラー データベースになるためです。フェールオーバーの後、このダイアログ ボックスは新しいプリンシパル データベースで使用できるようになります。  
  
 フェールオーバーに失敗すると、エラー メッセージが表示され、ダイアログ ボックスは開いたままになります。  
  
> **重要!!** **[データベースのプロパティ]** ダイアログ ボックスでプロパティを変更した後に **[フェールオーバー]** をクリックすると、その変更は失われます。 現在の変更を保存するには、確認メッセージで **[いいえ]** をクリックし、 **[OK]** をクリックして変更を保存します。 その後で [データベースのプロパティ] ダイアログ ボックスを再び開き、 **[フェールオーバー]** をクリックします。  
  
 **動作モード**  
 必要に応じて、動作モードを変更します。 一部の動作モードは、ミラーリング監視サーバーの TCP アドレスを指定すると使用できるようになります。 次のオプションがあります。  
  
|オプション|ミラーリング監視サーバー|説明|  
|------------|--------------|-----------------|  
|**[高パフォーマンス (非同期)]**|Null (存在しても使用されませんが、セッションにクォーラムが必要になります)|最適なパフォーマンスを提供するために、ミラー データベースが常にプリンシパル データベースから多少遅延されます。完全に時間差がなくなることはありません。 ただし、データベース間の時間差は、通常はわずかです。 パートナーの損失による影響は次のとおりです。<br /><br /> ミラー サーバー インスタンスが使用できなくなった場合は、引き続きプリンシパル サーバー インスタンスが使用されます。<br /><br /> プリンシパル サーバー インスタンスが使用できなくなった場合は、ミラーリングが停止します。 しかし、推奨されているようにセッションでミラーリング監視サーバーを使用していないか、またはミラーリング監視サーバーがミラー サーバーに接続している場合、ウォーム スタンバイ状態としてミラー サーバーにアクセスできます。データベースの所有者は、ミラー サーバー インスタンスへのサービスを強制的に実行できます (データ損失が発生する可能性があります)。|  
|**[自動フェールオーバーを伴わない高い安全性 (同期)]**|いいえ|コミットされているすべてのトランザクションは、ミラー サーバー上のディスクに書き込まれることが保証されています。<br /><br /> パートナーが互いに接続されていれば、手動フェールオーバーが可能です。<br /><br /> パートナーの損失による影響は次のとおりです。<br /><br /> ミラー サーバー インスタンスが使用できなくなった場合は、引き続きプリンシパル サーバー インスタンスが使用されます。<br /><br /> プリンシパル サーバー インスタンスが使用できなくなると、ミラー サーバー インスタンスは停止しますが、ウォーム スタンバイ状態となり、使用可能です。データベースの所有者は、ミラー サーバー インスタンスへのサービスを強制的に実行できます (データ損失が発生する可能性があります)。|  
|**[自動フェールオーバーを伴う高い安全性 (同期)]**|指定あり (必須)|自動フェールオーバーをサポートするミラーリング監視サーバー インスタンスを含めることで、可用性を最大限に高めます。 **[自動フェールオーバーを伴う高い安全性 (同期)]** オプションを選択できるのは、最初にミラーリング監視サーバーのアドレスを指定した場合のみです。<br /><br /> パートナーが互いに接続されていれば、手動フェールオーバーが可能です。<br /><br /> **&#42;&#42; 重要 &#42;&#42;** ミラーリング監視サーバーが切断された場合、データベースを使用できるようにするには、パートナーが相互に接続されている必要があります。 詳細については、「[クォーラム: データベースの可用性にミラーリング監視サーバーが与える影響 (データベース ミラーリング)](../../database-engine/database-mirroring/quorum-how-a-witness-affects-database-availability-database-mirroring.md)」を参照してください。<br /><br /> 同期動作モードの場合、コミット済みのトランザクションがすべてミラー サーバーのディスクに書き込まれることが保証されます。 ミラーリング監視サーバーが存在する場合、パートナーの損失による影響は次のとおりです。<br /><br /> プリンシパル サーバー インスタンスが使用できなくなった場合、自動フェールオーバーが発生します。 ミラー サーバー インスタンスはプリンシパル サーバー インスタンスの役割に切り替わり、ミラー データベースがプリンシパル データベースとして提供されます。<br /><br /> ミラー サーバー インスタンスが使用できなくなった場合は、引き続きプリンシパル サーバー インスタンスが使用されます。<br /><br /> <br /><br /> 詳しくは、「 [Database Mirroring Operating Modes](../../database-engine/database-mirroring/database-mirroring-operating-modes.md)」をご覧ください。|  
  
 ミラーリングが開始された後でも、動作モードを変更して **[OK]** をクリックすることで変更を保存できます。  
  
 動作モードの詳細については、「 [データベース ミラーリングの動作モード](../../database-engine/database-mirroring/database-mirroring-operating-modes.md)」を参照してください。  
  
 **ステータス**  
 ミラーリングが開始された後、 **[状態]** パネルには **[ミラーリング]** ページを選択したときのデータベース ミラーリング セッションの状態が表示されます。 **[状態]** パネルを更新するには、 **[最新の情報に更新]** ボタンをクリックします。 表示される状態は次のとおりです。  
  
|状態|説明|  
|------------|-----------------|  
|**[データベースはミラーリング用に構成されていません]**|データベース ミラーリング セッションが存在せず、 **[ミラーリング]** ページに表示する動作情報がありません。|  
|**一時停止**|プリンシパル データベースは使用できますが、ミラー サーバーにログを送信していません。|  
|**[接続なし]**|プリンシパル サーバー インスタンスがパートナーに接続できません。|  
|**[同期中]**|ミラー データベースの内容が、プリンシパル データベースの内容に遅れています。 プリンシパル サーバー インスタンスからミラー サーバー インスタンスにログ レコードを送信して、ミラー データベースを更新するための変更を適用しています。<br /><br /> データベース ミラーリング セッションの開始時には、ミラー データベースとプリンシパル データベースはこの状態です。|  
|**[フェールオーバー]**|プリンシパル サーバー インスタンス上で手動のフェールオーバー (ロールの交代) が開始され、サーバーは現在ミラーのロールに移行中です。 この状態では、プリンシパル データベースへのユーザー接続がすばやく終了し、その後すぐにデータベースがミラーのロールを引き継ぎます。|  
|**同期済み**|ミラー サーバーがプリンシパル サーバーとの遅延を解消すると、データベースの状態が **[同期済み]** になります。 プリンシパル サーバーがミラー サーバーに変更を送信し、ミラー サーバーがミラー データベースに変更を適用する、という処理が継続されている限り、データベースはこの状態のままです。<br /><br /> 高い安全性モードを使用すると、データ損失を伴わないフェールオーバーを実行できます。<br /><br /> 高パフォーマンス モードの場合、 **[同期済み]** 状態でも、一部のデータが損失する可能性は常にあります。|  
  
 詳細については、「[ミラーリング状態 &#40;SQL Server&#41;](../../database-engine/database-mirroring/mirroring-states-sql-server.md)」を参照してください。  
  
 **[更新]**  
 クリックすると、 **[状態]** ボックスが更新されます。  
  
## <a name="remarks"></a>Remarks  
 データベース ミラーリングについて詳しく理解していない場合は、「 [データベース ミラーリング &#40;SQL Server&#41;](../../database-engine/database-mirroring/database-mirroring-sql-server.md)をクリックします。  
  
### <a name="adding-a-witness-to-an-existing-session"></a>既存のセッションへのミラーリング監視の追加  
 ミラーリング監視を既存のセッションに追加するか、または既存のミラーリング監視を置き換えることができます。 ミラーリング監視のサーバー ネットワーク アドレスがわかっている場合、 **[ミラーリング監視]** フィールドに手動でサーバー ネットワーク アドレスを入力できます。 ミラーリング監視のサーバー ネットワーク アドレスがわからない場合、データベース ミラーリング セキュリティ構成ウィザードを使用して、ミラーリング監視を構成します。 アドレスをフィールドに入力した後、 **[自動フェールオーバーを伴う高い安全性 (同期)]** オプションが選択されていることを確認します。  
  
 新しいミラーリング監視を構成した後、 **[OK]** をクリックして、新しいミラーリング監視をミラーリング セッションに追加する必要があります。  
  
 **Windows 認証を使用する場合にミラーリング監視を追加するには**  
  
 [データベース ミラーリング監視サーバーを追加または置き換える方法 &#40;SQL Server Management Studio&#41;](../../database-engine/database-mirroring/add-or-replace-a-database-mirroring-witness-sql-server-management-studio.md)  
  
### <a name="removing-a-witness"></a>ミラーリング監視の削除  
 ミラーリング監視を削除するには、 **[ミラーリング監視]** フィールドからそのサーバー ネットワーク アドレスを削除します。 自動フェールオーバーを伴う高い安全性モードから高パフォーマンス モードに切り替えると、 **[ミラーリング監視]** フィールドの内容は自動的に消去されます。  
  
 ミラーリング監視を削除した後、 **[OK]** をクリックして、ミラーリング監視をミラーリング セッションから削除する必要があります。  
  
### <a name="monitoring-database-mirroring"></a>データベース ミラーリングの監視  
 サーバー インスタンス上のミラー化されたデータベースを監視する場合、データベース ミラーリング モニターまたは sp_dbmmonitorresults システム ストアド プロシージャを使用できます。  
  
 **ミラー化されたデータベースを監視するには**  
  
-   [データベース ミラーリング モニターの起動 &#40;SQL Server Management Studio&#41;](../../database-engine/database-mirroring/start-database-mirroring-monitor-sql-server-management-studio.md)  
  
-   [sp_dbmmonitorresults &#40;Transact-SQL&#41;](../../relational-databases/system-stored-procedures/sp-dbmmonitorresults-transact-sql.md)  
  
 詳細については、「 [データベース ミラーリングの監視 &#40;SQL Server&#41;](../../database-engine/database-mirroring/monitoring-database-mirroring-sql-server.md)をクリックします。  
  
##  <a name="RelatedTasks"></a> 関連タスク  
  
-   [サーバー ネットワーク アドレスの指定 &#40;データベース ミラーリング&#41;](../../database-engine/database-mirroring/specify-a-server-network-address-database-mirroring.md)  
  
-   [Windows 認証を使用してデータベース ミラーリング セッションを確立する &#40;SQL Server Management Studio&#41;](../../database-engine/database-mirroring/establish-database-mirroring-session-windows-authentication.md)  
  
-   [データベース ミラーリング モニターの起動 &#40;SQL Server Management Studio&#41;](../../database-engine/database-mirroring/start-database-mirroring-monitor-sql-server-management-studio.md)  
  
## <a name="see-also"></a>参照  
 [データベース ミラーリングと AlwaysOn 可用性グループのトランスポート セキュリティ &#40;SQL Server&#41;](../../database-engine/database-mirroring/transport-security-database-mirroring-always-on-availability.md)   
 [データベース ミラーリング セッション中の役割の交代 &#40;SQL Server&#41;](../../database-engine/database-mirroring/role-switching-during-a-database-mirroring-session-sql-server.md)   
 [データベース ミラーリングの監視 &#40;SQL Server&#41;](../../database-engine/database-mirroring/monitoring-database-mirroring-sql-server.md)   
 [データベース ミラーリング &#40;SQL Server&#41;](../../database-engine/database-mirroring/database-mirroring-sql-server.md)   
 [データベース ミラーリングの一時停止と再開 &#40;SQL Server&#41;](../../database-engine/database-mirroring/pausing-and-resuming-database-mirroring-sql-server.md)   
 [データベース ミラーリングの削除 &#40;SQL Server&#41;](../../database-engine/database-mirroring/removing-database-mirroring-sql-server.md)   
 [データベース ミラーリング監視サーバー](../../database-engine/database-mirroring/database-mirroring-witness.md)  
  
  
