---
title: INDEX コマンド |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- index command [ODBC]
ms.assetid: 694e8cf5-2f69-4001-9c1e-b735a4da3aff
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 61e55bec7a35009f0d83a43550a434e0966559b4
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/15/2019
ms.locfileid: "68019467"
---
# <a name="index-command"></a>INDEX コマンド
インデックス ファイルを表示し、論理的な順序でテーブルのレコードへのアクセスを作成します。  
  
## <a name="syntax"></a>構文  
  
```  
  
INDEX ON eExpression TO IDXFileName | TAG TagName [OF CDXFileName]  
   [FOR lExpression]  
   [COMPACT]  
   [ASCENDING | DESCENDING]  
   [UNIQUE | CANDIDATE]  
   [ADDITIVE]  
```  
  
## <a name="arguments"></a>引数  
 *eExpression*  
 フィールドまたは現在のテーブルからフィールドの名前を含めることができるインデックスの式を指定します。 テーブル内の各レコードのインデックス ファイルで、インデックスの式に基づくインデックス キーが作成されます。 Visual FoxPro では、これらのキーを使用して、表示し、テーブル内のレコードにアクセスします。  
  
> [!NOTE]  
>  推奨されませんが*eExpression*メモリ変数、配列要素、またはフィールドまたは別の作業領域内のテーブルからフィールド式こともできます。 インデックス ファイルの式でメモ フィールドは単独で使用できません。他の文字式と組み合わせる必要があります。 変数またはフィールドを不要になったが存在するか、存在することはできませんを含むインデックスにアクセスする場合、Visual FoxPro は、エラー メッセージを生成します。  
  
 長さが変化するキーを使用してインデックスを作成しようとした場合は、スペースを含む、キーが埋め込まれます。 可変長のインデックス キーは、Visual FoxPro でサポートされていません。  
  
 長さが 0 で、インデックス キーを作成することになります。 たとえば、インデックス式が空のフィールドの部分文字列の場合、長さゼロ インデックス キーが作成されます。 長さゼロ インデックス キーには、エラー メッセージが生成されます。 Visual FoxPro は、インデックスを作成するときは、テーブル内の最初のレコードのフィールドを評価します。 フィールドが空の場合は、長さ 0 のインデックス キーを防ぐために最初のレコードのフィールドに一時的なデータの一部を入力する必要があります。  
  
 *IDXFileName*  
 .Idx インデックス ファイルを作成します。 インデックス ファイルには、既定の拡張機能 .idx が与えられます。  
  
 タグ*TagName*[OF *CDXFileName*]  
 複合インデックス ファイルを作成します。 複合インデックスのファイルは、任意の数の個別のタグ (インデックス エントリ) で構成される 1 つのインデックス ファイルです。 各タグは、その一意のタグ名によって識別されます。 タグの名前は文字またはアンダー スコアで始める必要があり、最大 10 個の文字、数字、またはアンダー スコアの任意の組み合わせで構成できます。 複合インデックス ファイルのタグの数は、使用可能なメモリとディスク容量によってのみ制限されます。  
  
 複合インデックスを複数エントリ ファイルは、コンパクトでは常にです。 複合インデックス ファイルを作成するときに、最適化を含める必要はありません。 複合インデックス ファイルの名前には、.cdx 拡張機能が与えられます。  
  
 複合インデックス ファイルの 2 つの種類を作成できます。 構造的および非構造的な。  
  
 **複合構造のインデックス ファイル**構造型の複合インデックス ファイルを作成するにはタグを持つ*TagName*オプションを除外することで*CDXFileName*句。 複合インデックスの構造上のファイルは常にテーブルと同じ基本名を持つし、テーブルを開いたときに自動的に開かれます。  
  
 **複合インデックス ファイルを非構造的な**複合インデックスを非構造的なファイルを作成するには、 *CDXFileName*タグの後*TagName*します。 構造型の複合インデックス ファイルとは異なり複合インデックスを非構造的なファイルを開く必要があります明示的に使用 INDEX 句を。  
  
 複合インデックスのファイルは既に作成されていて開く、発行のタグを持つインデックス*TagName*複合インデックスのファイルにタグを追加します。  
  
 *LExpression*  
 これにより、条件を指定しますフィルター式を満たすレコードだけ*lExpression*表示とアクセスです。 使用可能なフィルター式に一致するには、これらのレコードのインデックス ファイルのインデックス キーが作成されます。  
  
 Visual FoxPro Rushmore テクノロジは、インデックスを最適化しています.*LExpression*コマンド*lExpression*最適化可能な式を指定します。 最適なパフォーマンスを最適化の式を使用して、FOR 句でします。  
  
 COMPACT  
 Compact .idx ファイルを作成します。  
  
 昇順  
 .Cdx ファイルの昇順を指定します。 既定では、.cdx タグは、昇順で作成されます。 (昇順は、インデックス ファイルの順序のアラームとして含めることができます)。テーブルは、降順を含めることによって逆の順序でインデックスことができます。  
  
 降順  
 降順 .cdx ファイルを指定します。 .Idx ファイルのインデックスを作成するときに、降順を含めることはできません。  
  
 UNIQUE  
 .Idx ファイルまたは .cdx タグで特定のインデックス キーの値で発生した最初のレコードのみが含まれることを指定します。 UNIQUE は、重複するレコードの表示またはアクセスを防ぐために使用できます。 重複するインデックスのキーを使用して追加のすべてのレコードは、インデックス ファイルから除外されます。 一意インデックスのオプションを使用することは、インデックスまたはインデックスの再作成を発行する前に SET UNIQUE ON を実行すると同じです。  
  
 一意のインデックスまたはインデックスのタグがアクティブであり、インデックス キーを変更する方法で重複したレコードが変更されたと、は、インデックスまたはインデックスのタグが更新されます。 ただし、元のインデックス キーを持つ次の重複するレコードをアクセスまたはインデックスの再作成を使用してファイルを再作成されるまで表示することはできません。  
  
 候補  
 候補構造のインデックスのタグを作成します。 インデックス構造タグ; を作成する場合にのみ、候補キーワードが含まれるできます。それ以外の場合、Visual FoxPro は、エラー メッセージを生成します。  
  
 候補インデックス タグ フィールドまたはインデックスの式で指定されたフィールドの組み合わせで、重複を防止する*eExpression*します。 用語*候補*がインデックスの型を表してプライマリ インデックス「候補」として修飾、候補となるインデックスが重複する値を防ぐためです。  
  
 Visual FoxPro は、フィールドまたは重複する値を既に含むフィールドの組み合わせの候補インデックス タグを作成する場合、エラーを生成します。  
  
 加法  
 保持は、すべてのインデックスの前に開かれたファイルを開きます。 インデックスを持つインデックス ファイルまたはテーブルのファイルを作成するときに、加法句を省略した場合 (構造体の複合インデックス) を除くすべてのインデックスの前に開かれたファイルは閉じられます。  
  
## <a name="remarks"></a>コメント  
 インデックス ファイルがあるテーブル内のレコードが表示され、インデックスの式で指定された順序でアクセスします。 テーブル内のレコードの物理的な順序は、インデックス ファイルが変更されていません。  
  
## <a name="index-types"></a>インデックスの種類  
 Visual FoxPro では、2 種類のインデックス ファイルを作成することができます。  
  
-   複合タグと呼ばれる複数のインデックス エントリを含む .cdx インデックス ファイル  
  
-   1 つのインデックス エントリを含む .idx インデックス ファイル  
  
 テーブルに自動的に開かれる構造体の複合インデックス ファイルを作成することもできます。  
  
> [!NOTE]  
>  構造型の複合インデックス ファイルは自動的に開かれるため、テーブルを開いたときに、これらは優先のインデックスの種類です。  
  
 Compact .idx ファイルのインデックスを作成する最適化が含まれます。 複合インデックスのファイルは、compact は常にです。  
  
## <a name="index-order-and-updating"></a>インデックスの順序と更新  
 1 つのみのインデックス ファイル (マスター インデックス ファイル) またはタグ (マスター タグ) は、テーブルが表示またはアクセスの順序を制御します。 特定のコマンド (たとえば、シーク) は、レコードを検索するマスター インデックス ファイルまたはタグを使用します。 ただし、すべての開いている .idx され、テーブルに変更が加えられると、.cdx インデックス ファイルは更新されます。  
  
## <a name="user-defined-functions"></a>ユーザー定義関数  
 インデックス式では、ユーザー定義関数を含めることができます、インデックスの式でユーザー定義関数を使用する必要がありますされません。 ユーザー定義関数は、インデックスの式では、作成またはインデックスの更新にかかる時間を増やします。 また、インデックスの更新は可能性があります、インデックスの式、ユーザー定義関数を使用する場合は発生しません。  
  
 インデックスの式で、ユーザー定義関数を使用する場合、Visual FoxPro は、ユーザー定義関数を検索できる必要があります。 Visual FoxPro は、インデックスを作成するときは、インデックスの式は、インデックス ファイルに保存されますが、インデックスの式で、ユーザー定義関数への参照のみが含まれています。  
  
## <a name="see-also"></a>関連項目  
 [ALTER TABLE - SQL コマンド](../../odbc/microsoft/alter-table-sql-command.md)   
 [DELETE TAG コマンド](../../odbc/microsoft/delete-tag-command.md)   
 [SET COLLATE コマンド](../../odbc/microsoft/set-collate-command.md)   
 [SET UNIQUE コマンド](../../odbc/microsoft/set-unique-command.md)
