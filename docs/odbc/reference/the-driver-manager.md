---
title: ドライバー マネージャー |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- driver manager [ODBC]
- ODBC architecture [ODBC], driver manager
- driver manager [ODBC], about driver manager
- ODBC driver manager [ODBC]
ms.assetid: 559e4de1-16c9-4998-94f5-6431122040cd
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 659678451c368df0b6a213e54cf7edaedfc29bd1
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/15/2019
ms.locfileid: "68039328"
---
# <a name="the-driver-manager"></a>ドライバー マネージャー
*ドライバー マネージャー*はアプリケーションとドライバーの間の通信を管理するライブラリです。 たとえば、Microsoft® Windows® プラットフォームをドライバー マネージャーがダイナミック リンク ライブラリ (DLL) は Microsoft によって書き込まれて、再頒布可能パッケージ、MDAC 2.8 SP1 SDK のユーザーによる再配布できます。  
  
 ドライバー マネージャーは、の利便性をアプリケーションの作成者として主に存在して、さまざまなすべてのアプリケーションに一般的な問題を解決します。 データ ソース名に基づいて、ロードするドライバーを決定する、読み込みとでは、ドライバーをアンロード、ドライバーで関数の呼び出しが含まれます。  
  
 なぜ、後者は、問題を表示するに行われる処理を検討してください、アプリケーションの関数から、ドライバーでの直接呼び出した場合です。 アプリケーションは、特定のドライバーに直接リンクされている、しない限り、そのドライバー内の関数へのポインターのテーブルを作成し、ポインターによってそれらの関数を呼び出す必要があります。 一度に 1 つ以上のドライバーの同じコードを使用して、もう 1 つのレベルの複雑さは追加します。 アプリケーションは最初に、適切なドライバーの適切な関数を指すように関数ポインターを設定する必要し、そのポインターを通じて関数を呼び出します。  
  
 ドライバー マネージャーは、各関数を呼び出す単一の場所を提供することで、この問題を解決します。 アプリケーションは、ドライバーではなくをドライバー マネージャーと呼び出しドライバー マネージャーで、ODBC 関数にリンクされます。 アプリケーションのターゲットのドライバーとデータ ソースを識別する、*接続ハンドル*します。 ドライバーが読み込まれると、ドライバー マネージャーは、ドライバー内の関数へのポインターのテーブルが構築されます。 ターゲットのドライバーで関数のアドレスを検索、アプリケーションによって渡された接続ハンドルを使用して、アドレスでその関数を呼び出します。  
  
 ほとんどの場合、ドライバー マネージャーは、適切なドライバーをアプリケーションからの関数呼び出しを渡すのみです。 ただし、一部の機能も実装 (**SQLDataSources**、 **SQLDrivers**、および**SQLGetFunctions**) し、基本的なエラー チェックを実行します。 たとえば、ハンドルは、正しい順序で関数を呼び出すことと、特定の関数の引数が有効である null ポインターではないドライバー マネージャーを確認します。 ドライバー マネージャーによって確認エラーの詳細については、各関数のリファレンス セクションを参照してくださいと[付録 b:ODBC の状態遷移テーブル](../../odbc/reference/appendixes/appendix-b-odbc-state-transition-tables.md)します。  
  
 ドライバー マネージャーの最終的な主要な役割は読み込みと、ドライバーをアンロードします。 アプリケーションでは、ロードし、ドライバー マネージャーのみをアンロードします。 接続関数を呼び出す特定のドライバーを使用する必要がある場合 (**SQLConnect**、 **SQLDriverConnect**、または**SQLBrowseConnect**) ドライバー マネージャーでを指定します特定のデータ ソースまたは「会計」や"Sqlserver"などのドライバーの名前 この名前を使用して、ドライバー マネージャーは、ドライバーのファイル名、Sqlsrvr.dll などのデータ ソース情報を検索します。 (まだ読み込まれていないと仮定) のドライバーがロード、driver では、各関数のアドレスを格納し、自体を初期化し、データ ソースに接続し、ドライバーの接続関数を呼び出します。  
  
 アプリケーションが終了すると、ドライバーを使用して呼び出す**SQLDisconnect**ドライバー マネージャーでします。 ドライバー マネージャーは、データ ソースから切断されると、ドライバーでこの関数を呼び出します。 ただし、ドライバー マネージャーは、アプリケーションがこれに再接続する場合に、メモリ内でドライバーを保持します。 その他の接続が、ドライバーを使用していないと、アプリケーション、ドライバーによって使用される接続を解放または別のドライバーの接続を使用している場合にのみ、ドライバーをアンロードします。 読み込みとアンロードのドライバーのドライバー マネージャーのロールの詳細については、次を参照してください。[接続処理でドライバー マネージャーの役割](../../odbc/reference/develop-app/driver-manager-s-role-in-the-connection-process.md)します。
