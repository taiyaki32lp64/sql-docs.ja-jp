---
title: 動的 SQL |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL [ODBC], embedded SQL
- SQL statements [ODBC], dynamic SQL
- SQL statements [ODBC], embedded SQL
- dynamic SQL [ODBC]
- SQL [ODBC], dynamic SQL
- embedded SQL [ODBC]
ms.assetid: 0bfb9ab7-9c15-4433-93bc-bad8b6c9d287
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 131abdd4a401e336ccd78ca79fdf6666b1911fee
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/15/2019
ms.locfileid: "67915454"
---
# <a name="dynamic-sql"></a>動的 SQL
静的 SQL も多くの状況で動作しますが、クラスがあるアプリケーションをデータ アクセスを事前に決定することはできません。 たとえば、スプレッドシートでスプレッドシートは、DBMS にデータを取得する送信は、クエリを入力するユーザーができるようにします。 このクエリの内容をスプレッドシート プログラムが書き込まれるときに明らかに、プログラマが認識されることはできません。  
  
 この問題を解決するためには、スプレッドシートは、動的 SQL と呼ばれる embedded SQL の形式を使用します。 静的な SQL ステートメントでは、プログラムにハードコードされてとは異なり動的 SQL ステートメントを実行時に構築され、文字列のホスト変数内に配置することができます。 処理のため、dbms、送信されます。 DBMS は、動的 SQL ステートメントの実行時に、アクセス プランを生成する必要があります、ため、動的 SQL は一般的に、静的 SQL よりも低速です。 動的 SQL ステートメントを含むプログラムがコンパイルされると、動的 SQL ステートメントは、静的 SQL のように、プログラムからは除去されません。 代わりに、ステートメントを DBMS; に渡される関数呼び出しに置き換えられます通常、同じプログラム内で静的な SQL ステートメントが処理されます。  
  
 動的 SQL ステートメントを実行する最も簡単な方法では、即時実行のステートメントを使用します。 このステートメントは、SQL ステートメントをコンパイルおよび実行の DBMS に渡します。  
  
 即時実行ステートメントの 1 つの欠点は、SQL ステートメント、ステートメントが実行されるたびに処理の 5 つの手順の各 DBMS を移動する必要があることです。 多くのステートメントが動的に実行され、これらのステートメントのような場合は無駄だ場合に、このプロセスに関連するオーバーヘッドは大幅にできます。 このような状況に対処するには、動的 SQL は、次の手順を使用して、準備実行と呼ばれる実行の最適化された形を提供します。  
  
1.  プログラムは、即時実行ステートメントの場合と同様のバッファーで、SQL ステートメントを構築します。 ホストの変数の代わりに疑問符 (?) を任意の場所を示す定数の値が後で指定されるステートメントのテキスト内の定数に置き換えることができます。 パラメーター マーカーとして疑問符 () と呼びます。  
  
2.  プログラムでは、SQL ステートメントをよう計画すること、DBMS 解析、検証、およびステートメントを最適化および実行を生成する要求、準備のステートメントを使用して、DBMS に渡します。 プログラムは、EXECUTE ステートメント (即時実行ステートメントされません) を使用して後で準備のステートメントを実行します。 SQL データ領域または SQLDA と呼ばれる特殊なデータ構造でステートメントのパラメーターの値が渡されます。  
  
3.  プログラムは、動的ステートメントが実行されるたびに異なるパラメーター値を指定して、EXECUTE ステートメントを繰り返し使用できます。  
  
 準備実行がない静的 SQL と同じです。 静的 SQL の場合で SQL ステートメントの処理の最初の 4 つの手順はコンパイル時に行われます。 準備実行で、次の手順も実行、実行時に 1 回だけ実行されるが、プランの実行は、EXECUTE が呼び出されたときにのみ行われます。 これにより、動的 SQL のアーキテクチャに固有のパフォーマンスの欠点の一部を排除できます。 次の図は、静的 SQL、即時実行は、動的 SQL と準備実行での動的 SQL の違いを示します。
