---
title: 状態遷移 |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- state transitions [ODBC]
- unallocated state [ODBC]
- handles [ODBC], state transitions
- allocated state [ODBC]
- connection state [ODBC]
ms.assetid: fc741611-6535-43cc-8156-6d897d04664e
author: MightyPen
ms.author: genemi
ms.openlocfilehash: d2512d277980b071523cfea6cbe132f2a3861b7d
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/15/2019
ms.locfileid: "68107290"
---
# <a name="state-transitions"></a>状態遷移
ODBC 定義不連続*状態*環境はそれぞれ、接続ごとに、および各ステートメント。 たとえば、環境では、3 つの状態があります。(この環境が割り当てられていない) 内の未割り当て (を環境が割り当てられますが、接続が割り当てられていません) を割り当て、および接続 (この環境と 1 つまたは複数の接続が割り当てられます)。 接続がある 7 つの可能な状態です。ステートメントでは、13 の可能な状態があります。  
  
 特定の項目、ハンドルによって識別される 1 つの状態から別に移動するとき、アプリケーションが特定の関数または関数を呼び出すし、その項目へのハンドルを渡します。 このような動きと呼ばれる、*状態*します。 たとえば、使用環境ハンドルの割り当て**SQLAllocHandle**未割り当てから割り当てられているとでは、そのハンドルを解放することに、環境を移動します**SQLFreeHandle**に割り当て済みからそれを返します。未割り当てです。 ODBC は、特定の順序で関数を呼び出す必要がありますの別の方法が有効な状態遷移の数に制限を定義します。  
  
 などのいくつかの関数**SQLGetConnectAttr**、すべての状態は影響しません。 その他の関数では、1 つの項目の状態に影響します。 たとえば、 **SQLDisconnect**接続状態からの接続が割り当てられている状態に移動します。 最後に、一部の関数では、1 つ以上の項目の状態に影響します。 接続ハンドルの割り当てなど、 **SQLAllocHandle**割り当て済みの状態に、未割り当てから接続を移動し、接続状態を割り当て済みから環境に移動します。  
  
 かどうか、アプリケーションが正しくない順序関数を呼び出す関数を返します、*状態遷移エラー*します。 たとえば、環境が接続状態と、アプリケーションでは呼び出し**SQLFreeHandle**その環境ハンドルを持つ**SQLFreeHandle** SQLSTATE HY010 を返します (関数のシーケンス エラーです)環境、割り当てられている状態にある場合にのみ呼び出すことができます。 無効な状態遷移としては、これを定義、ODBC は、アプリケーションがアクティブな接続があるときに、環境を解放できないようにします。  
  
 いくつかの状態遷移は、ODBC のデザインに固有です。 たとえば、接続ハンドルの割り当てを関数には、環境ハンドルが必要なため、最初に、環境ハンドルを割り当てずに接続ハンドルを割り当てることはできません。 その他の状態遷移は、ドライバー マネージャーと、ドライバーによって適用されます。 たとえば、 **SQLExecute**準備されたステートメントを実行します。 準備された状態でない場合に、ステートメント ハンドルが渡される**SQLExecute** SQLSTATE HY010 を返します (関数のシーケンス エラーです)。  
  
 アプリケーションの観点からは、状態遷移は、通常は簡単です。有効な状態遷移が手に密接に連携を移動する傾向がありますを適切に記述されたアプリケーションのフロー。 状態遷移は、環境、接続ごとに、各ステートメントの状態を追跡する必要がありますので、ドライバー マネージャーと、ドライバーのより複雑です。 この作業の大半には、ドライバー マネージャーによってが行われるドライバーで行う必要がある作業のほとんどは、保留中の結果をステートメントで発生します。  
  
 このマニュアルの 1 と 2 の部分 (「ODBC の概要」と「アプリケーションとドライバーの開発」) に明示的に状態遷移を言うまでもなく傾向があります。 代わりに、順序関数を呼び出す必要があります、について説明します。 たとえば、「ステートメントの実行」の状態でステートメントを準備する必要があります**SQLPrepare**をで実行する前に**SQLExecute**します。 状態と状態遷移、遷移には、ドライバー マネージャーによってがチェックされ、ドライバーによってをチェックする必要がありますを含む完全な説明については、次を参照してください[付録 b:。ODBC の状態遷移テーブル](../../../odbc/reference/appendixes/appendix-b-odbc-state-transition-tables.md)します。
