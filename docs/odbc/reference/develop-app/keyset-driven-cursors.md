---
title: キーセット ドリブン カーソル |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- keyset-driven cursors [ODBC]
- cursors [ODBC], key-set driven
ms.assetid: 01769f43-1d9c-4685-84fa-15a6465335e9
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 0c40fe8c823115c3131a1719185bce8f1506df81
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/15/2019
ms.locfileid: "68138839"
---
# <a name="keyset-driven-cursors"></a>キーセット ドリブン カーソル
静的および動的カーソルのキーセット ドリブン カーソルでは変更を検出するには、その機能にあります。 静的カーソルと同様に、結果セットのメンバーシップと順序に対する変更は常に検出されません。 動的カーソルの場合のような結果 (SQL_ATTR_TXN_ISOLATION 接続属性によって設定されると、トランザクションの分離レベル) の対象セットに行の値に対する変更が検出します。  
  
 キーセット ドリブン カーソルが開かれると、全体の結果セットのキーを保存します。これにより、見かけ上のメンバーシップと、結果セットの順序を修正します。 このキーが使用して、カーソルが結果セットをスクロールすると*キーセット*各行の現在のデータ値を取得します。 たとえば、キーセット ドリブン カーソルは行と別のアプリケーションをフェッチし、その行を更新します。 場合は、カーソルは、行を変わりません、認識値は、そのキーを使用して行を再フェッチするため、新しいものです。 このため、キーセット ドリブン カーソルは常に自身および他のユーザーによって行われた変更を検出します。  
  
 カーソルが削除された行を取得しようとした場合、この行が結果セットに「穴」として表示されます。行に対するキーはキーセット内に存在しますが、結果セットには行は存在しなくなっています。 行のキー値を更新すると、ため、このような行が結果セットに穴としても表示、削除し、挿入、行と見なされます。 キーを必要に応じて削除できますキーセット ドリブン カーソルでは、他のユーザーによって削除された行を検出できる常に、中に行の削除自体キーセットから。 これを実現できるキーセット ドリブン カーソルは、独自の削除を検出できません。 SQL_STATIC_SENSITIVITY オプションを使用して特定のキーセット ドリブン カーソルが、独自の削除を検出するかどうかは報告**SQLGetInfo**します。  
  
 キーセットにあるこれらの行のキーが存在しないために、他のユーザーによって挿入された行はキーセット ドリブン カーソルに表示されません。 ただし、キーセット ドリブン カーソルには、キーが追加できます必要に応じて行の挿入自体キーセットにします。 これを実現できるキーセット ドリブン カーソルは、独自の挿入を検出できます。 SQL_STATIC_SENSITIVITY オプションを使用して特定のキーセット ドリブン カーソルが、独自の挿入を検出するかどうかは報告**SQLGetInfo**します。  
  
 SQL_ATTR_ROW_STATUS_PTR ステートメント属性で指定された行の状態配列では、任意の行の SQL_ROW_SUCCESS や SQL_ROW_SUCCESS_WITH_INFO、SQL_ROW_ERROR を含めることができます。 SQL_ROW_UPDATED、SQL_ROW_DELETED、または SQL_ROW_ADDED として更新された場合は、検出した行の削除、または挿入を返します。  
  
 キーセット ドリブン カーソルでは通常、結果セットの各行のキーを格納する一時テーブルを作成して実装されます。 カーソルは、行が更新されているかどうかも決定する必要があります、ため、このテーブルに行バージョン管理情報を含む列もよく含まれています。  
  
 元の結果セットをスクロールするには、キーセット ドリブン カーソルは、一時テーブルで静的カーソルを開きます。 元の結果セット内の行を取得するには、カーソルは、一時テーブルから最初に、適切なキーを取得し、行の現在の値を取得します。 ブロック カーソルを使用している場合、カーソルは複数のキーと行を取得する必要があります。
