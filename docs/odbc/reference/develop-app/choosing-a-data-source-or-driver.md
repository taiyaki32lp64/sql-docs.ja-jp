---
title: 選択、データ ソースまたはドライバー |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- connecting to driver [ODBC], selecting driver
- connecting to data source [ODBC], selecting data source
- data sources [ODBC], selecting
- ODBC drivers [ODBC], selecting
ms.assetid: 10aaf570-01ab-4478-8339-bdde2a5e3dd1
author: MightyPen
ms.author: genemi
ms.openlocfilehash: 9aac31af80ff5774d464f76f130d2d113002e60a
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/15/2019
ms.locfileid: "68001395"
---
# <a name="choosing-a-data-source-or-driver"></a>データ ソースまたはドライバーの選択
データ ソースまたはドライバー、アプリケーションで使用される場合があります、アプリケーションにハードコーディングします。 名が含まれますが 1 つのデータ ソースからデータには転送する、MIS 部門によって書き込まれたカスタム アプリケーションなど、データのソースのアプリケーションだけで動作しない他のデータ ソース。 別の例は、1 つのエントリの順序の使用などの垂直方向のアプリケーションです。 このようなアプリケーションは常には、アプリケーションによって認識されている定義済みのスキーマが同じデータ ソースを使用します。  
  
 他のアプリケーションは、実行時に、データ ソースまたはドライバーを選択します。 通常、これらは、ODBC を使用してデータをインポートするスプレッドシートなどのアドホック クエリを実行する汎用的なアプリケーションです。 このようなアプリケーションは通常、使用できるデータ ソースまたはドライバーの一覧を表示し、ユーザーが使用するものを選択できるようにします。 かどうか、汎用的なアプリケーションを一覧表示のデータ ソース、ドライバー、またはその両方頻繁には、アプリケーションが DBMS ベースまたはファイル ベースのドライバーを使用するかどうかによって異なります。  
  
 DBMS ベースのドライバーには、接続については、ネットワーク アドレス、ネットワーク プロトコル、データベースの名前などの複雑なセットが通常必要があります。 データ ソースでは、この情報はすべて非表示にします。 そのため、データ ソースのパラダイムでは役立ち DBMS ベースのドライバーを使用します。 アプリケーションでは、2 つの方法でユーザーにデータ ソースの一覧を表示できます。 呼び出すことができます**SQLDriverConnect**で、 **DSN** (データ ソース名) キーワードと関連付けられている値はありません。 ドライバー マネージャーは、データ ソース名の一覧が表示されます。 呼び出す場合、アプリケーションは、リストの外観を制御、 **SQLDataSources**の使用可能な一覧を取得するデータ ソースし、独自のダイアログ ボックスを構築します。 この関数は、ドライバー マネージャーによって実装され、すべてのドライバーが読み込まれる前に呼び出すことができます。 アプリケーションに、接続関数を呼び出すし、選択したデータ ソースの名前を渡します。  
  
 データ ソースが指定されていない場合は、システム情報で示された既定のデータ ソースが使用されます。 (詳細については、次を参照してください[サブキーの既定の](../../../odbc/reference/install/default-subkey.md)。)。場合**SQLConnect**を呼び出すとき、 *ServerName*が見つかりません、null ポインター、または"DEFAULT"は、引数、ドライバー マネージャーが既定のデータ ソースに接続します。 既定の場合、接続文字列をデータ ソースが使用されますがへの呼び出しで使用**SQLDriverConnect**または**SQLBrowseConnect**が含まれています、 **DSN**キーワードは、"既定値に設定"または指定したデータ ソースが見つからない場合。 呼び出しで、接続文字列の場合、データ ソースが使用される既定を使用するさらに、 **SQLDriverConnect**が含まれていない、 **DSN**キーワード。  
  
 ファイル ベースのドライバーは、ファイルのパラダイムを使用できます。 ローカル コンピューターに格納されているデータ、ユーザーよく把握しておく Employee.dbf など、特定のファイルでは、自分のデータ。 不明なデータ ソースを選択すると、代わりにこのようなユーザーがわかっているファイルを選択するため簡単です。 これは、アプリケーションの最初の呼び出しを実装する**SQLDrivers**します。 この関数は、ドライバー マネージャーによって実装され、すべてのドライバーが読み込まれる前に呼び出すことができます。 **SQLDrivers**使用可能なドライバーの一覧を返しますの値も返します、 **FileUsage**と**FileExtns**キーワード。 **FileUsage**かどうかファイル ベースのドライバーのファイルとして扱う、テーブルは、Xbase またはとしては Microsoft® Access データベースとして、キーワードについて説明します。 **FileExtns**キーワードには、Xbase ドライバー .dbf などのドライバーが認識できるファイル名拡張子が一覧表示されます。 この情報を使用して、アプリケーションは、ユーザーがファイルを選択 ダイアログ ボックスを作成します。 選択したファイルの拡張子に基づいて、その後、アプリケーションに接続ドライバーを呼び出して**SQLDriverConnect**で、**ドライバー**キーワード。  
  
 ファイル ベースのドライバーを使用したデータ ソースの使用または呼び出すからアプリケーションを停止するものがない**SQLDriverConnect**で、**ドライバー** DBMS ベースのドライバーに接続するためのキーワード。 ここでのいくつかの一般的な用途には、**ドライバー** DBMS ベースのドライバーのキーワード。  
  
-   **データ ソースを作成できません。** たとえば、カスタム アプリケーションでは、特定のドライバーとデータベースを使用可能性があります。 ドライバー名と、データベースに接続するために必要なすべての情報は、アプリケーションでハード コードされたの場合、ユーザーがアプリケーションを実行するコンピューターにデータ ソースを作成するはありません。 アプリケーションとドライバーをインストールするようにする必要があります、です。  
  
     このメソッドの欠点は、アプリケーションの再コンパイルし、接続情報が変更された場合に再配布する必要があることです。 データ ソース名が完全な接続情報の代わりに、アプリケーションでハード コーディングされた場合は、各ユーザーは、データ ソースの情報のみを変更する必要があります。  
  
-   **特定の DBMS に 1 回アクセスします。** たとえば、ODBC 関数を呼び出すことによってデータを取得するワークシートが含まれる、**ドライバー**特定のドライバーを識別するためにキーワード。 ドライバー名は、そのドライバーを持つ任意のユーザーに意味のあるであるため、スプレッドシートをそれらのユーザーの間で渡すことができます。 スプレッドシートにデータ ソース名が含まれている場合、各ユーザーは、スプレッドシートを使用して同じデータ ソースを作成する必要があります。  
  
-   **特定のドライバーにアクセスできるすべてのデータベースのシステムを参照します。** 詳細については、次を参照してください。 [SQLBrowseConnect による接続](../../../odbc/reference/develop-app/connecting-with-sqlbrowseconnect.md)、このセクションで後述します。
