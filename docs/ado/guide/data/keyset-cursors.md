---
title: Keyset カーソル |Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- Keyset cursors [ADO]
- cursors [ADO], Keyset
ms.assetid: 14b51b17-6fd9-4146-af45-ca4b0fe6d48a
author: MightyPen
ms.author: genemi
ms.openlocfilehash: c7a12d1579af407bca77c9fa61d660a84a09f04e
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/15/2019
ms.locfileid: "67924905"
---
# <a name="keyset-cursors"></a>Keyset カーソル
キーセット カーソルは、変更を検出する機能で、静的および動的カーソルの間の機能を提供します。 静的カーソルと同様に、結果セットのメンバーシップと順序に対する変更は常に検出されません。 動的カーソルと同様に、結果セット内の行の値に対する変更は検出されます。  
  
 キーセット ドリブン カーソルは、キーセットという一意の識別子 (キー) のセットにより制御されます。 これらのキーは、結果セットの行を一意に識別する列のセットから構築されます。 キーセットは、クエリ ステートメントによって返されるすべての行からのキー値のセットです。  
  
 キーセット ドリブン カーソルでは、カーソルの行ごとにキーが作成されて保存され、クライアント ワークステーションまたはサーバーに格納されます。 各行にアクセスすると、格納されているキーを使用して、データ ソースから現在のデータ値がフェッチされます。 キーセット ドリブン カーソルでは、キーセットが完全に作成された時点で、結果セットのメンバーシップは凍結されます。 したがって、メンバーシップに影響を与える追加または更新は、開き直されるまで結果セットには反映されません。  
  
 結果セットをスクロールすると、(キーセットの所有者または他のプロセスによって行われます) のデータ値の変更が表示されます。 (他のプロセスによって) カーソルの外部で行われた挿入は、カーソルを閉じて再度開いた場合にのみ表示されます。 カーソルの内部から行われた挿入は、結果セットの末尾に表示されます。  
  
 キーセット ドリブン カーソルが削除された行を取得しようとした場合、行が結果セットに「穴」として表示されます。 行に対するキーはキーセット内に存在しますが、結果セットには行は存在しなくなっています。 行のキー値を更新すると、ため、このような行が結果セットに穴としても表示、削除し、挿入、行と見なされます。 キーセット ドリブン カーソルでは、他のプロセスによって削除された行を検出できる常に、中に自分自身を削除した行のキーを必要に応じて削除できます。 証拠が削除されているために、これを実現できるキーセット ドリブン カーソルは、独自の削除を検出できません。  
  
 キー列への更新は、新しいキーの挿入後に古いキーの削除のように動作します。 新しいキーの値は、更新プログラムが、カーソルによって行われたしない場合に表示されません。 更新プログラムが、カーソルによって行われた場合、新しいキー値が結果セットの末尾に追加されます。  
  
 標準的なカーソルのキーセット ドリブンと呼ばれる、キーセット ドリブン カーソルのバリエーションがあります。 キーセット ドリブンの標準的なカーソルの結果セット内の行のメンバーシップと、行の順序は固定されている場合、カーソルが開いたとき、カーソル所有者によって行われた値を変更し、他のプロセスによってコミットされた変更が表示されます。 変更行の条件を満たしませんまたは行の順序に影響は、行はしない非表示になりますか、カーソルを閉じてから再度開く場合を除きに移動します。 挿入されたデータが表示されないが、既存のデータへの変更が、行がフェッチのように表示します。  
  
 キーセット ドリブン カーソルでは、多くのさまざまな状況依存の重大度データの変更を上記で説明したように正しく使用する困難です。 ただし、アプリケーションでは同時実行更新に関係していない、誤ったキーをプログラムで処理することができます、特定のキー付きの行に直接アクセスする必要がある場合、キーセット ドリブン カーソルが適しています。 使用して、 **adOpenKeyset CursorTypeEnum**を ADO でキーセット カーソルを使用することを示します。  
  
## <a name="see-also"></a>関連項目  
 [順方向専用カーソル](../../../ado/guide/data/forward-only-cursors.md)   
 [静的カーソル](../../../ado/guide/data/static-cursors.md)   
 [動的カーソル](../../../ado/guide/data/dynamic-cursors.md)
