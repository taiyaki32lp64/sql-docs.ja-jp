---
title: レコード セットの操作 |Microsoft Docs
ms.prod: sql
ms.prod_service: connectivity
ms.technology: connectivity
ms.custom: ''
ms.date: 01/19/2017
ms.reviewer: ''
ms.topic: conceptual
helpviewer_keywords:
- Recordset object [ADO]
ms.assetid: bdf9a56a-de4a-44de-9111-2f11ab7b16ea
author: MightyPen
ms.author: genemi
ms.openlocfilehash: a3025140929d7a7cf281f72c035bf79e0a5883b3
ms.sourcegitcommit: b2464064c0566590e486a3aafae6d67ce2645cef
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/15/2019
ms.locfileid: "67923413"
---
# <a name="working-with-recordsets"></a>レコードセットの操作
**Recordset**オブジェクトが組み込みの機能を指定する条件に基づいて、特定のレコードを検索して、インデックスを使用してこれらの検索操作を最適化するためにも、結果セット内のデータの順序を変更することができます。 これらの機能が使用できるかどうかによって異なります、プロバイダーなどの場合によって、[インデックス](../../../ado/reference/ado-api/index-property.md)プロパティ - データ ソース自体の構造体。  
  
## <a name="arranging-data"></a>データの整列  
 内のデータの並べ替えに多くの場合、最も効率的な方法、 **Recordset**に結果を返すために使用する SQL コマンドで ORDER BY 句を指定することです。 ただしのデータの順序を変更する必要があります、 **Recordset**を既に作成されています。 使用することができます、**並べ替え**プロパティの行の順序を確立するために、**レコード セット**が走査されます。 さらに、**フィルター**プロパティを指定する行の行をトラバースするときにアクセスできます。  
  
 **並べ替え**プロパティを設定または取得を**文字列**で名前をフィールドを示す値、**レコード セット**並べ替えに使用します。 それぞれの名前はコンマで区切られます、スペースと、キーワードに続けて**ASC** (フィールドを昇順に並べ替え) または**DESC** (降順でフィールドの並べ替え) します。 既定では、キーワードが指定されていない場合、フィールドが昇順に並べ替えられます。  
  
 並べ替え操作は、データは物理的に並べ替えられることはありませんが、インデックスで指定された順序でアクセスするために効率的です。  
  
 **並べ替え**プロパティが必要です、 [CursorLocation](../../../ado/reference/ado-api/cursorlocation-property-ado.md)プロパティを設定する**adUseClient**します。 各フィールドで指定された一時インデックスが作成されます、**並べ替え**プロパティ、インデックスが存在しない場合。  
  
 設定、**並べ替え**プロパティを空の文字列には行は元の順序にリセットされ、一時インデックスを削除します。 既存のインデックスは削除されません。  
  
 **レコード セット**という 3 つのフィールドが含まれています*firstName*、 *middleInitial*、および*lastName*します。 設定、**並べ替え**プロパティを文字列"`lastName DESC, firstName ASC`"、順序は、**レコード セット**して、姓の降順で並べ替えてから名で昇順に並べ替えます。 ミドル ネームのイニシャルは無視されます。  
  
 フィールドの並べ替え条件の文字列で参照されている名前を指定できますなし"ASC"または"DESC"キーワードとそれらの名前の競合**ASC**と**DESC**します。 使用して、競合する名前のエイリアスを持つフィールドを与える、 **AS**を返すクエリ内のキーワード、**レコード セット**します。  
  
 詳細については**Recordset**フィルター処理すると、このトピックの「"結果をフィルター処理"を参照してください。  
  
## <a name="finding-a-specific-record"></a>特定のレコードを検索  
 ADO の提供、[検索](../../../ado/reference/ado-api/find-method-ado.md)と[シーク](../../../ado/reference/ado-api/seek-method.md)の特定のレコードを検索するためのメソッド、**レコード セット**します。 **検索**メソッドのさまざまなプロバイダーでサポートされてが 1 つの検索条件に制限されています。 **シーク**メソッドは、複数の条件で検索をサポートしてが、多くのプロバイダーでサポートされていません。  
  
 フィールドのインデックスのパフォーマンスが向上、**検索**メソッドと**並べ替え**と**フィルター**のプロパティ、 **Recordset**オブジェクト。 内部のインデックスを作成することができます、**フィールド**オブジェクト、動的に設定して[最適化](../../../ado/reference/ado-api/optimize-property-dynamic-ado.md)プロパティ。 この動的プロパティに追加されます、**プロパティ**のコレクション、**フィールド**オブジェクトを設定すると、 [CursorLocation](../../../ado/reference/ado-api/cursorlocation-property-ado.md)プロパティを**adUseClient**. このインデックスは、ADO 内部こと - アクセスを防ぐことまたはその他の目的に使用することはできませんに注意してください。 また、このインデックスは異なる、[インデックス](../../../ado/reference/ado-api/index-property.md)のプロパティ、 **Recordset**オブジェクト。  
  
 **検索**メソッド内の列 (フィールド) の値を迅速に特定する、 **Recordset**します。 多くの場合の速度を向上することができます、**検索**メソッドを使用して列を**最適化**プロパティをインデックスを作成します。  
  
 **検索**メソッドは、検索対象を 1 つのフィールドの内容を制限します。 **シーク**メソッドは、インデックスが存在しても、その他の制限がありますが必要です。 かどうか、インデックスのベースではない複数のフィールドで検索する必要がありますまたはを使用して、結果を制限するには、プロバイダーがインデックスをサポートしていない場合、**フィルター**のプロパティ、 **Recordset**オブジェクト。  
  
### <a name="find"></a>[検索]  
 **検索**メソッドの検索、**レコード セット**を指定した条件を満たす行のできます。 必要に応じて、検索、開始行、および開始行からのオフセットの方向を指定することがあります。 現在の行位置が; 検出されたレコードの設定、条件が満たされた場合(先頭または末尾) に、位置を設定する場合は、 **Recordset**検索の方向に応じて、します。  
  
 条件の 1 つの列名のみを指定できます。 つまり、このメソッドは複数列の検索をサポートしていません。  
  
 条件の比較演算子を指定できます" **>** 「(より大きい)、」 **\<** "(より小さい)、「=」(等しい)、"> ="(より大きいまたは等しい)、"< ="(以下)、"<>"(等しくない)、または"LIKE"(パターン一致)。  
  
 基準値には、文字列、浮動小数点数、または日付を指定できます。 文字列の値が単一引用符または「#」(シャープ記号) 記号で区切られた (たとえば、"状態 = 'WA'"または"の状態 = WA #")。 日付の値は「#」(シャープ記号) 記号で区切られます (たとえば、"start_date > #7/22/97 #")。  
  
 比較演算子が"like"の場合は、文字列値は、任意の文字または部分文字列の 1 つ以上の出現位置を検索のアスタリスク (*) を含めることができます。 たとえば、"のような状態は\*'"Maine とマサチューセッツ州に一致します。 値に含まれる部分文字列を検索するのに先頭および末尾のアスタリスクを使用することもできます。 たとえば、"のような状態 '\*として\*'"アラスカ、アーカンソー、およびマサチューセッツ州に一致します。  
  
 アスタリスクできます条件文字列の末尾でのみまたは組み合わせて使用先頭と条件の文字列の末尾の両方に前述のようにします。 先頭のワイルドカードとしてアスタリスクを使用することはできません ('* str')、または埋め込みワイルドカード ('s\*r')。 これにより、エラーが発生します。  
  
### <a name="seek-and-index"></a>シークおよびインデックス  
 使用して、**シーク**メソッドと組み合わせて、**インデックス**プロパティを基になるプロバイダーのインデックスをサポートしている場合、**レコード セット**オブジェクト。 使用、[サポート](../../../ado/reference/ado-api/supports-method.md) **(adSeek)** 基になるプロバイダーがサポートしているかどうかを判断するメソッド**シーク**、および**Supports(adIndex)** プロバイダーはインデックスをサポートするかどうかを判断するメソッドです。 (たとえば、 [OLE DB Provider for Microsoft Jet](../../../ado/guide/appendixes/microsoft-ole-db-provider-for-microsoft-jet.md)サポート**シーク**と**インデックス**)。  
  
 場合**シーク**エラーは、目的の行は見つかりませんが発生して、行がの末尾に配置されている、 **Recordset**します。 設定、**インデックス**プロパティをこのメソッドを実行する前に目的のインデックス。  
  
 このメソッドは、サーバー側のカーソルでのみサポートされます。 シークはときにサポートされていません、 [CursorLocation](../../../ado/reference/ado-api/cursorlocation-property-ado.md)プロパティの値、**レコード セット**オブジェクトが**adUseClient**します。  
  
 このメソッドを使用する場合にのみ、**レコード セット**でオブジェクトが開かれた、 [CommandTypeEnum](../../../ado/reference/ado-api/commandtypeenum.md)の値**adCmdTableDirect**します。  
  
## <a name="filtering-the-results"></a>結果のフィルター処理  
 **検索**メソッドは、検索対象を 1 つのフィールドの内容を制限します。 **シーク**メソッドは、インデックスが存在しても、その他の制限がありますが必要です。 インデックスのベースではない複数のフィールドで検索する必要がありますかを使用して、結果を制限するには、プロバイダーがインデックスをサポートしていない場合、**フィルター**のプロパティ、 **Recordset**オブジェクト。  
  
 使用して、**フィルター**プロパティ内のレコードを選択して画面を**Recordset**オブジェクト。 フィルター処理された**レコード セット**記録することを意味を満たしていない、現在のカーソルになります、**フィルター**条件では使用できません、 **Recordset**まで、**フィルター**が削除されます。 現在のカーソルに基づく値を返す他のプロパティは、影響を受けるなど**AbsolutePosition**、 **AbsolutePage**、 **RecordCount**、および**PageCount**します。 これは、設定するため、**フィルター**プロパティを特定の値には、新しい値を満たす最初のレコードを現在のレコードを移動します。  
  
 **フィルター**プロパティはバリアント型の引数を受け取ります。 この値を表す 3 つのメソッドを使用するための 1 つ、**フィルター**プロパティ: 条件の文字列を**FilterGroupEnum**定数、またはブックマークの配列。 詳細については、このトピックの「フィルター条件文字列を定数、によるフィルター処理、およびブックマークによるフィルター処理を参照してください。  
  
> [!NOTE]
>  選択するデータがわかっている場合に、開く方が効率的な**レコード セット**を効果的に使用する代わりに、結果セットをフィルター処理する SQL ステートメントを使用して、**フィルター**プロパティ。  
  
 フィルターを削除する、 **Recordset**を使用して、 **adFilterNone**定数。 設定、**フィルター**プロパティを長さ 0 の文字列 ("") を使用して同じ効果があります、 **adFilterNone**定数。  
  
### <a name="filtering-with-a-criteria-string"></a>条件の文字列でフィルター処理  
 条件の文字列から成る形式の句で*FieldName 演算子値*(たとえば、 `"LastName = 'Smith'"`)。 個々 の句を連結して複合句を作成することができます**AND** (たとえば、 `"LastName = 'Smith' AND FirstName = 'John'"`) と**または**(たとえば、 `"LastName = 'Smith' OR LastName = 'Jones'"`)。 文字列の条件には、次のガイドラインを使用します。  
  
-   *FieldName*から有効なフィールド名にする必要があります、 **Recordset**します。 フィールド名にスペースが含まれている場合は、角かっこで名前を囲む必要があります。  
  
-   *演算子*、次のいずれかを指定する必要があります: **\<** 、 **>** 、 **\< =** 、 **>=** 、 **<>** 、 **=** 、または**など**します。  
  
-   *値*は、フィールドの値を比較する値です (たとえば、 `'Smith'`、 `#8/24/95#`、 `12.345`、または`$50.00`)。 文字列内で単一引用符 (') を使用し、シャープ記号 (`#`) の日付。 数値の場合は、小数点、ドル記号、および科学的表記法を使用できます。 場合*演算子*は**など**、*値*ワイルドカード文字を使用できます。 アスタリスクのみ (\*) とパーセント記号 (%)ワイルドカード文字を許可、および最後の文字の文字列である必要があります。 *値*null にすることはできません。  
  
    > [!NOTE]
    >  フィルターに単一引用符 (') を含める*値*、1 つの 2 つの単一引用符を使用します。 フィルター処理などに*O'Malley*、条件の文字列にする必要があります`"col1 = 'O''Malley'"`します。 先頭と末尾のフィルター値の両方に単一引用符を含めるには、文字列を引用符でシャープ記号 (#)。 フィルター処理などに *'1'* 、条件の文字列にする必要があります`"col1 = #'1'#"`します。  
  
 間の優先順位がない**AND**と**または**します。 句は、かっこで囲まれてグループ化できます。 ただしで結合句をグループ化することはできません、**または**し、次のように、グループを使用して、別の句に参加します。  
  
```  
(LastName = 'Smith' OR LastName = 'Jones') AND FirstName = 'John'  
```  
  
 代わりに、次のように、このフィルターを構築するとします。  
  
```  
(LastName = 'Smith' AND FirstName = 'John') OR (LastName = 'Jones' AND FirstName = 'John')  
```  
  
 **など**句では、先頭とパターンの末尾にワイルドカードを使用することができます (たとえば、 `LastName Like '*mit*'`) かパターンの末尾にのみ (など`LastName Like 'Smit*'`)。  
  
### <a name="filtering-with-a-constant"></a>定数によるフィルター処理  
 次の定数は、フィルター処理するため利用**レコード セット**します。  
  
|定数|説明|  
|--------------|-----------------|  
|**adFilterAffectedRecords**|最後に影響を受けるレコードのみを表示するためのフィルター**削除**、**再同期**、 **UpdateBatch**、または**CancelBatch**呼び出します。|  
|**adFilterConflictingRecords**|最後のバッチ更新が失敗したレコードを表示するためのフィルター。|  
|**adFilterFetchedRecords**|フィルターの現在のキャッシュ内のレコードを表示するため、データベースからレコードを取得するには、最後の呼び出しの結果は、します。|  
|**adFilterNone**|現在のフィルターを削除し、表示するためのすべてのレコードを復元します。|  
|**adFilterPendingRecords**|変更されたが、サーバーにまだ送信されていないレコードだけを表示するためのフィルター。 バッチ更新モードにのみ適用できます。|  
  
 フィルター定数容易に解決するにはこれらのレコードのみを表示、たとえば、許可することで、バッチ更新モード時に競合レコードの最後の中に影響を受けた**UpdateBatch**メソッドの呼び出しのように、次の例です。  
  
 `Attribute VB_Name = "modExaminingData"`  
  
### <a name="filtering-with-bookmarks"></a>ブックマークによるフィルター処理  
 最後へのブックマークの variant の配列を渡すことができます、**フィルター**プロパティ。 結果として得られるカーソルは、ブックマーク プロパティに渡されたレコードのみが含まれます。 次のコード例では、内のレコードからのブックマークの配列を作成、 **Recordset** "B"である、 *ProductName*フィールド。 これは、後、先の配列を渡します、**フィルター** 、フィルター選択された結果に関する情報のプロパティを表示します**Recordset**します。  
  
```  
'BeginFilterBkmk  
Dim vBkmkArray() As Variant  
Dim i As Integer  
  
'Recordset created using "SELECT * FROM Products" as command.  
'So, we will check to see if ProductName has a capital B, and  
'if so, add to the array.  
i = 0  
Do While Not objRs.EOF  
    If InStr(1, objRs("ProductName"), "B") Then  
        ReDim Preserve vBkmkArray(i)  
        vBkmkArray(i) = objRs.Bookmark  
        i = i + 1  
        Debug.Print objRs("ProductName")  
    End If  
    objRs.MoveNext  
Loop  
  
'Filter using the array of bookmarks.  
objRs.Filter = vBkmkArray  
  
objRs.MoveFirst  
Do While Not objRs.EOF  
    Debug.Print objRs("ProductName")  
    objRs.MoveNext  
Loop  
'EndFilterBkmk  
```  
  
## <a name="creating-a-clone-of-a-recordset"></a>レコード セットの複製を作成します。  
 使用して、**複製**複数作成するメソッドが重複しています**レコード セット**オブジェクトの場合、特定のレコード セットの 1 つ以上の現在のレコードを保持したい場合に特にです。 使用して、**複製**メソッドが作成して開く、新しいよりも効率的**Recordset**元と同じ定義を持つオブジェクト。  
  
 新しく作成された複製の現在のレコードは、最初のレコードにもともと設定されます。 複製されたで現在のレコード ポインター**レコード セット**元またはその逆は同期されません。 移動できますしない個別に各**Recordset**します。  
  
 いずれかに加えた**Recordset**オブジェクトは、すべてのカーソルの種類に関係なく複製に表示されます。 実行した後、ただし[Requery](../../../ado/reference/ado-api/requery-method.md)元の**レコード セット**クローンは元に不要になった同期します。  
  
 元の閉じる**レコード セット**が、そのコピーを閉じないも閉じるコピーを閉じるは元のまたは他のコピーのいずれか。  
  
 複製することができます、 **Recordset**ブックマークをサポートするかどうかにのみオブジェクトします。 ブックマークの値を交換できます。1 つからのブックマーク参照は、**レコード セット**オブジェクトがその複製のいずれかで同じレコードを参照します。
